(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{276:function(e,t,o){var content=o(281);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(28).default)("0a18e831",content,!0,{sourceMap:!1})},277:function(e,t,o){var content=o(283);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(28).default)("20035751",content,!0,{sourceMap:!1})},278:function(e,t,o){"use strict";var n={name:"PageHeaderItem"},r=(o(280),o(14)),component=Object(r.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"page-header-item"},[this._t("default")],2)}),[],!1,null,null,null);t.a=component.exports},279:function(e,t,o){var content=o(288);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(28).default)("cda4275e",content,!0,{sourceMap:!1})},280:function(e,t,o){"use strict";var n=o(276);o.n(n).a},281:function(e,t,o){(t=o(27)(!1)).push([e.i,".page-header-item{flex:0 1 auto;margin-bottom:7px;margin-top:8px;background:#c2cfd6;display:block;padding-left:.5rem;overflow:visible;height:38.133px;min-height:38.133px;max-height:38.133px;min-width:80px}.page-header-item .btn{height:38.133px}.page-header-item .slider-container{height:38.133px;max-height:38.133px}.page-header-item .dropdown-item{background-color:#f0f3f5}",""]),e.exports=t},282:function(e,t,o){"use strict";var n=o(277);o.n(n).a},283:function(e,t,o){(t=o(27)(!1)).push([e.i,".page-header{flex-grow:0!important;flex-shrink:0!important;height:53.133px!important;margin-bottom:0!important;border-bottom:0!important;border-radius:0!important;width:calc(100vw - 160px);display:flex;flex-direction:row;background:#c2cfd6;overflow:visib}",""]),e.exports=t},285:function(e,t,o){"use strict";var n={name:"PageHeader",props:{},components:{PageHeaderItem:o(278).a},methods:{}},r=(o(282),o(14)),component=Object(r.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"page-header"},[this._t("default")],2)}),[],!1,null,null,null);t.a=component.exports},287:function(e,t,o){"use strict";var n=o(279);o.n(n).a},288:function(e,t,o){(t=o(27)(!1)).push([e.i,".vue-slider{padding:4px}.vue-slider-rail{background:#f0f3f5!important}.vue-slider-dot{background:#1985ac;border-radius:50%}.slider-container{display:flex;flex-direction:column;padding-left:4px;padding-right:4px}.slider-caption{height:14px;margin-bottom:4px}",""]),e.exports=t},289:function(e,t,o){var content=o(297);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(28).default)("1ff3331c",content,!0,{sourceMap:!1})},291:function(e,t,o){"use strict";var n=o(292),r=o.n(n),l=o(278),d=o(19),c=o(284),h={name:"PageHeaderSeek",props:{id:{type:String,default:"",required:!0}},components:{VueSlider:r.a,PageHeaderItem:l.a},beforeMount:function(){this.setSeekPosition(.5),this.updatePosition=setInterval(1e3,this.getSeekPosition)},beforeDestroy:function(){clearInterval(this.updatePosition)},methods:{setSeekPosition:function(){var e=this;Object(d.m)(this.id,this.position).then((function(t){e.position=t}))},getSeekPosition:function(){var e=this;Object(d.h)(this.id).then((function(t){e.position=t}))},handleSeek:Object(c.b)(100,!0,Object(c.a)(25,!0,(function(){this.setSeekPosition()}))),formatTooltip:function(e){return"".concat(Math.round(100*e),"%")}},data:function(){return{position:null,options:{dotSize:14,width:120,height:4,contained:!1,direction:"ltr",data:null,min:0,max:1,interval:.01,disabled:!1,clickable:!1,duration:.1,adsorb:!1,lazy:!1,tooltip:"active",tooltipPlacement:"bottom",tooltipFormatter:this.formatTooltip,useKeyboard:!0,keydownHook:null,dragOnClick:!1,enableCross:!0,fixed:!1,order:!0,marks:!1,process:!1}}}},m=(o(287),o(14)),component=Object(m.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("PageHeaderItem",[o("div",{staticClass:"slider-container"},[o("div",{staticClass:"slider-caption"},[e._v("Seek position")]),e._v(" "),o("vue-slider",e._b({ref:"slider",on:{change:e.handleSeek},model:{value:e.position,callback:function(t){e.position=t},expression:"position"}},"vue-slider",e.options,!1))],1)])}),[],!1,null,null,null);t.a=component.exports},296:function(e,t,o){"use strict";var n=o(289);o.n(n).a},297:function(e,t,o){(t=o(27)(!1)).push([e.i,".align{float:left;margin:0}.align,.streamed-image-a{position:absolute;display:block;max-height:calc(100vh - 53.133px)}.streamed-image-a{z-index:-100;pointer-events:none;max-width:calc(100vw - 160px);width:auto;height:auto}.moveable{position:absolute;width:100px;height:100px;left:0;top:0;margin:0}.hidden *{visibility:hidden}.moveable-control,.moveable-line{border-color:#1e9ecb!important;background:#20a8d8!important}.moveable-line{visibility:hidden!important}.moveable-control.moveable-rotation{border-color:#1e9ecb!important;background:#ade1f3!important}.moveable-direction,.moveable-rotation-line{visibility:visible!important;outline:1px solid transparent!important}.moveable-reverse *{visibility:hidden!important}",""]),e.exports=t},303:function(e,t,o){"use strict";o.r(t);var n=o(19),r=o(295),l=o.n(r),d=o(59),c=o(285),h=o(278),m=o(291),f=o(284),v={name:"align",beforeMount:function(){this.handleInit(),this.waitUntilHasRect=setInterval(this.updateFrameOnceHasRect,100),window.onresize=this.updateFrame},beforeDestroy:function(){clearInterval(this.waitUntilHasRect),clearInterval(this.updateCall)},components:{Moveable:l.a,PageHeader:c.a,PageHeaderItem:h.a,PageHeaderSeek:m.a},methods:{handleInit:function(){var e=this;this.moveable.className=this.moveableHide,console.log("Initializing align window for ".concat(this.id)),this.$store.dispatch("align/init",{id:this.id}).then((function(){console.log("Vuex/align: init should be done"),console.log(e.$store.state.align),null===e.$store.getters["align/getInitialRoi"](e.id)&&e.$store.commit("align/setInitialRoi",{id:e.id,initial_roi:d.b})}))},handleTransform:function(e){var t=e.target,o=e.transform;t.style.transform=o},handleRotate:function(e){var t=e.target,o=e.transform;t.style.transform=o},updateRoiCoordinates:function(){var e=this.$store.getters["align/getFrame"](this.id),t=Object(d.d)(this.$refs.moveable.getRect(),e);Object(n.d)(this.id,t)},handleUpdate:Object(f.b)(100,!1,Object(f.a)(20,!1,(function(){this.updateRoiCoordinates()}))),updateFrame:function(){var e=this;console.log("Updating frame...");var t=this.$refs.frame.getBoundingClientRect();console.log(t),this.moveable.bounds={left:t.left,right:t.right,top:t.top,bottom:t.bottom},this.$store.commit("align/setFrame",{id:this.id,frame:t}),this.$store.dispatch("align/getRoi",{id:this.id}).then((function(){var t=e.$store.getters["align/getInitialTransform"](e.id);e.$refs.moveable.$el.style.transform=t,console.log("updateFrame - initial_transform"),console.log(t),console.log(e.$refs.moveable.$el),e.$refs.moveable.updateRect(),e.$refs.moveable.updateTarget()}))},updateOverlay:function(){console.log("Updating overlay...");var e=this.$refs.moveable.getRect(),t={width:e.width,height:e.height,top:-e.height/2,left:-e.width/2,bottom:e.height/2,right:e.width/2};console.log(t),this.$store.commit("align/setOverlay",{id:this.id,overlay:t})},updateFrameOnceHasRect:function(){var e=!1,t=!1;void 0!==this.waitUntilHasRect&&this.$refs.frame.getBoundingClientRect().width>50&&(console.log("HAS FRAME"),this.updateFrame(),e=!0),this.$refs.moveable.getRect().width>50&&(console.log("HAS OVERLAY"),this.updateOverlay(),t=!0),e&&t&&(clearInterval(this.waitUntilHasRect),this.moveable.className=this.moveableShow)}},computed:{id:function(){return this.$route.query.id},overlaid_url:function(){return Object(n.p)(this.$route.query.id,"stream/get_inverse_overlaid_frame")}},data:function(){return{moveable:{className:"hidden",draggable:!0,throttleDrag:0,rotatable:!0,throttleRotate:0,warpable:!0,throttleWarp:0,snappable:!0,bounds:{}},updateCall:null,moveableShow:"",moveableHide:"hidden",waitUntilHasRect:null}}},x=(o(296),o(14)),component=Object(x.a)(v,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fixed-page"},[o("PageHeader",[o("PageHeaderItem",[o("b-button",[e._v("Set filters")])],1),e._v(" "),o("PageHeaderItem",[o("b-button",[e._v("Reset ROI")])],1),e._v(" "),o("PageHeaderSeek",{attrs:{id:e.id}}),e._v(" "),o("PageHeaderItem",[o("b-button-group",[o("b-dropdown",{attrs:{text:"Transform type: Perspective","data-toggle":"tooltip",title:"Transform type"}},[o("b-dropdown-item",{attrs:{"data-toggle":"tooltip",title:"info about perspective transform goes here"}},[e._v("Perspective")])],1)],1)],1)],1),e._v(" "),o("div",{ref:"align",staticClass:"align"},[o("img",{ref:"frame",staticClass:"streamed-image-a",attrs:{src:e.overlaid_url,alt:""}}),e._v(" "),o("Moveable",e._b({ref:"moveable",staticClass:"moveable",on:{drag:e.handleTransform,scale:e.handleTransform,rotate:e.handleRotate,warp:e.handleTransform,render:e.handleUpdate}},"Moveable",e.moveable,!1))],1),e._v(" "),o("div",{staticClass:"controls"})],1)}),[],!1,null,null,null);t.default=component.exports}}]);