(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{259:function(t,e,o){var content=o(268);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(24).default)("0f968045",content,!0,{sourceMap:!1})},260:function(t,e,o){var content=o(277);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(24).default)("675544f8",content,!0,{sourceMap:!1})},267:function(t,e,o){"use strict";var n=o(259);o.n(n).a},268:function(t,e,o){(e=o(23)(!1)).push([t.i,".seek-container[data-v-7452cc69]{position:relative}",""]),t.exports=e},276:function(t,e,o){"use strict";var n=o(260);o.n(n).a},277:function(t,e,o){(e=o(23)(!1)).push([t.i,".align{float:left;margin:0}.align,.streamed-image{position:absolute;display:block}.streamed-image{z-index:-100;pointer-events:none;max-width:80vw;max-height:100vh;width:auto;height:auto}.moveable{z-index:1;font-family:Roboto,sans-serif;position:absolute;width:100px;height:100px;left:0;top:0;text-align:center;font-size:40px;margin:0;font-weight:100;letter-spacing:1px}",""]),t.exports=e},284:function(t,e,o){"use strict";o.r(e);var n=o(22),r=(o(9),o(266)),l={name:"seek",props:{id:{type:String,default:""},debounce:{type:Number,default:100},position:{type:Number,default:.5},callback:{type:Function,default:void 0}},components:{vuescroll:r.a},mounted:function(){console.log("Seeking to middle of file"),Object(n.j)(this.id,this.position)},methods:{handleScroll:function(t,e){var o=this;console.log("Seeking to ".concat(e)),Object(n.j)(id,e).then((function(t){o.position=t})),void 0!==this.callback&&this.callback()}}},c=(o(267),o(12)),d=Object(c.a)(l,(function(){var t=this.$createElement;return(this._self._c||t)("div",{directives:[{name:"scroll",rawName:"v-scroll:debounce",value:{fn:this.handleScroll,debounce:this.debounce},expression:"{ fn: handleScroll, debounce: debounce }",arg:"debounce"}],staticClass:"seek-container"},[this._t("default")],2)}),[],!1,null,"7452cc69",null).exports,h=o(269),f=o.n(h),m=o(11),y=o(283);function v(t,e){var o,n,b,r,i,l,c,d,h,f,m,v;for(console.assert(t.length===(m=e.length)&&4===m),o=[],i=l=0;l<4;i=++l)o.push([t[i].x,t[i].y,1,0,0,0,-t[i].x*e[i].x,-t[i].y*e[i].x]),o.push([0,0,0,t[i].x,t[i].y,1,-t[i].x*e[i].y,-t[i].y*e[i].y]);for(b=[],i=c=0;c<4;i=++c)b.push(e[i].x),b.push(e[i].y);for(n=[[(r=(r=Object(y.a)(o,b)).reduce((function(a,b){return a.concat(b)}),[]))[0],r[1],0,r[2]],[r[3],r[4],0,r[5]],[0,0,1,0],[r[6],r[7],0,1]],i=h=0;h<4;i=++h){d=(f=Object(y.b)(n,[t[i].x,t[i].y,0,1]))[3],v=Object(y.b)(d,[e[i].x,e[i].y,0,1]);var x=Object(y.d)(f,v);console.assert(Object(y.c)(x)<1e-9,"Not equal:",f,v)}return n}function x(t){for(var content=[],col=0;col<4;col++)for(var e=0;e<4;e++)content=[].concat(Object(m.a)(content),[t[e][col]]);return"matrix3d(".concat(content.join(","),")")}var w={name:"align",beforeMount:function(){this.updateFrame,this.$store.dispatch("analyzers/sync"),window.onresize=this.updateFrame},components:{SeekContainer:d,Moveable:f.a},methods:{handleDrag:function(t){var e=t.target,o=t.transform;e.style.transform=o,console.log(o),this.updateRoiCoordinates()},handleResize:function(t){var e=t.target,o=t.width,n=t.height;e.style.width="".concat(o,"px"),e.style.height="".concat(n,"px"),this.updateRoiCoordinates()},handleScale:function(t){var e=t.target,o=t.transform;e.style.transform=o,this.updateRoiCoordinates()},handleRotate:function(t){var e=t.target,o=t.transform;e.style.transform=o,this.updateRoiCoordinates()},handleWarp:function(t){var e=t.target,o=t.transform;e.style.transform=o,this.updateRoiCoordinates()},setToDummyCoords:function(t){var e=t.target,o=[{x:-50,y:50},{x:-50,y:-50},{x:50,y:-50},{x:50,y:50}],n=[{x:.82,y:.23},{x:.81,y:.89},{x:.23,y:.89},{x:.22,y:.23}],r=[];this.updateFrame(),console.log("Image ".concat(this.$store.state.analyzers[this.id].frame.width," x ").concat(this.$store.state.analyzers[this.id].frame.height));for(var i=0;i<n.length;i++)r[i]={x:n[i].x*this.$store.state.analyzers[this.id].frame.width-50,y:n[i].y*this.$store.state.analyzers[this.id].frame.height-50};console.log("Starting coordinates: (absolute)"),console.log(o),console.log("Dummy coordinates: (relative)"),console.log(n),console.log("Dummy coordinates: (absolute)"),console.log(r),console.log("Dummy transform:"),console.log(v(o,r)),console.log(x(v(o,r))),console.log("Transform of origin, [50,50]:"),console.log(Object(y.b)(v(o,r),[50,50,0,1])),this.$store.state.analyzers[this.id].transform=v(o,r),e.style.transform=x(v(o,r)),this.$refs.moveable.updateRect(),this.$refs.moveable.updateTarget()},updateRoiCoordinates:function(){var rect,t;void 0===this.$store.state.analyzers[this.id].frame&&this.updateFrame(),this.$refs.moveable.updateRect(),this.$store.state.analyzers[this.id].roi=(rect=this.$refs.moveable.getRect(),t=this.$store.state.analyzers[this.id].frame,[{x:(rect.pos3[0]-t.left)/t.width,y:rect.pos3[1]/t.height},{x:(rect.pos1[0]-t.left)/t.width,y:rect.pos1[1]/t.height},{x:(rect.pos2[0]-t.left)/t.width,y:rect.pos2[1]/t.height},{x:(rect.pos4[0]-t.left)/t.width,y:rect.pos4[1]/t.height}]),Object(n.d)(this.id,this.$store.state.analyzers[this.id].roi)},updateFrame:function(){this.$store.state.analyzers[this.id].frame=this.$refs.frame.getBoundingClientRect(),this.moveable.bounds=this.$store.state.analyzers[this.id].frame}},computed:{id:function(){return this.$route.query.id},stream_url:function(){return Object(n.m)(this.$route.query.id,"stream/get_inverse_overlaid_frame")},initial_coordinates:function(){return{}}},data:function(){return{moveable:{draggable:!0,throttleDrag:1,resizable:!1,throttleResize:1,scalable:!1,throttleScale:1,rotatable:!0,throttleRotate:1,warpable:!0,throttleWarp:1,snappable:!0,bounds:{}}}}},z=(o(276),Object(c.a)(w,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"fixed-page"},[o("seek-container",{attrs:{id:t.id,callback:t.updateFrame}},[o("div",{ref:"align",staticClass:"align"},[o("img",{ref:"frame",staticClass:"streamed-image",attrs:{src:t.stream_url,alt:""},on:{load:t.updateFrame}}),t._v(" "),o("Moveable",t._b({ref:"moveable",staticClass:"moveable",attrs:{origin:"tr"},on:{drag:t.handleDrag,resize:t.handleResize,scale:t.handleScale,rotate:t.handleRotate,warp:t.handleWarp,renderEnd:t.setToDummyCoords}},"Moveable",t.moveable,!1))],1)]),t._v(" "),o("div",{staticClass:"controls"})],1)}),[],!1,null,null,null));e.default=z.exports}}]);