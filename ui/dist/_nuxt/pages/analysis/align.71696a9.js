/*! For license information please see ../../LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{525:function(t,e,n){var content=n(534);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("cda4275e",content,!0,{sourceMap:!1})},531:function(t,e,n){var content=n(546);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("7c440db6",content,!0,{sourceMap:!1})},533:function(t,e,n){"use strict";var r=n(525);n.n(r).a},534:function(t,e,n){(e=n(32)(!1)).push([t.i,".slider-container{display:flex;flex-direction:row;padding-top:5px}.slider-container .slider-caption{height:14px;min-width:100px;max-width:200px;margin-bottom:4px;margin-right:4px}.slider-container .vue-slider .vue-slider-rail{background:#f0f3f5!important;cursor:pointer}.slider-container .vue-slider .vue-slider-rail .vue-slider-dot{background:#1985ac;border-radius:50%;cursor:ew-resize}.slider-container-loading{display:flex;flex-direction:row;padding-top:5px}.slider-container-loading .slider-caption{height:14px;min-width:100px;max-width:200px;margin-bottom:4px;margin-right:4px}.slider-container-loading .vue-slider{cursor:pointer;pointer-events:all}.slider-container-loading .vue-slider .vue-slider-rail{background:#f0f3f5!important}.slider-container-loading .vue-slider .vue-slider-rail .vue-slider-dot{border-radius:50%;cursor:ew-resize;transition:background 1s!important}",""]),t.exports=e},535:function(t,e,n){"use strict";var r=n(15),o=n(22),l=n(172),c=n(538),f=n.n(c),d=n(521),h=n(524),v=n(532),m=n.n(v);n(6).default.use(m.a);var y={name:"PageHeaderSeek",props:{id:{type:String,default:"",required:!0}},components:{VueSlider:f.a,PageHeaderItem:d.a},beforeMount:function(){var t=this;Object(r.H)(this.id).then((function(e){t.setPosition(e)})),Object(r.K)(this.id).then((function(e){t.totalSeconds=e})),this.$root.$on(o.c.seek.set(this.id),this.handleSeek),this.$root.$on(o.c.seek.reset(this.id),this.resetSeek),this.$root.$on(o.c.seek.step_fw(this.id),this.stepForward),this.$root.$on(o.c.seek.step_bw(this.id),this.stepBackward)},beforeDestroy:function(){this.$root.$off(o.c.seek.set(this.id),this.handleSeek),this.$root.$off(o.c.seek.reset(this.id),this.resetSeek),this.$root.$off(o.c.seek.step_fw(this.id),this.stepForward),this.$root.$off(o.c.seek.step_bw(this.id),this.stepBackward)},methods:{setPosition:function(t){var e=this;this.position=t,setTimeout((function(){e.isLoading=!1}),100)},doSeek:function(){var t=this;Object(r.Q)(this.id,this.position).then((function(e){t.position=e}))},handleSeek:Object(h.throttle)(100,!0,Object(h.debounce)(25,!0,(function(){this.doSeek()}))),resetSeek:function(){this.setPosition(null),this.handleSeek()},stepForward:function(){this.position=this.position+this.step,this.handleSeek()},stepBackward:function(){this.position=this.position-this.step,this.handleSeek()},handleDragStart:function(){this.isDragging=!0},handleDragEnd:function(){this.isDragging=!1}},computed:{keymap:function(){return{right:this.stepForward,left:this.stepBackward}},currentTime:function(){return null!==this.position&&null!==this.totalSeconds?Object(l.a)(this.position*this.totalSeconds):""},totalTime:function(){return null!==this.totalSeconds?Object(l.a)(this.totalSeconds):""},dotSize:function(){return this.isLoading?0:14}},data:function(){return{isLoading:!0,isDragging:!1,position:null,step:.01,options:{dotSize:14,width:120,height:4,contained:!0,direction:"ltr",data:null,min:0,max:1,interval:.01,disabled:!1,clickable:!0,duration:.09,adsorb:!1,lazy:!1,useKeyboard:!0,keydownHook:null,dragOnClick:!1,marks:!1,process:!1},totalSeconds:null}}},x=(n(533),n(18)),component=Object(x.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("PageHeaderItem",[n("div",{class:{"slider-container":!t.isLoading,"slider-container-loading":t.isLoading}},[n("span",{staticClass:"header-text slider-caption"},[t._v(t._s(t.currentTime)+" / "+t._s(t.totalTime))]),t._v(" "),n("vue-slider",t._b({on:{change:t.handleSeek,"drag-start":t.handleDragStart,"drag-end":t.handleDragEnd},model:{value:t.position,callback:function(e){t.position=e},expression:"position"}},"vue-slider",t.options,!1))],1)])}),[],!1,null,null,null);e.a=component.exports},544:function(t,e,n){"use strict";n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return y})),n.d(e,"c",(function(){return x}));n(17),n(13),n(20);var r=n(31),o=n(584),l=n(24),c=n.n(l),f=["BL","TL","TR","BR"],d=["x","y"];function h(t){for(var i=0;i<f.length;i++){if(!t.hasOwnProperty(f[i]))return!1;for(var e=0;e<d.length;e++){if(!t[f[i]].hasOwnProperty(d[e]))return!1;if("number"!=typeof t[f[i]][d[e]])return!1}}return!0}function v(rect,t){try{return c()(!(null===t)),{BL:{x:(rect.pos3[0]-t.left)/t.width,y:(rect.pos3[1]-t.top)/t.height},TL:{x:(rect.pos1[0]-t.left)/t.width,y:(rect.pos1[1]-t.top)/t.height},TR:{x:(rect.pos2[0]-t.left)/t.width,y:(rect.pos2[1]-t.top)/t.height},BR:{x:(rect.pos4[0]-t.left)/t.width,y:(rect.pos4[1]-t.top)/t.height}}}catch(t){return void console.warn("roiRectInfoToCoordinates: frame is null")}}function m(t,e){var n=(t.clientX-e.left)/e.width,r=(t.clientY-e.top)/e.height;return n<0&&(n=0),n>1&&(n=1),r<0&&(r=0),r>1&&(r=1),{x:n,y:r}}function y(t,e,n){var r=m(t,n),o=m(e,n);if(Math.abs(r.x-o.x)*Math.abs(r.y-o.y)>.01){var l=[r.x,o.x].sort(),c=[r.y,o.y].sort();return{BL:{x:l[1],y:c[0]},TL:{x:l[1],y:c[1]},TR:{x:l[0],y:c[1]},BR:{x:l[0],y:c[0]}}}return console.warn("invalid rectangle"),null}function x(t,e,n){try{return function(t){for(var content=[],col=0;col<4;col++)for(var e=0;e<4;e++)content=[].concat(Object(r.a)(content),[t[e][col]]);return"matrix3d(".concat(content.join(","),")")}(function(t,e){for(var n,l,b,c,i,f,d,h,v,m,y,x,S=["BL","TL","TR","BR"],w=[],E=[],C=0;C<S.length;C++)w=[].concat(Object(r.a)(w),[t[S[C]]]),E=[].concat(Object(r.a)(E),[e[S[C]]]);for(console.assert(w.length===(y=E.length)&&4===y),n=[],i=f=0;f<4;i=++f)n.push([w[i].x,w[i].y,1,0,0,0,-w[i].x*E[i].x,-w[i].y*E[i].x]),n.push([0,0,0,w[i].x,w[i].y,1,-w[i].x*E[i].y,-w[i].y*E[i].y]);for(b=[],i=d=0;d<4;i=++d)b.push(E[i].x),b.push(E[i].y);for(l=[[(c=(c=Object(o.a)(n,b)).reduce((function(a,b){return a.concat(b)}),[]))[0],c[1],0,c[2]],[c[3],c[4],0,c[5]],[0,0,1,0],[c[6],c[7],0,1]],i=v=0;v<4;i=++v){h=(m=Object(o.b)(l,[w[i].x,w[i].y,0,1]))[3],x=Object(o.b)(h,[E[i].x,E[i].y,0,1]);var O=Object(o.d)(m,x);console.assert(Object(o.c)(O)<1e-9,"Not equal:",m,x)}return l}({BL:{x:(rect=n).left,y:rect.bottom},TL:{x:rect.left,y:rect.top},TR:{x:rect.right,y:rect.top},BR:{x:rect.right,y:rect.bottom}},function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};try{var r={};return Object.keys(t).map((function(o){r[o]={x:t[o].x*e.width-n.x,y:t[o].y*e.height-n.y}})),r}catch(t){console.warn(t)}}(t,e,function(rect){return{x:rect.width/2,y:rect.height/2}}(n))))}catch(r){console.warn(r),console.warn("roi = "),console.warn(t),console.warn("frame = "),console.warn(e),console.warn("overlay = "),console.warn(n)}var rect}},545:function(t,e,n){"use strict";var r=n(531);n.n(r).a},546:function(t,e,n){(e=n(32)(!1)).push([t.i,".config-sidebar[data-v-65dc2cbb]{background:#fff;width:300px;max-width:300px;min-width:300px;float:right;height:calc(100vh - 38px);overflow-y:scroll;overflow-x:hidden;-ms-overflow-style:none;scrollbar-width:none}.config-sidebar[data-v-65dc2cbb]::-webkit-scrollbar{display:none}.sidebar-form-container[data-v-65dc2cbb]{margin-top:-30px;width:300px}.config-spinner[data-v-65dc2cbb]{position:relative;bottom:0;left:270px;font-size:18px;color:#3e515b;width:30px!important;height:30px!important}",""]),t.exports=e},547:function(t,e,n){var content=n(571);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("1ff3331c",content,!0,{sourceMap:!1})},553:function(t,e,n){"use strict";var r=n(536),o=(n(65),n(524)),l=(n(22),{name:"ConfigSidebar",components:{SchemaForm:r.a},props:{hidden:{type:Boolean,required:!0},id:{type:String,required:!0},skip:{type:Array,required:!1,default:function(){return["frame_interval_setting","Nf","dt","video_path","design_path","features","parameters","name","description","transform"]}}},beforeMount:function(){this.handleInit()},beforeDestroy:function(){this.handleCleanUp()},methods:{handleInit:function(){this.handleGetConfig()},handleCleanUp:function(){},handleGetConfig:function(){this.config=this.$store.getters["analyzers/getAnalyzerConfigCopy"](this.id),this.waiting=!1},handleSetConfig:function(){var t=this;this.waiting=!0,this.$store.dispatch("analyzers/set_config",{id:this.id,config:this.config}).then((function(){t.handleGetConfig()}))},handleUpdate:Object(o.throttle)(250,!1,Object(o.debounce)(250,!1,(function(){this.handleSetConfig()})))},computed:{schema:function(){return this.$store.getters["schemas/getConfigSchema"]},store_config:function(){return this.$store.getters["analyzers/getAnalyzerConfig"](this.id)}},watch:{store_config:function(){this.handleGetConfig()}},data:function(){return{config:{},ui_schema:[],waiting:!0}}}),c=(n(545),n(18)),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config-sidebar"},[n("div",{staticClass:"header-button-icon config-spinner"},[n("i",{class:{"fa fa-spinner fa-spin":t.waiting}})]),t._v(" "),n("div",{staticClass:"sidebar-form-container"},[t.config?n("SchemaForm",{staticClass:"config-form-container",attrs:{data:t.config,schema:t.schema,skip:t.skip,property_as_title:!0},on:{commit:t.handleUpdate}}):t._e()],1)])}),[],!1,null,"65dc2cbb",null);e.a=component.exports},563:function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(object,t){return Object.prototype.hasOwnProperty.call(object,t)},n.p="",n(n.s="fb15")}({8875:function(t,e,n){var r,o,l;"undefined"!=typeof self&&self,o=[],void 0===(l="function"==typeof(r=function(){return function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(t){var n,r,o,l=/.*at [^(]*\((.*):(.+):(.+)\)$/gi.exec(t.stack)||/@([^@]*):(\d+):(\d+)\s*$/gi.exec(t.stack),c=l&&l[1]||!1,line=l&&l[2]||!1,f=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");c===f&&(n=document.documentElement.outerHTML,r=new RegExp("(?:[^\\n]+?\\n){0,"+(line-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),o=n.replace(r,"$1").trim());for(var i=0;i<d.length;i++){if("interactive"===d[i].readyState)return d[i];if(d[i].src===c)return d[i];if(c===f&&d[i].innerHTML&&d[i].innerHTML.trim()===o)return d[i]}return null}}})?r.apply(e,o):r)||(t.exports=l)},fb15:function(t,e,n){"use strict";if(n.r(e),"undefined"!=typeof window){var r=window.document.currentScript,o=n("8875");r=o(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:o});var l=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(n.p=l[1])}function c(t){return void 0===t}var f=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var n=this._eventHandler[t]||[],r=n.length>0;if(!r)return!0;n=n.concat(),e.eventType=t;var o=!1,l=[e],i=0;e.stop=function(){o=!0},e.currentTarget=this;for(var c=arguments.length,f=new Array(c>2?c-2:0),d=2;d<c;d++)f[d-2]=arguments[d];for(f.length>=1&&(l=l.concat(f)),i=0;n[i];i++)n[i].apply(this,l);return!o},e.once=function(t,e){if("object"==typeof t&&c(e)){var i,n=t;for(i in n)this.once(i,n[i]);return this}if("string"==typeof t&&"function"==typeof e){var r=this;this.on(t,(function n(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];e.apply(r,l),r.off(t,n)}))}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&c(e)){var n,r=t;for(n in r)this.on(n,r[n]);return this}if("string"==typeof t&&"function"==typeof e){var o=this._eventHandler[t];c(o)&&(this._eventHandler[t]=[],o=this._eventHandler[t]),o.push(e)}return this},e.off=function(t,e){if(c(t))return this._eventHandler={},this;if(c(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,r=t;for(n in r)this.off(n,r[n]);return this}var o,l,f=this._eventHandler[t];if(f)for(o=0;void 0!==(l=f[o]);o++)if(l===e){f=f.splice(o,1);break}return this},t}();return t.VERSION="2.1.2",t}();function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map((function(e){return e.split(" ").map((function(e){return e?""+t+e:""})).join(" ")})).join(" ")}function h(t,e){return function(n){n&&(t[e]=n)}}function v(t,e,i){return function(n){n&&(t[e][i]=n)}}function m(t,e){return function(component){var n=component.prototype;t.forEach((function(t){e(n,t)}))}}var y=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,o=n.indexOf(t),l=-1===o?n.length:o;n[l]=t,r[l]=e},t}(),x=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),S="function"==typeof Map,w=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var link=this,t=-1;link;)link=link.prev,++t;return t},t}();var E=function(){function t(t,e,n,r,o,l,c,f){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=o,this.maintained=l,this.changedBeforeAdded=c,this.fixed=f}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=function(t,e){var n=[],r=[];return t.forEach((function(t){var e=t[0],o=t[1],link=new w;n[e]=link,r[o]=link})),n.forEach((function(link,i){link.connect(n[i-1])})),t.filter((function(t,i){return!e[i]})).map((function(t,i){var e=t[0],o=t[1];if(e===o)return[0,0];var l=n[e],c=r[o-1],f=l.getIndex();return l.disconnect(),c?l.connect(c,c.next):l.connect(void 0,n[0]),[f,l.getIndex()]}))}(this.changedBeforeAdded,this.fixed),e=this.changed,n=[];this.cacheOrdered=t.filter((function(t,i){var r=t[0],o=t[1],l=e[i],c=l[0],f=l[1];if(r!==o)return n.push([c,f]),!0})),this.cachePureChanged=n},t}();function C(t,e,n){var r=S?Map:n?x:y,o=n||function(t){return t},l=[],c=[],f=[],d=t.map(o),h=e.map(o),v=new r,m=new r,w=[],C=[],O={},M=[],D=0,R=0;return d.forEach((function(t,e){v.set(t,e)})),h.forEach((function(t,e){m.set(t,e)})),d.forEach((function(t,e){var n=m.get(t);void 0===n?(++R,c.push(e)):O[n]=R})),h.forEach((function(t,e){var n=v.get(t);void 0===n?(l.push(e),++D):(f.push([n,e]),R=O[e]||0,w.push([n-R,e-D]),C.push(e===n),n!==e&&M.push([n,e]))})),c.reverse(),new E(t,e,l,c,M,f,w,C)}var O=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){var e=[].slice.call(t),n=C(this.list,e,this.findKeyCallback);return this.list=e,n},t}(),M=("undefined"!=typeof document&&document,['"',"'",'\\"',"\\'"]);function D(t){return void 0===t}function R(t){return t&&"object"==typeof t}function P(t){return Array.isArray(t)}function z(t){return"string"==typeof t}function _(t,e,n,r){for(var i=n;i<r;++i){var o=e[i].trim();if(o===t)return i;var l=i;if("("===o?l=_(")",e,i+1,r):M.indexOf(o)>-1&&(l=_(o,e,i+1,r)),-1===l)break;i=l}return-1}function B(text,t){for(var e=new RegExp("(\\s*"+(t||",")+"\\s*|\\(|\\)|\"|'|\\\\\"|\\\\'|\\s+)","g"),n=text.split(e).filter(Boolean),r=n.length,o=[],l=[],i=0;i<r;++i){var c=n[i].trim(),f=i;if("("===c)f=_(")",n,i+1,r);else{if(")"===c)throw new Error("invalid format");if(M.indexOf(c)>-1)f=_(c,n,i+1,r);else if(c===t){l.length&&(o.push(l.join("")),l=[]);continue}}-1===f&&(f=r-1),l.push(n.slice(i,f+1).join("")),i=f}return l.length&&o.push(l.join("")),o}function k(text){return B(text,"")}function T(text){return B(text,",")}function G(text){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(text);return!t||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function A(text){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(text);if(!t)return{prefix:"",unit:"",value:NaN};var e=t[1],n=t[2];return{prefix:e,unit:t[3],value:parseFloat(n)}}function j(t,e){return void 0===e&&(e="-"),t.replace(/([a-z])([A-Z])/g,(function(t,n,r){return""+n+e+r.toLowerCase()}))}function I(){return Date.now?Date.now():(new Date).getTime()}function N(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function H(element,t){return element.classList?element.classList.contains(t):!!element.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function L(t,e,n,r){t.addEventListener(e,n,r)}function F(t,e,n){t.removeEventListener(e,n)}var Y=function(t,b){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function W(t,b){function e(){this.constructor=t}Y(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}var X=function(){return(X=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function $(s,t){var e={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&t.indexOf(p)<0&&(e[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)t.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(e[p[i]]=s[p[i]])}return e}function U(a,b){if(a===b)return!1;for(var i in a)if(!(i in b))return!0;for(var i in b)if(a[i]!==b[i])return!0;return!1}function V(a,b){var t=Object.keys(a),e=Object.keys(b),n=C(t,e,(function(t){return t})),r={},o={},l={};return n.added.forEach((function(t){var n=e[t];r[n]=b[n]})),n.removed.forEach((function(e){var n=t[e];o[n]=a[n]})),n.maintained.forEach((function(e){var n=e[0],r=t[n],o=[a[r],b[r]];a[r]!==b[r]&&(l[r]=o)})),{added:r,removed:o,changed:l}}function K(t){t.forEach((function(t){t()}))}function Z(t){var e=0;return t.map((function(t){return null==t?"$compat"+ ++e:""+t}))}function J(t,e,n,r){return z(t)?new at("text_"+t,e,n,r,null,{}):new("string"==typeof t.type?st:t.type.prototype.render?ft:lt)(t.type,e,n,r,t.ref,t.props)}function Q(t){var e=[];return t.forEach((function(t){e=e.concat(P(t)?Q(t):t)})),e}function tt(t){var e=t.className,n=$(t,["className"]);return null!=e&&(n.class=e),delete n.style,delete n.children,n}function et(t,e){if(!e)return t;for(var n in e)D(t[n])&&(t[n]=e[n]);return t}function nt(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=e||{},l=o.key,c=o.ref,f=$(o,["key","ref"]);return{type:t,key:l,ref:c,props:X(X({},f),{children:Q(n).filter((function(t){return null!=t&&!1!==t}))})}}var it=function(){function t(t,e,n,r,o,l){void 0===l&&(l={}),this.type=t,this.key=e,this.index=n,this.container=r,this.ref=o,this.props=l,this._providers=[]}var e=t.prototype;return e._should=function(t,e){return!0},e._update=function(t,e,n,r){if(this.base&&!z(e)&&!r&&!this._should(e.props,n))return!1;this.original=e,this._setState(n);var o=this.props;return z(e)||(this.props=e.props,this.ref=e.ref),this._render(t,this.base?o:{},n),!0},e._mounted=function(){var t=this.ref;t&&t(this.base)},e._setState=function(t){},e._updated=function(){var t=this.ref;t&&t(this.base)},e._destroy=function(){var t=this.ref;t&&t(null)},t}();function ot(t){var e={},n={};for(var r in t)0===r.indexOf("on")?n[r.replace("on","").toLowerCase()]=t[r]:e[r]=t[r];return{attributes:e,events:n}}var at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}W(e,t);var n=e.prototype;return n._render=function(t){var e=this,n=!this.base;return n&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push((function(){n?e._mounted():e._updated()})),!0},n._unmount=function(){this.base.parentNode.removeChild(this.base)},e}(it),st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={},e}W(e,t);var n=e.prototype;return n.addEventListener=function(t,e){var n=this.events;n[t]=function(t){t.nativeEvent=t,e(t)},this.base.addEventListener(t,n[t])},n.removeEventListener=function(t){var e=this.events;this.base.removeEventListener(t,e[t]),delete e[t]},n._should=function(t){return U(this.props,t)},n._render=function(t,e){var n=this,r=!this.base;r&&(this.base=document.createElement(this.type)),mt(this,this._providers,this.props.children,t,null);var base=this.base,o=ot(e),l=o.attributes,c=o.events,f=ot(this.props),d=f.attributes,h=f.events;return function(t,e,n){var r=V(t,e),o=r.added,l=r.removed,c=r.changed;for(var f in o)n.setAttribute(f,o[f]);for(var f in c)n.setAttribute(f,c[f][1]);for(var f in l)n.removeAttribute(f)}(tt(l),tt(d),base),function(t,e,n){var r=V(t,e),o=r.added,l=r.removed,c=r.changed;for(var f in l)n.removeEventListener(f);for(var f in o)n.addEventListener(f,o[f]);for(var f in c)n.removeEventListener(f),n.addEventListener(f,c[f][1]);for(var f in l)n.removeEventListener(f)}(c,h,this),function(t,e,n){var style=n.style,r=V(t,e),o=r.added,l=r.removed,c=r.changed;for(var f in o){var d=j(f,"-");style.setProperty?style.setProperty(d,o[f]):style[d]=o[f]}for(var f in c){d=j(f,"-");style.setProperty?style.setProperty(d,c[f][1]):style[d]=c[f][1]}for(var f in l){d=j(f,"-");style.removeProperty?style.removeProperty(d):style[d]=""}}(e.style||{},this.props.style||{},base),t.push((function(){r?n._mounted():n._updated()})),!0},n._unmount=function(){var t=this.events,base=this.base;for(var e in t)base.removeEventListener(e,t[e]);this._providers.forEach((function(t){t._unmount()})),this.events={},base.parentNode.removeChild(base)},e}(it);function ut(t){if(!t)return null;if(t instanceof Node)return t;var e=t._provider._providers;return e.length?ut(e[0].base):null}var lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}W(e,t);var n=e.prototype;return n._render=function(t){var template=this.type(this.props);return mt(this,this._providers,template?[template]:[],t),!0},n._unmount=function(){this._providers.forEach((function(t){t._unmount()}))},e}(it),ct=function(t){function e(base){var e=t.call(this,"container","container",0,null)||this;return e.base=base,e}W(e,t);var n=e.prototype;return n._render=function(){return!0},n._unmount=function(){},e}(it),ft=function(t){function e(e,n,r,o,l,c){return void 0===c&&(c={}),t.call(this,e,n,r,o,l,et(c,e.defaultProps))||this}W(e,t);var n=e.prototype;return n._should=function(t,e){return this.base.shouldComponentUpdate(et(t,this.type.defaultProps),e||this.base.state)},n._render=function(t,e,n){var r=this;this.props=et(this.props,this.type.defaultProps);var o=!this.base;o?(this.base=new this.type(this.props),this.base._provider=this):this.base.props=this.props;var base=this.base,l=base.state,template=base.render();template&&template.props&&!template.props.children.length&&(template.props.children=this.props.children),mt(this,this._providers,template?[template]:[],t,n,null),t.push((function(){o?(r._mounted(),base.componentDidMount()):(r._updated(),base.componentDidUpdate(e,l))}))},n._setState=function(t){t&&(this.base.state=t)},n._unmount=function(){this._providers.forEach((function(t){t._unmount()})),this.base.componentWillUnmount()},e}(it),pt=function(){function t(t){void 0===t&&(t={}),this.props=t,this.state={}}var e=t.prototype;return e.shouldComponentUpdate=function(t,e){return!0},e.render=function(){return null},e.setState=function(t,e,n){var r=[],o=this._provider;mt(o.container,[o],[o.original],r,X(X({},this.state),t),n)&&(e&&r.push(e),K(r))},e.forceUpdate=function(t){this.setState(this.state,t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},t}(),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return W(e,t),e.prototype.shouldComponentUpdate=function(t,e){return U(this.props,t)||U(this.state,e)},e}(pt),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}W(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.props,element=t.element,e=t.container;this._portalProvider=new ct(e),bt(element,e,this._portalProvider)},n.componentDidUpdate=function(){var t=this.props;bt(t.element,t.container,this._portalProvider)},n.componentWillUnmount=function(){bt(null,this.props.container,this._portalProvider),this._portalProvider=null},e}(ht);function vt(t,e,n){var r=n.map((function(p){return z(p)?null:p.key})),o=C(Z(e.map((function(p){return p.key}))),Z(r),(function(t){return t}));o.removed.forEach((function(t){e.splice(t,1)[0]._unmount()})),o.ordered.forEach((function(t){var n=t[0],r=t[1],o=e.splice(n,1)[0];e.splice(r,0,o);var l=ut(o.base),c=ut(e[r+1]&&e[r+1].base);l&&l.parentNode.insertBefore(l,c)})),o.added.forEach((function(o){e.splice(o,0,J(n[o],r[o],o,t))}));var l=o.maintained.filter((function(o){o[0];var l=o[1],c=n[l],f=e[l];return(z(c)?"text_"+c:c.type)!==f.type?(f._unmount(),e.splice(l,1,J(c,r[l],l,t)),!0):(f.index=l,!1)}));return function(){for(var s=0,i=0,t=arguments.length;i<t;i++)s+=arguments[i].length;var e=Array(s),n=0;for(i=0;i<t;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)e[n]=a[r];return e}(o.added,l.map((function(t){t[0];return t[1]})))}function mt(t,e,n,r,o,l){var c=vt(t,e,n),f=e.filter((function(t,i){return t._update(r,n[i],o,l)})),d=function t(e){if(!e)return null;var base=e.base;return base instanceof Node?base:t(e.container)}(t);return d&&c.reverse().forEach((function(n){var r=e[n],o=ut(r.base);if(o&&d!==o&&!o.parentNode){var l=function(t,e){for(var n=t._providers,r=n.length,i=e.index+1;i<r;++i){var o=ut(n[i].base);if(o)return o}return null}(t,r);d.insertBefore(o,l)}})),f.length>0}function bt(element,t,e){void 0===e&&(e=t.__REACT_COMPAT__);var n=!!e;return e||(e=new ct(t)),function(t,e,n){var r=[];mt(t,t._providers,e,r,n),K(r)}(e,element?[element]:[]),n||(t.__REACT_COMPAT__=e),e}function yt(element,t,e){var n=t.__REACT_COMPAT__;element&&!n&&(t.innerHTML=""),bt(element,t,n),e&&e()}var xt="undefined"!=typeof window&&window||{},St=(xt.RegExp,xt.navigator),wt=[{criteria:"PhantomJS",identity:"PhantomJS"},{criteria:/Whale/,identity:"Whale",versionSearch:"Whale"},{criteria:/Edge/,identity:"Edge",versionSearch:"Edge"},{criteria:/MSIE|Trident|Windows Phone/,identity:"IE",versionSearch:"IEMobile|MSIE|rv"},{criteria:/MiuiBrowser/,identity:"MIUI Browser",versionSearch:"MiuiBrowser"},{criteria:/SamsungBrowser/,identity:"Samsung Internet",versionSearch:"SamsungBrowser"},{criteria:/SAMSUNG /,identity:"Samsung Internet",versionSearch:"Version"},{criteria:/Chrome|CriOS/,identity:"Chrome"},{criteria:/Android/,identity:"Android Browser",versionSearch:"Version"},{criteria:/iPhone|iPad/,identity:"Safari",versionSearch:"Version"},{criteria:"Apple",identity:"Safari",versionSearch:"Version"},{criteria:"Firefox",identity:"Firefox"}],Et=[{criteria:/Windows Phone/,identity:"Windows Phone",versionSearch:"Windows Phone"},{criteria:"Windows 2000",identity:"Window",versionAlias:"5.0"},{criteria:/Windows NT/,identity:"Window",versionSearch:"Windows NT"},{criteria:/iPhone|iPad/,identity:"iOS",versionSearch:"iPhone OS|CPU OS"},{criteria:"Mac",versionSearch:"OS X",identity:"MAC"},{criteria:/Android/,identity:"Android"},{criteria:/Tizen/,identity:"Tizen"},{criteria:/Web0S/,identity:"WebOS"}],Ct=[{criteria:/iPhone|iPad/,browserVersionSearch:"Version",webviewBrowserVersion:/-1/},{criteria:/iPhone|iPad|Android/,webviewToken:/NAVER|DAUM|; wv/}],Ot={browser:{version:"-1",name:"unknown"},os:{version:"-1",name:"unknown"}};function filter(t,e){for(var n=[],i=0;i<t.length;i++)e(t[i])&&n.push(t[i]);return n}var Mt=void 0;function Dt(t){Mt=t}function Rt(base,t){return t&&t.test?!!t.test(base):base.indexOf(t)>-1}function Pt(t,e){var n=filter(t,(function(t){return Rt(Mt,t.criteria)}))[0];return n&&n.identity||e.name}function zt(t,e){return filter(t,(function(t){var n=t.criteria,r=new RegExp(t.identity,"i").test(e);return!!(n?r&&Rt(Mt,n):r)}))[0]}function _t(t,e){var n=Ot.browser.version,r=new RegExp("("+t+")","i").exec(e);if(!r)return n;var o=r.index,l=r[0];if(o>-1){var c=o+l.length+1;n=e.substring(c).split(" ")[0].replace(/_/g,".").replace(/;|\)/g,"")}return n}function Bt(t){if(t)return _t(function(t){var e=zt(wt,t);return e||(e={criteria:t,versionSearch:t,identity:t}),e}(t).versionSearch||t,Mt)}function kt(t){var e=function(t){return zt(Et,t)}(t)||{},n=Ot.os.version,r=void 0;if(t){if(e.versionAlias)return e.versionAlias;var o=e.versionSearch||t,l=new RegExp("("+o+")\\s([\\d_\\.]+|\\d_0)","i");return l.exec(Mt)&&(r=l.exec(Mt)[2].replace(/_/g,".").replace(/;|\)/g,"")),r||n}}function Tt(){var t=Pt(Et,Ot.os);return{name:t,version:kt(t)}}function Gt(){var t,e=Pt(wt,Ot.browser);return{name:e,version:Bt(e),webview:(t=void 0,function(t,e){for(var i=0;i<t.length;i++)if(e(t[i]))return!0;return!1}(filter(Ct,(function(t){return Rt(Mt,t.criteria)})),(function(e){return t=_t(e.browserVersionSearch,Mt),!(!Rt(Mt,e.webviewToken)&&!Rt(t,e.webviewBrowserVersion))})))}}function At(){return-1!==Mt.indexOf("Mobi")}function jt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St.userAgent;Dt(t);var e={os:Tt(),browser:Gt(),isMobile:At()};return e.browser.name=e.browser.name.toLowerCase(),e.os.name=e.os.name.toLowerCase(),e.os.version=e.os.version.toLowerCase(),"ios"===e.os.name&&e.browser.webview&&(e.browser.version="-1"),e}jt.VERSION="2.1.6";var It=jt;var Nt=function(t){for(var e=5381,i=t.length;i;)e=33*e^t.charCodeAt(--i);return e>>>0};var Ht=function(t){var e,n="rCS"+Nt(t).toString(36),r=0;return{className:n,inject:function(o,l){void 0===l&&(l={});var c,f=function(t){if(t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(o),d=0===r;return(f||d)&&(c=function(t,e,n,r){var style=document.createElement("style");style.setAttribute("type","text/css"),style.setAttribute("data-styled-id",t),n.nonce&&style.setAttribute("nonce",n.nonce);var o=e;return n.original||(o=e.replace(/([^}{]*){/gm,(function(e,n){return T(n).map((function(e){return e.indexOf(":global")>-1?e.replace(/\:global/g,""):e.indexOf(":host")>-1?""+e.replace(/\:host/g,"."+t):"."+t+" "+e})).join(", ")+"{"}))),style.innerHTML=o,(r||document.head||document.body).appendChild(style),style}(n,t,l,f)),d&&(e=c),f||++r,{destroy:function(){f?(o.removeChild(c),c=null):(r>0&&--r,0===r&&e&&(e.parentNode.removeChild(e),e=null))}}}}},Lt=function(t,b){return(Lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};var qt=function(){return(qt=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};var Ft=function(t,e){var n,r=Ht(e);return(n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return function(t,b){function e(){this.constructor=t}Lt(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(n,e),n.prototype.render=function(){var e=this.props,n=e.className,o=void 0===n?"":n,l=(e.cspNonce,function(s,t){var e={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&t.indexOf(p)<0&&(e[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)t.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(e[p[i]]=s[p[i]])}return e}(e,["className","cspNonce"])),c=r.className;return nt(t,qt({ref:h(this,"element"),"data-styled-id":c,className:o+" "+c},l))},n.prototype.componentDidMount=function(){this.injectResult=r.inject(this.element,{nonce:this.props.cspNonce})},n.prototype.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},n.prototype.getElement=function(){return this.element},n}(pt)).injector=r,n},Yt=function(){return(Yt=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function Wt(t){return 180*(e=[t[0].clientX,t[0].clientY],n=[t[1].clientX,t[1].clientY],r=n[0]-e[0],o=n[1]-e[1],((l=Math.atan2(o,r))>=0?l:l+2*Math.PI)/Math.PI);var e,n,r,o,l}function Xt(t,e,n,r){var o=Qt(t),l=Qt(e),c=Qt(r);return Ut(te(r[0],ee(o,c)),te(r[0],ee(l,c)),n[0])}function $t(t){return t.touches?Zt(t.touches):[Jt(t)]}function Ut(t,e,n){var r=t.clientX,o=t.clientY;return{clientX:r,clientY:o,deltaX:r-e.clientX,deltaY:o-e.clientY,distX:r-n.clientX,distY:o-n.clientY}}function Vt(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Kt(t,e,n){return t.map((function(t,i){return Ut(t,e[i],n[i])}))}function Zt(t){for(var e=Math.min(t.length,2),n=[],i=0;i<e;++i)n.push(Jt(t[i]));return n}function Jt(t){return{clientX:t.clientX,clientY:t.clientY}}function Qt(t){return 1===t.length?t[0]:{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function te(t,e){return{clientX:t.clientX+e.clientX,clientY:t.clientY+e.clientY}}function ee(t,e){return{clientX:t.clientX-e.clientX,clientY:t.clientY-e.clientY}}var ne=["textarea","input"],re=function(){function t(t,e){var n=this;void 0===e&&(e={}),this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.targets=[],this.prevTime=0,this.isDouble=!1,this.startRotate=0,this.onDragStart=function(t,e){if(void 0===e&&(e=!0),n.flag||!1!==t.cancelable){var r=n.options,o=r.container,l=r.pinchOutside,c=r.dragstart,f=r.preventRightClick,d=r.preventDefault,h=r.checkInput,v=n.isTouch;if(!n.flag){var m=document.activeElement,y=t.target,x=y.tagName.toLowerCase(),S=ne.indexOf(x)>-1,w=y.isContentEditable;if(S||w){if(h||m===y)return!1;if(m&&w&&m.isContentEditable&&m.contains(y))return!1}else if((d||"touchstart"===t.type)&&m){var E=m.tagName;(m.isContentEditable||ne.indexOf(E)>-1)&&m.blur()}}var C=0;if(!n.flag&&v&&l&&(C=setTimeout((function(){L(o,"touchstart",n.onDragStart,{passive:!1})}))),n.flag&&v&&l&&F(o,"touchstart",n.onDragStart),function(t){return t.touches&&t.touches.length>=2}(t)){if(clearTimeout(C),!n.flag&&t.touches.length!==t.changedTouches.length)return;n.pinchFlag||n.onPinchStart(t)}if(!n.flag){var O=n.startClients[0]?n.startClients:$t(t);n.customDist=[0,0],n.flag=!0,n.isDrag=!1,n.startClients=O,n.prevClients=O,n.datas={},n.movement=0;var M=Ut(O[0],n.prevClients[0],n.startClients[0]);if(f&&(3===t.which||2===t.button))return clearTimeout(C),n.initDrag(),!1;!1===(c&&c(Yt({type:"dragstart",datas:n.datas,inputEvent:t,isTrusted:e},M)))&&(clearTimeout(C),n.initDrag()),n.isDouble=I()-n.prevTime<200,n.flag&&d&&t.preventDefault()}}},this.onDrag=function(t,e){if(n.flag){var r=$t(t);n.pinchFlag&&n.onPinch(t,r);var o=n.move([0,0],t,r);if(o&&(o.deltaX||o.deltaY)){var l=n.options.drag;l&&l(Yt({},o,{isScroll:!!e,inputEvent:t}))}}},this.onDragEnd=function(t){if(n.flag){var e=n.options,r=e.dragend,o=e.pinchOutside,l=e.container;n.isTouch&&o&&F(l,"touchstart",n.onDragStart),n.pinchFlag&&n.onPinchEnd(t),n.flag=!1;var c=n.prevClients,f=n.startClients,d=n.pinchFlag?Xt(c,c,f,n.startPinchClients):Ut(c[0],c[0],f[0]),h=I(),v=!n.isDrag&&n.isDouble;n.prevTime=n.isDrag||v?0:h,n.startClients=[],n.prevClients=[],r&&r(Yt({type:"dragend",datas:n.datas,isDouble:v,isDrag:n.isDrag,inputEvent:t},d))}};var r=[].concat(t);this.options=Yt({checkInput:!1,container:r.length>1?window:r[0],preventRightClick:!0,preventDefault:!0,pinchThreshold:0,events:["touch","mouse"]},e);var o=this.options,l=o.container,c=o.events;if(this.isTouch=c.indexOf("touch")>-1,this.isMouse=c.indexOf("mouse")>-1,this.customDist=[0,0],this.targets=r,this.isMouse&&(r.forEach((function(t){L(t,"mousedown",n.onDragStart)})),L(l,"mousemove",this.onDrag),L(l,"mouseup",this.onDragEnd),L(l,"contextmenu",this.onDragEnd)),this.isTouch){var f={passive:!1};r.forEach((function(t){L(t,"touchstart",n.onDragStart,f)})),L(l,"touchmove",this.onDrag,f),L(l,"touchend",this.onDragEnd,f),L(l,"touchcancel",this.onDragEnd,f)}}var e=t.prototype;return e.isDragging=function(){return this.isDrag},e.isFlag=function(){return this.flag},e.isPinchFlag=function(){return this.pinchFlag},e.isPinching=function(){return this.isPinch},e.scrollBy=function(t,e,n,r){void 0===r&&(r=!0),this.flag&&(this.startClients.forEach((function(n){n.clientX-=t,n.clientY-=e})),this.prevClients.forEach((function(n){n.clientX-=t,n.clientY-=e})),r&&this.onDrag(n,!0))},e.move=function(t,e,n){var r=t[0],o=t[1];void 0===n&&(n=this.prevClients);var l=this.customDist,c=this.prevClients,f=this.startClients,d=this.pinchFlag?Xt(n,c,f,this.startPinchClients):Ut(n[0],c[0],f[0]);l[0]+=r,l[1]+=o,d.deltaX+=r,d.deltaY+=o;var h=d.deltaX,v=d.deltaY;return d.distX+=l[0],d.distY+=l[1],this.movement+=Math.sqrt(h*h+v*v),this.prevClients=n,this.isDrag=!0,Yt({type:"drag",datas:this.datas},d,{movement:this.movement,isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},e.onPinchStart=function(t){var e,n,r=this.options,o=r.pinchstart,l=r.pinchThreshold;if(!(this.isDrag&&this.movement>l)){var c=Zt(t.changedTouches);if(this.pinchFlag=!0,(e=this.startClients).push.apply(e,c),(n=this.prevClients).push.apply(n,c),this.startDistance=Vt(this.prevClients),this.startPinchClients=this.prevClients.slice(),o){var f=this.prevClients,d=Qt(f),h=Ut(d,d,d);this.startRotate=Wt(f),o(Yt({type:"pinchstart",datas:this.datas,angle:this.startRotate,touches:Kt(f,f,f)},h,{inputEvent:t}))}}},e.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){this.isPinch=!0;var n=this.options.pinch;if(n){var r=this.prevClients,o=this.startClients,l=Ut(Qt(e),Qt(r),Qt(o)),c=Wt(e),f=Vt(e);n(Yt({type:"pinch",datas:this.datas,movement:this.movement,angle:c,rotation:c-this.startRotate,touches:Kt(e,r,o),scale:f/this.startDistance,distance:f},l,{inputEvent:t}))}}},e.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var r=this.prevClients,o=this.startClients,l=Ut(Qt(r),Qt(r),Qt(o));n(Yt({type:"pinchend",datas:this.datas,isPinch:e,touches:Kt(r,r,o)},l,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},e.triggerDragStart=function(t){this.onDragStart(t,!1)},e.unset=function(){var t=this,e=this.targets,n=this.options.container;this.isMouse&&(e.forEach((function(e){F(e,"mousedown",t.onDragStart)})),F(n,"mousemove",this.onDrag),F(n,"mouseup",this.onDragEnd),F(n,"contextmenu",this.onDragEnd)),this.isTouch&&(e.forEach((function(e){F(e,"touchstart",t.onDragStart)})),F(n,"touchstart",this.onDragStart),F(n,"touchmove",this.onDrag),F(n,"touchend",this.onDragEnd),F(n,"touchcancel",this.onDragEnd))},e.initDrag=function(){this.startClients=[],this.prevClients=[],this.flag=!1},t}();var ie=re,oe=function(t,b){return(oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function ae(t){var e=t.container;return[e.scrollLeft,e.scrollTop]}var se=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startRect=null,e.startPos=[],e.prevTime=0,e.timer=0,e}!function(t,b){function e(){this.constructor=t}oe(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(e,t);var n=e.prototype;return n.dragStart=function(t,e){var n=e.container.getBoundingClientRect(),r=n.top,o=n.left,l=n.width,c=n.height;this.startPos=[t.clientX,t.clientY],this.startRect={top:r,left:o,width:l,height:c}},n.drag=function(t,e){var n=this,r=t.clientX,o=t.clientY,l=e.container,c=e.threshold,f=void 0===c?0:c,d=e.throttleTime,h=void 0===d?0:d,v=e.getScrollPosition,m=void 0===v?ae:v,y=this.startRect,x=this.startPos,S=I(),w=Math.max(h+this.prevTime-S,0),E=[0,0];if(y.top>o-f?(x[1]>y.top||o<x[1])&&(E[1]=-1):y.top+y.height<o+f&&(x[1]<y.top+y.height||o>x[1])&&(E[1]=1),y.left>r-f?(x[0]>y.left||r<x[0])&&(E[0]=-1):y.left+y.width<r+f&&(x[0]<y.left+y.width||r>x[0])&&(E[0]=1),clearTimeout(this.timer),!E[0]&&!E[1])return!1;if(w>0)return this.timer=window.setTimeout((function(){n.drag(t,e)}),w),!1;this.prevTime=S;var C=m({container:l,direction:E});this.trigger("scroll",{container:l,direction:E,inputEvent:t});var O=m({container:l,direction:E}),M=O[0]-C[0],D=O[1]-C[1];return!(!M&&!D)&&(this.trigger("move",{offsetX:E[0]?M:0,offsetY:E[1]?D:0,inputEvent:t}),h&&(this.timer=window.setTimeout((function(){n.drag(t,e)}),h)),!0)},n.dragEnd=function(){clearTimeout(this.timer)},e}(f),ue=function(t,b){return(ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};var le,ce="function"==typeof Map?void 0:(le=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++le)});var fe=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e,ce)||this}return function(t,b){function e(){this.constructor=t}ue(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(e,t),e}(O),pe=function(t,b){return(pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function de(t,b){function e(){this.constructor=t}pe(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}var he=function(){return(he=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function ge(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'+32*t+'px" height="'+32*t+'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate('+e+'deg);transform-origin: 16px 16px"></path></svg>'}var ve=It(("undefined"!=typeof navigator&&navigator||{}).userAgent||""),me=ve.os.name.indexOf("ios")>-1||ve.browser.name.indexOf("safari")>-1,be="moveable-",ye="\n{\n\tposition: fixed;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --zoom: 1;\n    --zoompx: 1px;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\tposition: absolute;\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n\tbackground: #4af;\n\tmargin-top: -7px;\n    margin-left: -7px;\n    width: calc(14 * var(--zoompx));\n    height: calc(14 * var(--zoompx));\n    margin-top: calc(-7 * var(--zoompx));\n    margin-left: calc(-7 * var(--zoompx));\n    border: calc(2 * var(--zoompx)) solid #fff;\n    z-index: 10;\n}\n.padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.line {\n\tposition: absolute;\n\twidth: 1px;\n    height: 1px;\n    width: var(--zoompx);\n    height: var(--zoompx);\n\tbackground: #4af;\n\ttransform-origin: 0px 50%;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top: var(--zoompx) dashed #4af;\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left: var(--zoompx) dashed #4af;\n}\n.line.dashed:before {\n    position: absolute;\n    content: attr(data-size);\n    color: #4af;\n    font-size: 12px;\n    font-weight: bold;\n}\n.line.dashed.horizontal:before, .line.gap.horizontal:before {\n    left: 50%;\n    transform: translateX(-50%);\n    bottom: 5px;\n}\n.line.dashed.vertical:before, .line.gap.vertical:before {\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.line.rotation-line {\n\theight: 40px;\n    width: 1px;\n    transform-origin: 50% calc(100% - 0.5px);\n    top: -40px;\n    width: var(--zoompx);\n    height: calc(40 * var(--zoompx));\n    top: calc(-40 * var(--zoompx));\n    transform-origin: 50% calc(100% - 0.5 * var(--zoompx));\n}\n.line.rotation-line .control {\n\tborder-color: #4af;\n\tbackground:#fff;\n    cursor: alias;\n    left: 50%;\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n    width: calc(2 * var(--zoompx));\n}\n.line.horizontal.bold {\n    height: 2px;\n    height: calc(2 * var(--zoompx));\n}\n\n.line.gap {\n    background: #f55;\n}\n.line.gap:before {\n    position: absolute;\n    content: attr(data-size);\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n    width: calc(12 * var(--zoompx));\n    height: calc(12 * var(--zoompx));\n    margin-top: calc(-6 * var(--zoompx));\n    margin-left: calc(-6 * var(--zoompx));\n\tpointer-events: none;\n}\n"+[0,15,30,45,60,75,90,105,120,135,150,165].map((function(t){return'\n.direction[data-rotation="'+t+'"] {\n\t'+function(t){var e=ge(1,t),n=ge(2,t),r=45*Math.round(t/45)%180,o=135===r?"nwse-resize":45===r?"nesw-resize":90===r?"ew-resize":"ns-resize";return"cursor:"+o+";cursor: url('"+e+"') 16 16, "+o+";cursor: -webkit-image-set(url('"+e+"') 1x, url('"+n+"') 2x) 16 16, "+o+";"}(t)+"\n}\n"})).join("\n")+"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n\n"+(me?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"")+"\n",xe=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Se=Math.pow(10,10),we=-Se,Ee=["nw","ne","sw","se","n","w","s","e"],Ce={n:[0,1],s:[2,3],w:[2,0],e:[1,3],nw:[0],ne:[1],sw:[2],se:[3]},Oe={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Me=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging"];function De(t,e,n,r,o,l){for(var i=0;i<o;++i){var c=n+i*o,f=r+i*o;t[c]+=t[f]*l,e[c]+=e[f]*l}}function Re(t,e,n,r,o){for(var i=0;i<o;++i){var l=n+i*o,c=r+i*o,f=t[l],d=e[l];t[l]=t[c],t[c]=f,e[l]=e[c],e[c]=d}}function Pe(t,e,n,r,o){for(var i=0;i<r;++i){var l=n+i*r;t[l]/=o,e[l]/=o}}function ze(t,e,n){void 0===n&&(n=Math.sqrt(t.length));for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function _e(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=Fe(e),i=0;i<e;++i){var o=e*i+i;if(0===n[o])for(var l=i+1;l<e;++l)if(n[e*i+l]){Re(n,r,i,l,e);break}if(!n[o])return[];Pe(n,r,i,e,n[o]);for(l=0;l<e;++l){var c=l,f=n[l+i*e];0!==f&&i!==l&&De(n,r,c,i,e,-f)}}return r}function Be(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=Math.atan2(r,n);return o>=0?o:o+2*Math.PI}function ke(t,e){for(var n=t.slice(),i=t.length;i<e-1;++i)n[i]=0;return n[e-1]=1,n}function Te(t,e,n){if(void 0===e&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=Fe(n),o=Math.min(e,n),i=0;i<o-1;++i){for(var l=0;l<o-1;++l)r[i*n+l]=t[i*e+l];r[(i+1)*n-1]=t[(i+1)*e-1],r[(n-1)*n+i]=t[(e-1)*e+i]}return r[n*n-1]=t[e*e-1],r}function Ge(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Fe(t);return e.forEach((function(e){r=Ae(r,e,t)})),r}function Ae(t,e,n){void 0===n&&(n=Math.sqrt(t.length));var r=[],o=t.length/n,l=e.length/o;if(!o)return e;if(!l)return t;for(var i=0;i<n;++i)for(var c=0;c<l;++c){r[c*n+i]=0;for(var f=0;f<o;++f)r[c*n+i]+=t[f*n+i]*e[c*o+f]}return r}function je(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length,r=0,i=n-1;i>=0;--i)r+=t[i];return n?r/n:0}function Ie(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function Ne(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function He(t,e,n){void 0===n&&(n=e.length);var r=Ae(t,e,n),o=r[n-1];return r.map((function(t){return t/o}))}function Le(t,e){return He(qe(e,3),ke(t,3))}function qe(t,e){var n=Math.cos(t),r=Math.sin(t),o=Fe(e);return o[0]=n,o[1]=r,o[e]=-r,o[e+1]=n,o}function Fe(t){for(var e=t*t,n=[],i=0;i<e;++i)n[i]=i%(t+1)?0:1;return n}function Ye(t,e){for(var n=Fe(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function We(t,e){for(var n=Fe(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function Xe(t,e,n,r,o,l,c,f){var d=t[0],h=t[1],v=e[0],m=e[1],y=n[0],x=n[1],S=r[0],w=r[1],E=o[0],C=o[1],O=l[0],M=l[1],D=c[0],R=c[1],P=f[0],z=f[1],_=_e([d,0,v,0,y,0,S,0,h,0,m,0,x,0,w,0,1,0,1,0,1,0,1,0,0,d,0,v,0,y,0,S,0,h,0,m,0,x,0,w,0,1,0,1,0,1,0,1,-E*d,-C*d,-O*v,-M*v,-D*y,-R*y,-P*S,-z*S,-E*h,-C*h,-O*m,-M*m,-D*x,-R*x,-P*w,-z*w],8);if(!_.length)return[];var B=Ae(_,[E,C,O,M,D,R,P,z],8);return B[8]=1,Te(function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],i=0;i<e;++i)for(var r=0;r<e;++r)n[r*e+i]=t[e*i+r];return n}(B),3,4)}function $e(t,e){var n=e.datas,r=t.state,o=r.matrix,l=r.beforeMatrix,c=r.is3d,f=r.left,d=r.top,h=r.origin,v=r.offsetMatrix,m=r.targetMatrix,y=r.transformOrigin,x=c?4:3;n.is3d=c,n.matrix=o,n.targetMatrix=m,n.beforeMatrix=l,n.offsetMatrix=v,n.transformOrigin=y,n.inverseMatrix=_e(o,x),n.inverseBeforeMatrix=_e(l,x),n.absoluteOrigin=ke(Ie([f,d],h),x),n.startDragBeforeDist=He(n.inverseBeforeMatrix,n.absoluteOrigin,x),n.startDragDist=He(n.inverseMatrix,n.absoluteOrigin,x)}function Ue(t,e){var n=t.datas,r=t.distX,o=t.distY,l=n.inverseBeforeMatrix,c=n.inverseMatrix,f=n.is3d,d=n.startDragBeforeDist,h=n.startDragDist,v=f?4:3;return Ne(He(e?l:c,Ie(n.absoluteOrigin,[r,o]),v),e?d:h)}function Ve(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function Ke(t,e){return Ve(e).map((function(e){return t[e]}))}function Ze(t,e){var n=Ke(t,e);return[je.apply(void 0,n.map((function(t){return t[0]}))),je.apply(void 0,n.map((function(t){return t[1]})))]}function Je(t,e){return Ze(t,e.map((function(t){return-t})))}function Qe(t,e,n,r,o,l){var c=Je(bn(e,n,r,o),l);return[t[0]-c[0],t[1]-c[1]]}function tn(t,e,n,r){return Ae(t,sn(e,r,n),r)}function en(t,e){var n=t.transformOrigin,r=t.offsetMatrix,o=t.is3d?4:3;return tn(r,Ae(t.targetMatrix,Ye(e,o),o),n,o)}function nn(t,e,n,r,o,l){var c=t.props.groupable,f=t.state,d=f.transformOrigin,h=f.targetMatrix,v=f.offsetMatrix,m=f.is3d,y=f.width,x=f.height,S=f.left,w=f.top,E=m?4:3,C=c?S:0,O=c?w:0;return Ne(Qe(o,tn(v,h,function(t,e,n,r,o,l){return void 0===r&&(r=e),void 0===o&&(o=n),void 0===l&&(l=[0,0]),t?t.map((function(t,i){var c=A(t),f=c.value,d=c.unit,h=i?o:r,v=i?n:e;return"%"===t||isNaN(f)?v*(h?l[i]/h:0):"%"!==d?f:v*f/100})):l}(l,e,n,y,x,d),E),e,n,E,r),[C,O])}function rn(t,e){return Je(Bn(t.state),e)}function on(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return d.apply(void 0,[be].concat(t))}function an(){return Fe(3)}function sn(t,e,n){return Ge(e,We(n,e),t,We(n.map((function(a){return-a})),e))}function un(t){return ln(Hn(t,":before")).map((function(e,i){var n=A(e),r=n.value,o=n.unit;return r*function(t,e,n){return"%"===e?gn(t.ownerSVGElement)[n?"width":"height"]/100:1}(t,o,0===i)}))}function ln(style){var t=style.transformOrigin;return t?t.split(" "):["0","0"]}function cn(t,e,n){for(var body=document.body,r=!t||n?t:t.parentElement,o=!1,l="relative";r&&r!==body;){e===r&&(o=!0);var style=Hn(r),c=style.transform;if("static"!==(l=style.position)||c&&"none"!==c)break;r=r.parentElement,l="relative"}return{isStatic:"static"===l,isEnd:o||!r||r===body,offsetParent:r||body}}function fn(t,e,style,n){var r,o=t.tagName.toLowerCase(),l=t.offsetLeft,c=t.offsetTop;if(n){var f=(e||document.documentElement).getBoundingClientRect();l-=f.left,c-=f.top}var d,h,v=D(l),m=!v;return m||"svg"===o?h=(d=ln(style).map((function(t){return parseFloat(t)}))).slice():(h=(d=me?un(t):ln(style).map((function(t){return parseFloat(t)}))).slice(),m=!0,"g"===o?(l=0,c=0):(l=(r=function(t,e){if(!t.getBBox)return[0,0];var n=t.getBBox(),r=gn(t.ownerSVGElement),o=n.x-r.x,l=n.y-r.y;return[o,l,e[0]-o,e[1]-l]}(t,d))[0],c=r[1],d[0]=r[2],d[1]=r[3])),{isSVG:v,hasOffset:m,offset:[l,c],origin:d,targetOrigin:h}}function pn(t,e,n){var r,o,l,a,c,f,d=t,h=[],v=!1,m=!1,y=3,x=cn(e,e,!0).offsetParent;for(n&&(v=t===e,n.length>10&&(m=!0,y=4),e=t.parentElement);d&&!v;){var style=Hn(d),S=d.tagName.toLowerCase(),w=style.position,E="fixed"===w,C=(f=style.transform,a=f&&"none"!==f?R(f)?f:G(f).value.split(/s*,\s*/g).map((function(t){return parseFloat(t)})):[1,0,0,1,0,0],void 0===(c=void 0)&&(c=6===a.length),c?[a[0],a[1],0,a[2],a[3],0,a[4],a[5],1]:a),O=C.length;if(!m&&16===O){m=!0,y=4;for(var M=h.length,i=0;i<M;++i)h[i]=Te(h[i],3,4)}m&&9===O&&(C=Te(C,3,4));var D=fn(d,e,style,E),P=D.hasOffset,z=D.isSVG,_=D.origin,B=D.targetOrigin,k=D.offset,T=k[0],A=k[1];"svg"===S&&l&&h.push(vn(d,y),Fe(y));var j=cn(d,e),I=j.offsetParent,N=j.isEnd,H=j.isStatic;me&&P&&!z&&H&&("relative"===w||"static"===w)&&(T-=I.offsetLeft,A-=I.offsetTop,v=v||N);var L=0,F=0;if(P&&x!==I&&(L=I.clientLeft,F=I.clientTop),h.push(sn(C,y,_),We(P?[T-d.scrollLeft+L,A-d.scrollTop+F]:[d,_],y)),l||(l=C),r||(r=_),o||(o=B),v||E)break;d=I,v=N}return l||(l=Fe(y)),r||(r=[0,0]),o||(o=[0,0]),{offsetContainer:x,matrixes:h,targetMatrix:l,transformOrigin:r,targetTransformOrigin:o,is3d:m}}function dn(t,e,n,r,o,l){var c=pn(t,e,r),f=c.matrixes,d=c.is3d,h=c.targetMatrix,v=c.transformOrigin,m=c.targetTransformOrigin,y=pn(c.offsetContainer,n,o),x=y.matrixes,S=y.is3d,w=S||d?4:3,E="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,C=e||document.body,O=r?Te(r,l,w):Fe(w),M=h,D=o?Te(o,l,w):Fe(w),P=r?Te(r,l,w):Fe(w),z=Fe(w),_=f.length,B=cn(C,C,!0).offsetParent;x.reverse(),f.reverse(),!d&&S&&(M=Te(M,3,4),f.forEach((function(t,i){f[i]=Te(t,3,4)}))),d&&!S&&x.forEach((function(t,i){x[i]=Te(t,3,4)})),o||x.forEach((function(t){D=Ae(D,t,w)})),f.forEach((function(t,i){var e;_-2===i&&(P=O.slice()),_-1===i&&(z=O.slice()),R(t[w*(w-1)])&&(e=function(t,e,n,r,o,l){var c,f=Mn(t,void 0,!0),d=f[0],h=f[1],v=e.getBoundingClientRect(),rect=t.getBoundingClientRect(),m=rect.left-v.left+e.scrollLeft-(e.clientLeft||0),y=rect.top-v.top+e.scrollTop-(e.clientTop||0),x=rect.width,S=rect.height,w=Ge(n,o,l),E=xn(w,d,h,n),C=E.left,O=E.top,M=E.width,D=E.height,R=mn(w,r,n),P=Ne(R,[C,O]),z=[m+P[0]*x/M,y+P[1]*S/D],_=[0,0],B=0;for(;++B<10;){var k=_e(o,n);c=Ne(mn(k,z,n),mn(k,R,n)),_[0]=c[0],_[1]=c[1];var T=xn(Ge(n,o,We(_,n),l),d,h,n),G=T.left,A=T.top,j=G-m,I=A-y;if(Math.abs(j)<2&&Math.abs(I)<2)break;z[0]-=j,z[1]-=I}return _.map((function(p){return Math.round(p)}))}(t[w*(w-1)],B,w,t[w*(w-1)+1],O,f[i+1]),t[w*(w-1)]=e[0],t[w*(w-1)+1]=e[1]),O=Ae(O,t,w)}));var k=!E&&d;M||(M=Fe(k?4:3));var T=hn(E&&16===M.length?Te(M,4,3):M,k);return[D=ze(D,w,w),P,z,O,M,T,v,m,d||S]}function hn(t,e){return void 0===e&&(e=t.length>9),(e?"matrix3d":"matrix")+"("+(a=t,n=!e,void 0===n&&(n=9===a.length),n?[a[0],a[1],a[3],a[4],a[6],a[7]]:a).join(",")+")";var a,n}function gn(t){var e=t.clientWidth,n=t.clientHeight,r=t.viewBox,o=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:o.x,y:o.y,width:o.width||e,height:o.height||n}}function vn(t,e){var n=t.clientWidth,r=t.clientHeight,o=gn(t),l=o.width,c=o.height,f=n/l,d=r/c,h=t.preserveAspectRatio.baseVal,v=h.align,m=h.meetOrSlice,y=[0,0],x=[f,d],S=[0,0];if(1!==v){var w=(v-2)%3,E=Math.floor((v-2)/3);y[0]=l*w/2,y[1]=c*E/2;var C=2===m?Math.max(d,f):Math.min(f,d);x[0]=C,x[1]=C,S[0]=(n-l)/2*w,S[1]=(r-c)/2*E}var O=Ye(x,e);return O[e*(e-1)]=S[0],O[e*(e-1)+1]=S[1],sn(O,e,y)}function mn(t,e,n){return He(t,ke(e,n),n)}function bn(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map((function(e){return mn(t,e,r)}))}function yn(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]})),r=Math.min.apply(Math,e),o=Math.min.apply(Math,n),l=Math.max.apply(Math,e),c=Math.max.apply(Math,n);return{left:r,top:o,right:l,bottom:c,width:l-r,height:c-o}}function xn(t,e,n,r){return yn(bn(t,e,n,r))}function Sn(t,e,n,r){var o=16===t.length?4:3,l=bn(t,n,r,o),c=l[0],f=c[0],d=c[1],h=l[1],v=h[0],m=h[1],y=l[2],x=y[0],S=y[1],w=l[3],E=w[0],C=w[1],O=mn(t,e,o),M=O[0],D=O[1],R=Math.min(f,v,x,E),P=Math.min(d,m,S,C),z=Math.max(f,v,x,E),_=Math.max(d,m,S,C);M=M-R||0,D=D-P||0;var B=[((f=f-R||0)+(v=v-R||0)+(x=x-R||0)+(E=E-R||0))/4,((d=d-P||0)+(m=m-P||0)+(S=S-P||0)+(C=C-P||0))/4],k=Be(B,[f,d]),T=Be(B,[v,m]);return[[R,P,z,_],[M,D],[[f,d],[v,m],[x,S],[E,C]],k<T&&T-k<Math.PI||k>T&&T-k<-Math.PI?1:-1]}function wn(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function En(t,e){return wn([e[0]-t[0],e[1]-t[1]])}function Cn(t,e,n){void 0===n&&(n=Be(t,e));var r=En(t,e);return{transform:"translateY(-50%) translate("+t[0]+"px, "+t[1]+"px) rotate("+n+"rad)",width:r+"px"}}function On(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e.length,o=e.reduce((function(t,e){return t+e[0]}),0)/r,l=e.reduce((function(t,e){return t+e[1]}),0)/r;return{transform:"translate("+o+"px, "+l+"px) rotate("+t+"rad)"}}function Mn(t,style,e,n){void 0===style&&(style=window.getComputedStyle(t)),void 0===n&&(n=e||"border-box"===style.boxSizing);var r=t.offsetWidth,o=t.offsetHeight,l=!D(r);if((e||n)&&l)return[r,o];if(!l&&"svg"!==t.tagName.toLowerCase()){var c=t.getBBox();return[c.width,c.height]}return r=t.clientWidth,o=t.clientHeight,e||n?[r+(parseFloat(style.borderLeftWidth)||0)+(parseFloat(style.borderRightWidth)||0),o+(parseFloat(style.borderTopWidth)||0)+(parseFloat(style.borderBottomWidth)||0)]:[r-(parseFloat(style.paddingLeft)||0)-(parseFloat(style.paddingRight)||0),o-(parseFloat(style.paddingTop)||0)-(parseFloat(style.paddingBottom)||0)]}function Dn(t,e){return Be(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Rn(t,e,n,r,o,l){var c,f,d,h,v,m=0,y=0,x=0,S=0,w=[0,0],E=[[0,0],[0,0],[0,0],[0,0]],C=an(),O=an(),M=an(),R=an(),P=an(),z=0,_=0,B=[0,0],k=1,T=1,G=!1,A="",j=[0,0],I={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},N={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},H={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},L=[0,0],F=0,Y=l?l.beforeMatrix:void 0,W=l?l.rootMatrix:void 0,X=l?l.is3d?4:3:void 0;if(e){if(l)z=l.width,_=l.height;else{var style=Hn(e);z=e.offsetWidth,_=e.offsetHeight,D(z)&&(z=(c=Mn(e,style,!0))[0],_=c[1])}C=(f=dn(e,n,o,Y,W,X))[0],M=f[1],O=f[2],R=f[3],P=f[4],A=f[5],B=f[6],L=f[7],G=f[8],m=(h=(d=Sn(R,B,z,_))[0])[0],y=h[1],x=h[2],S=h[3],w=d[1],E=d[2],k=d[3];var $;$=(v=Sn(O,Ie(B,function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i];return n[e-1]=0,n}(P,G?4:3)),z,_))[0],j=v[1],T=v[3],j=[j[0]+$[0]-m,j[1]+$[1]-y],I=Pn(e),N=Pn(cn(r,r,!0).offsetParent||document.body,!0),t&&(H=Pn(t)),F=Dn([E[0],E[1]],k)}return{rotation:F,targetClientRect:I,containerClientRect:N,moveableClientRect:H,beforeDirection:T,direction:k,target:e,left:m,top:y,right:x,bottom:S,pos1:E[0],pos2:E[1],pos3:E[2],pos4:E[3],width:z,height:_,rootMatrix:C,beforeMatrix:M,offsetMatrix:O,targetMatrix:P,matrix:R,targetTransform:A,is3d:G,beforeOrigin:j,origin:w,transformOrigin:B,targetOrigin:L}}function Pn(t,e){var n=t.getBoundingClientRect(),r=n.left,o=n.width,l=n.top,c=n.bottom,rect={left:r,right:n.right,top:l,bottom:c,width:o,height:n.height};return e&&(rect.clientLeft=t.clientLeft,rect.clientTop=t.clientTop,rect.clientWidth=t.clientWidth,rect.clientHeight=t.clientHeight,rect.scrollWidth=t.scrollWidth,rect.scrollHeight=t.scrollHeight),rect}function zn(t){if(t){var e=t.getAttribute("data-direction");if(e){var n=[0,0];return e.indexOf("w")>-1&&(n[0]=-1),e.indexOf("e")>-1&&(n[0]=1),e.indexOf("n")>-1&&(n[1]=-1),e.indexOf("s")>-1&&(n[1]=1),n}}}function _n(t,e){return[Ie(e,t[0]),Ie(e,t[1]),Ie(e,t[2]),Ie(e,t[3])]}function Bn(t){var e=t.left,n=t.top;return _n([t.pos1,t.pos2,t.pos3,t.pos4],[e,n])}function kn(t,e){return e?Math.round(t/e)*e:t}function Tn(t,e){return t.forEach((function(n,i){t[i]=kn(t[i],e)})),t}function Gn(t,e){t[e]&&(t[e].unset(),t[e]=null)}function An(t,e,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function jn(t,e,n){var r=e.datas;r.datas||(r.datas={});var o=he({},n,{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,datas:r.datas});return r.isStartEvent?r.lastEvent=o:r.isStartEvent=!0,o}function In(t,e,n){var r=e.datas,o="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),he({isDrag:o},n,{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas})}function Nn(t,e,n,r){return r&&co.prototype.triggerEvent.call(t,e,n),t.triggerEvent(e,n)}function Hn(t,e){return window.getComputedStyle(t,e)}function Ln(t,e,n){var r={},o={};return t.filter((function(t){var l=t.name;if(r[l]||!e.some((function(e){return t[e]})))return!1;if(!n&&t.ableGroup){if(o[t.ableGroup])return!1;o[t.ableGroup]=!0}return r[l]=!0,!0}))}function qn(t,e,n){return t*(e?n:1/n)}function Fn(t,e,n){return t*(e?1/n:n)}function Yn(t,e){return t===e||null==t&&null==e}function Wn(t,e){var n=[],r=[];return t.forEach((function(o,l){var c=e(o,l,t),f=r.indexOf(c),d=n[f]||[];-1===f&&(r.push(c),n.push(d)),d.push(o)})),n}function Xn(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function $n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(a,b){return Math.abs(b)-Math.abs(a)})),t[0]}function Un(t,e,n){return He(_e(t,n),ke(e,n),n)}function Vn(t,e){var n,r=t.is3d?4:3;return n=Un(t.rootMatrix,[e.distX,e.distY],r),e.distX=n[0],e.distY=n[1],e}function Kn(t,e,n,r,o){return Ne(mn(t,Ie(n,e),o),r)}function Zn(t,e,n){return[[e[0],e[0]*t[1]/t[0]],[e[1]*t[0]/t[1],e[1]]].filter((function(t){return t.every((function(t,i){return n?t<=e[i]:t>=e[i]}))}))[0]||t}function Jn(t,e){var n=A(t),r=n.value;return"%"===n.unit?r*e/100:r}function Qn(t,e,n){return n?t/e*100+"%":t+"px"}function er(t,e,n,r,o){var l=t[n],c=l.direction,f=l.pos,d=l.horizontal,h=l.vertical,sub=l.sub,v=[r*Math.abs(d),o*Math.abs(h)];c&&!sub?c.split("").forEach((function(n){var r="n"===n||"s"===n;t.forEach((function(t,i){var o=t.direction,l=t.horizontal,c=t.vertical,f=t.pos;o&&-1!==o.indexOf(n)&&(e[i]=Ie(f,[r||!l?0:v[0],r&&c?v[1]:0]))}))})):e[n]=Ie(f,v)}function nr(t,e){var n=e.clientX,r=e.clientY,o=e.datas,l=t.state,c=l.moveableClientRect,f=l.rootMatrix,d=l.is3d,h=l.pos1,v=Ne(Un(f,[n-c.left,r-c.top],d?4:3),h),m=Ue({datas:o,distX:v[0],distY:v[1]});return[m[0],m[1]]}function rr(t){return Math.abs(t)<=1e-7?0:t}function ir(t,e,n,r,o,l,c){var f="Start"===o;if(!t.state.target||f&&r.indexOf("Control")>-1&&!l.isRequest&&t.areaElement===l.inputEvent.target)return!1;var d=""+n+r+o,h=""+n+r+"Condition",v="End"===o,m=o.indexOf("After")>-1,y=f&&(!t.targetDragger||!t.controlDragger||!t.targetDragger.isFlag()||!t.controlDragger.isFlag());y&&t.updateRect(o,!0,!1),""!==o||m||Vn(t.state,l);var x=r.indexOf("Group")>-1,S=t[e].slice();if(l.isRequest){var w=l.requestAble;S.some((function(t){return t.name===w}))||S.push.apply(S,t.props.ables.filter((function(t){return t.name===w})))}if(!S.length)return!1;var E=S.filter((function(t){return t[d]})),C=l.datas,O=C.render||(C.render={}),M=he({},l,{datas:O,originalDatas:C});y&&E.forEach((function(e){e.unset&&e.unset(t)}));var D=E.filter((function(e){var n=f&&e[h],r=e.name,o=C[r]||(C[r]={});return!(n&&!e[h](l,t))&&e[d](t,he({},l,{datas:o,originalDatas:C}))})),R=D.length;if(f){if(E.length&&!R)return t.state.dragger=null,t.moveables&&t.moveables.forEach((function(t){t.state.dragger=null})),!1;!function(t,e,n){var r=jn(t,n,{isPinch:!!n.isPinch}),o=e?"Group":"";e&&(r.targets=t.props.targets),Nn(t,"onRender"+o+"Start",r)}(t,x,M)}else v?function(t,e,n){var r=jn(t,n,{isPinch:!!n.sPinch,isDrag:n.isDrag}),o=e?"Group":"";e&&(r.targets=t.props.targets),Nn(t,"onRender"+o+"End",r)}(t,x,M):m&&!R||function(t,e,n){var r=jn(t,n,{isPinch:!!n.isPinch}),o=e?"Group":"";e&&(r.targets=t.props.targets),Nn(t,"onRender"+o,r)}(t,x,M);if(v&&(t.state.dragger=null),t.isUnmounted)return!1;(!f&&R&&!c||v)&&(D.some((function(t){return t.updateRect}))&&!x?t.updateRect(o,!1,!1):t.updateRect(o,!0,!1),t.forceUpdate()),f||v||m||!R||ir(t,e,n,r,o+"After",l)}function or(t,e,n){var r=t.controlBox.getElement(),o=[];o.push(r),t.props.dragArea||o.push(e);var l=function(e){var n=e.inputEvent.target;return n===t.areaElement||!t.isMoveableElement(n)||n.className.indexOf("moveable-area")>-1||n.className.indexOf("moveable-padding")>-1};return ar(t,o,"targetAbles",n,{dragstart:l,pinchstart:l})}function ar(t,e,n,r,o){void 0===o&&(o={});var l=t.props,c=l.pinchOutside,f=l.pinchThreshold,d={container:window,pinchThreshold:f,pinchOutside:c};return["drag","pinch"].forEach((function(e){["Start","","End"].forEach((function(l){var c=""+e+l.toLowerCase();d[c]=function(f){return!(o[c]&&!o[c](f))&&ir(t,n,e,r,l,f)}}))})),new ie(e,d)}var sr={name:"pinchable",updateRect:!0,props:{pinchable:Boolean},events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},pinchStart:function(t,e){var n=e.datas,r=e.targets,o=e.angle,l=t.props,c=l.pinchable,f=l.ables;if(!c)return!1;var d="onPinch"+(r?"Group":"")+"Start",h="drag"+(r?"Group":"")+"ControlStart",v=(!0===c?t.controlAbles:f.filter((function(t){return c.indexOf(t.name)>-1}))).filter((function(t){return t.canPinch&&t[h]})),m=jn(t,e,{});r&&(m.targets=r);var y=Nn(t,d,m);n.isPinch=!1!==y,n.ables=v;var x=n.isPinch;return!!x&&(v.forEach((function(r){if(n[r.name+"Datas"]={},r[h]){var l=he({},e,{datas:n[r.name+"Datas"],parentRotate:o,isPinch:!0});r[h](t,l)}})),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},x)},pinch:function(t,e){var n=e.datas,r=e.scale,o=e.distance,l=e.inputEvent,c=e.targets,f=e.angle;if(n.isPinch){var d=o*(1-1/r),h=jn(t,e,{});c&&(h.targets=c),Nn(t,"onPinch"+(c?"Group":""),h);var v=n.ables,m="drag"+(c?"Group":"")+"Control";return v.forEach((function(r){r[m]&&r[m](t,he({},e,{datas:n[r.name+"Datas"],inputEvent:l,parentDistance:d,parentRotate:f,isPinch:!0}))})),h}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,o=e.inputEvent,l=e.targets;if(n.isPinch){var c="onPinch"+(l?"Group":"")+"End",f=In(t,e,{isDrag:r});l&&(f.targets=l),Nn(t,c,f);var d=n.ables,h="drag"+(l?"Group":"")+"ControlEnd";return d.forEach((function(l){l[h]&&l[h](t,he({},e,{isDrag:r,datas:n[l.name+"Datas"],inputEvent:o,isPinch:!0}))})),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,he({},e,{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,he({},e,{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,he({},e,{targets:t.props.targets}))}};function ur(t,e,n,r,o){var l=t.dragger.move(e,n),c=l.originalDatas||l.datas,f=c.draggable||(c.draggable={});return he({},o?Vn(t,l):l,{isDrag:!0,isPinch:!!r,parentEvent:!0,datas:f})}var lr=function(){function t(){this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}}}var e=t.prototype;return e.dragStart=function(t,e){return this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},he({},this.move(t,e),{type:"dragstart"})},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var n,r;return this.isFlag?(n=this.prevX+t[0],r=this.prevY+t[1],this.isDrag=!0):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],r=t[1],this.isFlag=!0),this.prevX=n,this.prevY=r,{type:"drag",clientX:n,clientY:r,inputEvent:e,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas.draggable,originalDatas:this.datas,parentEvent:!0,parentDragger:this}},t}();function cr(t,e,n,r,o,l){var c=!!n.match(/Start$/g),f=!!n.match(/End$/g),d=o.inputEvent,h=o.isPinch,v=o.datas,m=t.moveables.map((function(t,i){var o={};c?o=(new lr).dragStart(r,d):(t.state.dragger||(t.state.dragger=v.childDraggers[i]),o=ur(t.state,r,d,h,l));var m=e[n](t,he({},o,{parentFlag:!0}));return f&&(t.state.dragger=null),m}));return c&&(v.childDraggers=t.moveables.map((function(t){return t.state.dragger}))),m}function fr(t,e,n,r,o,l){var c=e.name,f=r[c]||(r[c]=[]),d=!!n.match(/End$/g);return t.moveables.map((function(t,i){var r=f[i]||(f[i]={}),c="function"==typeof o?o(t,r):o,h=e[n](t,he({},c,{datas:r,parentFlag:!0}));return h&&l&&l(t,r,h,i),d&&(t.state.dragger=null),h}))}function pr(t){return t.isRequest?("resizable"===t.requestAble||"scalable"===t.requestAble)&&t.parentDirection:H(t.inputEvent.target,on("direction"))}function dr(t,e,n,r,o,l){var c=o[0],f=o[1],d=l[0],h=l[1],v=[],m=r?0:1,y="vertical"===e?"horizontal":"vertical",x=Wn(t.filter((function(t){return t.type===e})),(function(t){return t.element})).map((function(t){return t[0]})).filter((function(t){var e=t.pos,n=t.sizes;return e[m]<=h&&d<=e[m]+n[m]}));return x.forEach((function(t){var e=t.pos[r],o=e+t.sizes[r];x.forEach((function(t){var l=t.pos,d=t.sizes,h=t.element,m=l[r],S=m+d[r],w=0,E=0,C=!0;if(o<=m)c<(w=S-(E=o-m))-n&&(C=!1);else{if(!(S<=e))return;f>(w=m-(E=e-S))+n&&(C=!1)}if(C&&v.push({pos:"vertical"===y?[w,l[1]]:[l[0],w],element:h,sizes:d,size:0,type:y,gap:E,gapGuidelines:x}),o<=c&&f<=m){var O=(m+o-(f-c))/2;kn(c-(O-n),.1)>=0&&v.push({pos:"vertical"===y?[O,l[1]]:[l[0],O],element:h,sizes:d,size:0,type:y,gap:o-c,gapGuidelines:x})}}))})),v}function gr(t,e,n,r,o){var l=function(t){var e=t.state,n=e.guidelines,r=e.containerClientRect,o=r.scrollHeight,l=r.scrollWidth,c=t.props,f=c.snapHorizontal,d=void 0===f||f,h=c.snapVertical,v=void 0===h||h,m=c.snapGap,y=void 0===m||m,x=c.verticalGuidelines,S=c.horizontalGuidelines,w=c.snapThreshold,E=void 0===w?5:w,C=n.slice();if(y){var O=yn(Bn(t.state)),M=O.top,D=O.left,R=O.bottom,P=O.right,z=n.filter((function(t){return t.element}));C.push.apply(C,dr(z,"horizontal",E,0,[D,P],[M,R]).concat(dr(z,"vertical",E,1,[M,R],[D,P])))}return d&&S&&S.forEach((function(t){C.push({type:"horizontal",pos:[0,kn(t,.1)],size:l})})),v&&x&&x.forEach((function(t){C.push({type:"vertical",pos:[kn(t,.1),0],size:o})})),C}(t),c=t.props,f=c.snapElement,d=void 0===f||f,h=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,i=0;i<n;++i){var r=t[i];if(!D(r))return r}return t[n]}(o,c.snapThreshold,5);return{vertical:mr(l,"vertical",e,h,r,d),horizontal:mr(l,"horizontal",n,h,r,d)}}function vr(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],o=r.offset,l=r.dist,c=r.guideline;return{isSnap:e,offset:o,dist:l,pos:n.pos,guideline:c}}function mr(t,e,n,r,o,l){if(!t||!t.length)return{isSnap:!1,posInfos:[]};var c="vertical"===e?0:1,f=n.map((function(n){var f=t.map((function(t){var e=t.pos,r=n-e[c];return{offset:r,dist:Math.abs(r),guideline:t}})).filter((function(t){var n=t.guideline,c=t.dist,f=n.type,d=n.center,element=n.element;return!(!l&&element||!o&&d||f!==e||c>r)})).sort((function(a,b){return a.dist-b.dist}));return{pos:n,guidelineInfos:f}})).filter((function(t){return t.guidelineInfos.length>0})).sort((function(a,b){return a.guidelineInfos[0].dist-b.guidelineInfos[0].dist}));return{isSnap:f.length>0,posInfos:f}}function yr(t,e){return t.slice().sort((function(a,b){var t=a.sign[e],n=b.sign[e],r=a.offset[e],o=b.offset[e],l=Math.abs(r),c=Math.abs(o);return t?n?a.isBound&&b.isBound?c-l:a.isBound?-1:b.isBound?1:a.isSnap&&b.isSnap?l-c:a.isSnap?-1:b.isSnap||l<1e-7?1:c<1e-7?-1:l-c:-1:1}))[0]}function xr(t,line){var e=je(line[0][0],line[1][0]),n=je(line[0][1],line[1][1]);return{vertical:e<=t[0],horizontal:n<=t[1]}}function Sr(t,e){var n,r,o=e[0],l=e[1],c=l[0]-o[0],f=l[1]-o[1];if(Math.abs(c)<1e-7&&(c=0),Math.abs(f)<1e-7&&(f=0),c)if(f){n=f/c*(t[0]-o[0])+o[1],r=t[1]}else n=o[1],r=t[1];else n=o[0],r=t[0];return n-r}function wr(t,line,e){void 0===e&&(e=1e-7);var n=Sr(t[0],line)<=0;return t.slice(1).every((function(t){var r=Sr(t,line);return r<=0===n||Math.abs(r)<=e}))}function Er(t,e,n,r,o){return void 0===o&&(o=0),r&&e-o<=t||!r&&t<=n+o?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function Cr(line,t,e,n,r){var o=line[0],l=line[1],c=t[0],f=t[1],d=rr(l[1]-o[1]),h=rr(l[0]-o[0]),v=rr(f[1]-c[1]);if(!rr(f[0]-c[0])){if(r&&!d)return{isBound:!1,offset:0};if(h)return Er(d/h*(c[0]-o[0])+o[1],c[1],f[1],e,n);var m=c[0]-o[0];return{isBound:y=Math.abs(m)<=(n||0),offset:y?m:0}}if(!v){if(r&&!h)return{isBound:!1,offset:0};if(d)return Er((c[1]-o[1])/(d/h)+o[0],c[0],f[0],e,n);var y;m=c[1]-o[1];return{isBound:y=Math.abs(m)<=(n||0),offset:y?m:0}}return{isBound:!1,offset:0}}function Or(t,e,n,r){return e.map((function(e){var o=e[0],l=e[1],c=e[2],f=function(t,line,e){var n=t.props.innerBounds;if(!n)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var r=n.left,o=n.top,l=n.width,c=n.height,f=[[r,o],[r,o+c]],d=[[r,o],[r+l,o]],h=[[r+l,o],[r+l,o+c]],v=[[r,o+c],[r+l,o+c]],m=xr(e,line),y=m.horizontal,x=m.vertical;if(wr([e,[r,o],[r+l,o],[r,o+c],[r+l,o+c]],line))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Cr(line,d,x),w=Cr(line,v,x),E=Cr(line,f,y),C=Cr(line,h,y),O=S.isBound&&w.isBound,M=S.isBound||w.isBound,D=E.isBound&&C.isBound,R=E.isBound||C.isBound,P=$n(S.offset,w.offset),z=$n(E.offset,C.offset),_=[0,0],B=!1,k=!1;return Math.abs(z)<Math.abs(P)?(_=[P,0],B=M,k=O):(_=[0,z],B=R,k=D),{isAllBound:k,isVerticalBound:M,isHorizontalBound:R,isBound:B,offset:_}}(t,[l,c],n),d=f.isBound,h=f.offset,v=f.isVerticalBound,m=f.isHorizontalBound,y=Ue({datas:r,distX:h[0],distY:h[1]}).map((function(t,i){return t*(o[i]?2/o[i]:0)}));return{sign:o,isBound:d,isVerticalBound:v,isHorizontalBound:m,isSnap:!1,offset:y}}))}function Mr(t,e,n){var r,o=Or(t,Dr(e,[0,0],!1).map((function(t){var e=t[0],n=t[1],r=t[2];return[e.map((function(t){return 2*Math.abs(t)})),n,r]})),Ze(e,[0,0]),n),l=yr(o,0),c=yr(o,1),f=0,d=0,h=l.isVerticalBound||c.isVerticalBound,v=l.isHorizontalBound||c.isHorizontalBound;return(h||v)&&(f=(r=function(t,e){var n=t.datas,r=t.distX,o=t.distY,l=n.beforeMatrix,c=n.matrix,f=n.is3d,d=n.startDragBeforeDist,h=n.startDragDist,v=n.absoluteOrigin,m=f?4:3;return Ne(He(e?l:c,Ie(e?d:h,[r,o]),m),v)}({datas:n,distX:-l.offset[0],distY:-c.offset[1]}))[0],d=r[1]),{vertical:{isBound:h,offset:f},horizontal:{isBound:v,offset:d}}}function Dr(t,e,n){return function(t,e){var n=[],r=t[0],o=t[1];return r&&o?n.push([[0,2*o],t,[-r,o]],[[2*r,0],t,[r,-o]]):r?(n.push([[2*r,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):o?(n.push([[0,2*o],[1,o],[-1,o]]),e&&n.push([[-1,0],[-1,o],[-1,-o]],[[1,0],[1,o],[1,-o]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}(e,n).map((function(e){var n=e[0],r=e[1],o=e[2];return[n,Ze(t,r),Ze(t,o)]}))}function Rr(t,e,n,r){var o=r?t.map((function(t){return Le(t,r)})):t,l=[n].concat(e);return[[o[0],o[1]],[o[1],o[3]],[o[3],o[2]],[o[2],o[0]]].some((function(line,i){return!wr(l,line)}))}function Pr(t,e,n,r,o){var l=t.props.innerBounds,c=o*Math.PI/180;if(!l)return[];var f=l.left,d=l.top,h=l.width,v=l.height,m=f-r[0],y=f+h-r[0],x=d-r[1],S=d+v-r[1],w=[[m,x],[y,x],[m,S],[y,S]],E=Ze(n,[0,0]);if(!Rr(n,w,E,0))return[];var C=[],O=w.map((function(t){return[wn(t),Be([0,0],t)]}));return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach((function(line){var t=Be([0,0],function(t){var e=t[0],n=t[1],r=n[0]-e[0],o=n[1]-e[1];if(!r)return[e[0],0];if(!o)return[0,e[1]];var a=o/r,b=-a*e[0]+e[1];return[-b/(a+1/a),b/(a*a+1)]}(line)),n=function(t){var e=t[0],n=t[1],r=n[0]-e[0],o=n[1]-e[1];if(!r)return Math.abs(e[0]);if(!o)return Math.abs(e[1]);var a=o/r;return Math.abs((-a*e[0]+e[1])/Math.sqrt(Math.pow(a,2)+1))}(line);C.push.apply(C,O.filter((function(t){var e=t[0];return e&&n<=e})).map((function(e){var r=e[0],o=e[1],l=Math.acos(r?n/r:0);return[c+(o+l)-t,c+(o-l)-t]})).reduce((function(t,e){return t.push.apply(t,e),t}),[]).filter((function(t){return!Rr(e,w,E,t)})).map((function(t){return kn(180*t/Math.PI,1e-7)})))})),C}function zr(t,e,n){var r=t.props.bounds||{},o=r.left,l=void 0===o?-1/0:o,c=r.top,f=void 0===c?-1/0:c,d=r.right,h=void 0===d?1/0:d,v=r.bottom,m={left:l,top:f,right:h,bottom:void 0===v?1/0:v};return{vertical:_r(m,e,!0),horizontal:_r(m,n,!1)}}function _r(t,e,n){var r=t[n?"left":"top"],o=t[n?"right":"bottom"],l=Math.min.apply(Math,e),c=Math.max.apply(Math,e);return r+1>l?{isBound:!0,offset:l-r,pos:r}:o-1<c?{isBound:!0,offset:c-o,pos:o}:{isBound:!1,offset:0,pos:0}}function Br(t,e,n){return(n?t.map((function(t){return Le(t,n)})):t).some((function(t){return t[0]<e.left&&Math.abs(t[0]-e.left)>.1||t[0]>e.right&&Math.abs(t[0]-e.right)>.1||t[1]<e.top&&Math.abs(t[1]-e.top)>.1||t[1]>e.bottom&&Math.abs(t[1]-e.bottom)>.1}))}function kr(t,e,n,r,o){var l=t.props.bounds,c=o*Math.PI/180;if(!l)return[];var f=l.left,d=void 0===f?-1/0:f,h=l.top,v=void 0===h?-1/0:h,m=l.right,y=void 0===m?1/0:m,x=l.bottom,S=void 0===x?1/0:x,w=d-r[0],E=y-r[0],C=v-r[1],O=S-r[1],M={left:w,top:C,right:E,bottom:O};if(!Br(n,M,0))return[];var D=[];return[[w,0],[E,0],[C,1],[O,1]].forEach((function(t,i){var r=t[0],o=t[1];n.forEach((function(t){var n=Be([0,0],t);D.push.apply(D,function(t,e,n){var r=wn(t),o=Math.sqrt(r*r-e*e)||0;return[o,-o].sort((function(a,b){return Math.abs(a-t[n?0:1])-Math.abs(b-t[n?0:1])})).map((function(t){return Be([0,0],n?[t,e]:[e,t])}))}(t,r,o).map((function(t){return c+t-n})).filter((function(t){return!Br(e,M,t)})).map((function(t){return kn(180*t/Math.PI,1e-7)})))}))})),D}function Tr(t,e,n){var r=mn(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function Gr(t){var e=t.state;if(!e.guidelines||!e.guidelines.length){var n=t.props,r=n.horizontalGuidelines,o=void 0===r?[]:r,l=n.verticalGuidelines,c=void 0===l?[]:l,f=n.elementGuidelines,d=void 0===f?[]:f,h=n.bounds,v=n.innerBounds,m=n.snapCenter;if(v||h||o.length||c.length||d.length){var y=e.containerClientRect,x=e.targetClientRect,S=x.top,w=x.left,E=e.rootMatrix,C=e.is3d?4:3,O=Tr(E,y,C),M=O[0],D=O[1],R=Bn(e),P=Ne([Math.min.apply(Math,R.map((function(t){return t[0]}))),Math.min.apply(Math,R.map((function(t){return t[1]})))],Un(E,[w-M,S-D],C)).map((function(t){return e=t,Math.round(e%1==-.5?e-1:e);var e})),z=P[0],_=P[1],B=[];d.forEach((function(t){var rect=t.getBoundingClientRect(),e=rect.left-M,n=rect.top-D,r=n+rect.height,o=e+rect.width,l=Un(E,[e,n],C),c=l[0],f=l[1],d=Un(E,[o,r],C),h=d[0],v=d[1],y=h-c,x=v-f,S=[y,x];B.push({type:"vertical",element:t,pos:[kn(c+z,.1),f],size:x,sizes:S}),B.push({type:"vertical",element:t,pos:[kn(h+z,.1),f],size:x,sizes:S}),B.push({type:"horizontal",element:t,pos:[c,kn(f+_,.1)],size:y,sizes:S}),B.push({type:"horizontal",element:t,pos:[c,kn(v+_,.1)],size:y,sizes:S}),m&&(B.push({type:"vertical",element:t,pos:[kn((c+h)/2+z,.1),f],size:x,sizes:S,center:!0}),B.push({type:"horizontal",element:t,pos:[c,kn((f+v)/2+_,.1)],size:y,sizes:S,center:!0}))})),e.guidelines=B,e.enableSnap=!0}}}function Ar(t,e){var n=t.props,r=n.snappable,o=n.bounds,l=n.innerBounds,c=n.verticalGuidelines,f=n.horizontalGuidelines,d=t.state,h=d.guidelines,v=d.enableSnap;return!(!r||!v||e&&!0!==r&&r.indexOf(e)<0)&&!!(o||l||h&&h.length||c&&c.length||f&&f.length)}function jr(t,e,n,r,o){var l=function(t,e,n,r){var o=e[0]-t[0],l=e[1]-t[1];Math.abs(o)<1e-7&&(o=0);Math.abs(l)<1e-7&&(l=0);if(!o)return r?[0,0]:[0,n];if(!l)return r?[n,0]:[0,0];var a=l/o,b=t[1]-a*t[0];if(r){var c=a*(e[0]+n)+b;return[n,c-e[1]]}return[(e[1]+n-b)/a-e[0],n]}(t,e,n,r);if(!l)return[0,0];var c=Ue({datas:o,distX:l[0],distY:l[1]});return[c[0],c[1]]}function Ir(t,e,n,r,o,l){var c=bn(t,e,n,l?4:3);return _n(c,Ne(r,Je(c,o)))}function Nr(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Hr(t,e){return t.isBound?t.offset:e.isSnap?vr(e).offset:0}function Lr(t,e,n,r){var o=function(t,e,n){var r=t.props.bounds||{},o=r.left,l=void 0===o?-1/0:o,c=r.top,f=void 0===c?-1/0:c,d=r.right,h=void 0===d?1/0:d,v=r.bottom,m=void 0===v?1/0:v,y=n[0],x=n[1],S=Ne(n,e),w=S[0],E=S[1];Math.abs(w)<1e-7&&(w=0),Math.abs(E)<1e-7&&(E=0);var C=E>0,O=w>0,M={isBound:!1,offset:0,pos:0},D={isBound:!1,offset:0,pos:0};if(0===w&&0===E)return{vertical:M,horizontal:D};if(0===w)C?m<x&&(D.pos=m,D.offset=x-m):f>x&&(D.pos=f,D.offset=x-f);else if(0===E)O?h<y&&(M.pos=h,M.offset=y-h):l>y&&(M.pos=l,M.offset=y-l);else{var a=E/w,b=n[1]-a*y,R=0,P=0,z=!1;O&&h<=y?(R=a*h+b,P=h,z=!0):!O&&y<=l&&(R=a*l+b,P=l,z=!0),z&&(R<f||R>m)&&(z=!1),z||(C&&m<=x?(P=((R=m)-b)/a,z=!0):!C&&x<=f&&(P=((R=f)-b)/a,z=!0)),z&&(M.isBound=!0,M.pos=P,M.offset=y-P,D.isBound=!0,D.pos=R,D.offset=x-R)}return{vertical:M,horizontal:D}}(t,e,n),l=o.horizontal,c=o.vertical,f=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:function(t,e,n){var r=n[0],o=n[1],l=e[0],c=e[1],f=Ne(n,e),d=f[0],h=f[1],v=h>0,m=d>0;d=rr(d),h=rr(h);var y={isSnap:!1,offset:0,pos:0},x={isSnap:!1,offset:0,pos:0};if(0===d&&0===h)return{vertical:y,horizontal:x};var S=gr(t,d?[r]:[],h?[o]:[]),w=S.vertical,E=S.horizontal;w.posInfos.filter((function(t){var e=t.pos;return m?e>=l:e<=l})),E.posInfos.filter((function(t){var e=t.pos;return v?e>=c:e<=c})),w.isSnap=w.posInfos.length>0,E.isSnap=E.posInfos.length>0;var C=vr(w),O=C.isSnap,M=C.guideline,D=vr(E),R=D.isSnap,P=D.guideline,z=R?P.pos[1]:0,_=O?M.pos[0]:0;if(0===d)R&&(x.isSnap=!0,x.pos=P.pos[1],x.offset=o-x.pos);else if(0===h)O&&(y.isSnap=!0,y.pos=_,y.offset=r-_);else{var a=h/d,b=n[1]-a*r,B=0,k=0,T=!1;O?(B=a*(k=_)+b,T=!0):R&&(k=((B=z)-b)/a,T=!0),T&&(y.isSnap=!0,y.pos=k,y.offset=r-k,x.isSnap=!0,x.pos=B,x.offset=o-B)}return{vertical:y,horizontal:x}}(t,e,n),d=f.horizontal,h=f.vertical,v=Nr(l,d),m=Nr(c,h),y=Math.abs(v),x=Math.abs(m);return{horizontal:{isBound:l.isBound,isSnap:d.isSnap,offset:v,dist:y},vertical:{isBound:c.isBound,isSnap:h.isSnap,offset:m,dist:x}}}function qr(t,e,n,r){void 0===r&&(r=n);var o=zr(t,r.map((function(t){return t[0]})),r.map((function(t){return t[1]}))),l=o.horizontal,c=o.vertical,f=e?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:gr(t,n.map((function(t){return t[0]})),n.map((function(t){return t[1]}))),d=f.horizontal,h=f.vertical,v=Hr(l,d),m=Hr(c,h),y=Math.abs(v),x=Math.abs(m);return{horizontal:{isBound:l.isBound,isSnap:d.isSnap,offset:v,dist:y},vertical:{isBound:c.isBound,isSnap:h.isSnap,offset:m,dist:x}}}function Fr(t){return t?t/Math.abs(t):0}function Yr(t,e,n,r,o,l){var c=function(t,e){var n=[],r=[-t[0],-t[1]];return t[0]&&t[1]?(n.push([r,[t[0],-t[1]]],[r,[-t[0],t[1]]]),e&&n.push([r,t])):t[0]?e?n.push([r,[r[0],-1]],[r,[r[0],1]],[r,[t[0],-1]],[r,t],[r,[t[0],1]]):n.push([[r[0],-1],[t[0],-1]],[[r[0],0],[t[0],0]],[[r[0],1],[t[0],1]]):t[1]?e?n.push([r,[-1,r[1]]],[r,[1,r[1]]],[r,[-1,t[1]]],[r,[1,t[1]]],[r,t]):n.push([[-1,r[1]],[-1,t[1]]],[[0,r[1]],[0,t[1]]],[[1,r[1]],[1,t[1]]]):n.push([r,[1,0]],[r,[-1,0]],[r,[0,-1]],[r,[0,1]],[[1,0],[1,-1]],[[1,0],[1,1]],[[0,1],[1,1]],[[0,1],[-1,1]],[[-1,0],[-1,-1]],[[-1,0],[-1,1]],[[0,-1],[1,-1]],[[0,-1],[-1,-1]]),n}(n,r),f=Dr(e,n,r),d=function(t,e,n,r,o,l){return n.map((function(n){var c=n[0],f=n[1],d=Ze(e,c),h=Ze(e,f),v=r?Lr(t,d,h,o):qr(t,o,[h]),m=v.horizontal,y=m.dist,x=m.offset,S=m.isBound,w=m.isSnap,E=v.vertical,C=E.dist,O=E.offset,M=E.isBound,D=E.isSnap,R=Ne(f,c);if(!O&&!x)return{isBound:M||S,isSnap:D||w,sign:R,offset:[0,0]};var P=y<C,z=jr(d,h,-(P?O:x),P,l).map((function(t,i){return t*(R[i]?2/R[i]:0)}));return{sign:R,isBound:P?M:S,isSnap:P?D:w,offset:z}}))}(t,e,c,r,o,l).concat(Or(t,f,Ze(e,[0,0]),l)),h=yr(d,0),v=yr(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:v.isBound,offset:v.offset[1]}}}function Wr(t,e,n,r,o,l,c,f){for(var d=Bn(t.state),h=t.props.keepRatio,v=0,m=0,i=0;i<2;++i){var y=Yr(t,e(v,m),o,h,c,f),x=y.width,S=y.height,w=x.isBound,E=S.isBound,C=x.offset,O=S.offset;if(1===i&&(w||(C=0),E||(O=0)),0===i&&c&&!w&&!E)return[0,0];if(h){var M=Math.abs(C)*(n?1/n:1),D=Math.abs(O)*(r?1/r:1);(w&&E?M<D:E||!w&&M<D)?C=n*O/r:O=r*C/n}v+=C,m+=O}if(o[0]&&o[1]){var R=function(t,e,n,r,o){var l=[-n[0],-n[1]],c=t.state,f=c.width,d=c.height,h=t.props.bounds,v=1/0,m=1/0;if(h){var y=[[n[0],-n[1]],[-n[0],n[1]]],x=h.left,S=void 0===x?-1/0:x,w=h.top,E=void 0===w?-1/0:w,C=h.right,O=void 0===C?1/0:C,M=h.bottom,D=void 0===M?1/0:M;y.forEach((function(t){var n=t[0]!==l[0],c=t[1]!==l[1],h=Ze(e,t),y=Fr(t[1]-l[1]),x=Fr(t[0]-l[0]),w=360*Be(r,h)/Math.PI;if(c){var C=h.slice();(Math.abs(w-360)<2||Math.abs(w-180)<2)&&(C[1]=r[1]);var M=jr(r,C,(r[1]<h[1]?D:E)-h[1],!1,o)[1];isNaN(M)||(m=d+y*M)}if(n){C=h.slice();(Math.abs(w-90)<2||Math.abs(w-270)<2)&&(C[0]=r[0]);var R=jr(r,C,(r[0]<h[0]?O:S)-h[0],!0,o)[0];isNaN(R)||(v=f+x*R)}}))}return{maxWidth:v,maxHeight:m}}(t,d,o,l,f),P=R.maxWidth,z=R.maxHeight,_=function(t,e,n,r,o,l,c,f,d){var h=qr(t,f,[Ze(e,c)]),v=h.horizontal.offset,m=h.vertical.offset;if(m||v){var y=Ue({datas:d,distX:-m,distY:-v}),x=y[0],S=y[1];return[Math.min(o||1/0,n+c[0]*x)-n,Math.min(l||1/0,r+c[1]*S)-r]}return[0,0]}(t,e(v,m),n+v,r+m,P,z,o,c,f);v+=C=_[0],m+=O=_[1]}return[v,m]}function Xr(t,rect,e,n){if(!Ar(t,"rotatable"))return n;var r=rect.pos1,o=rect.pos2,l=rect.pos3,c=rect.pos4,f=n*Math.PI/180,d=[r,o,l,c].map((function(t){return Ne(t,e)})),h=d.map((function(t){return Le(t,f)})),v=kr(t,d,h,e,n).concat(Pr(t,d,h,e,n));return v.sort((function(a,b){return Math.abs(a-n)-Math.abs(b-n)})),v.length?v[0]:n}function $r(t,e,n,r,o,l){if(!Ar(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var c=_n(l.absolutePoses,[e,n]),f=yn(c),d=f.left,h=f.right,v=f.top,m=f.bottom,y=[[d,v],[h,v],[d,m],[h,m]];t.props.snapCenter&&y.push([(d+h)/2,(v+m)/2]);var x=qr(t,o,y,c),S=x.vertical,w=x.horizontal,E=Mr(t,c,l),C=E.vertical,O=E.horizontal,M=S.isSnap,D=w.isSnap,R=S.isBound||C.isBound,P=w.isBound||O.isBound,z=function(t,e,n,r,o){var l=e[0],c=e[1],f=n[0],d=n[1],h=r[0],v=r[1],m=o[0],y=o[1],x=-m,S=-y;if(t&&l&&c){x=0,S=0;var w=[];if(f&&d?w.push([0,y],[m,0]):f?w.push([m,0]):d?w.push([0,y]):h&&v?w.push([0,y],[m,0]):h?w.push([m,0]):v&&w.push([0,y]),w.length){w.sort((function(a,b){return wn(Ne([l,c],a))-wn(Ne([l,c],b))}));var E=w[0];if(E[0]&&Math.abs(l)>1e-7)x=-E[0],S=c*Math.abs(l+x)/Math.abs(l)-c;else if(E[1]&&Math.abs(c)>1e-7){var C=c;S=-E[1],x=l*Math.abs(c+S)/Math.abs(C)-l}if(t&&d&&f)if(Math.abs(x)>1e-7&&Math.abs(x)<Math.abs(m))x*=O=Math.abs(m)/Math.abs(x),S*=O;else if(Math.abs(S)>1e-7&&Math.abs(S)<Math.abs(y)){var O;x*=O=Math.abs(y)/Math.abs(S),S*=O}else x=$n(-m,x),S=$n(-y,S)}}else x=l||f?-m:0,S=c||d?-y:0;return[x,S]}(r,[e,n],[R,P],[M,D],[$n(S.offset,C.offset),$n(w.offset,O.offset)]);return[{isBound:R,isSnap:M,offset:z[0]},{isBound:P,isSnap:D,offset:z[1]}]}function Ur(t){var e=[];return t.forEach((function(t){t.guidelineInfos.forEach((function(t){var n=t.guideline;e.indexOf(n)>-1||e.push(n)}))})),e}function Vr(t,e,n,r){var o=t-n,l=o<0?o+e:r;return{size:(o<0?0:o)-l,pos:l}}function Kr(t,e,n,r){var o=[],l=Wn(t.filter((function(t){var element=t.element,e=t.gap;return element&&!e})),(function(t){var element=t.element,n=t.pos,l=n[r],c=(Math.min(0,l-e)<0?-1:1)+"_"+n[r?0:1],f=function(t,e,n){var r=N(t,e);return r>-1?t[r]:n}(o,(function(t){var e=t[0],n=t[1];return element===e&&l===n}));return f?f[2]:(o.push([element,l,c]),c)}));return l.forEach((function(t){t.sort((function(a,b){return Vr(a.pos[r],a.size,e,n).size-Vr(b.pos[r],a.size,e,n).size||a.pos[r?0:1]-b.pos[r?0:1]}))})),l}function Zr(t,e,n,r,o,l,c,f,d,h,v,m){var y=e[0],x=e[1],S=e[2],w=e[3];return Xn(t.map((function(t,i){var e=!0;return t.map((function(t,E){var C,O=t.pos,M=t.size,D=Vr(O[h],M,r,o),R=D.pos,P=D.size;if(P<c)return null;var z=e;e=!1;var _=f&&z?parseFloat(P.toFixed(d)):0;return m.createElement("div",{className:on("line",y,"guideline","dashed"),"data-size":_>0?v(_):"",key:y+"LinkGuidline"+i+"-"+E,style:(C={},C[x]=n+R+"px",C[S]=-l+O[h?0:1]+"px",C[w]=P+"px",C)})}))})))}function Jr(t,e,n,r,o,l){var c=e[0],f=e[1],d=e[2],h=e[3];return t.map((function(t,i){var e,v=t.type,m=t.pos;return l.createElement("div",{className:on("line",c,"guideline","target","bold",v),key:c+"TargetGuidline"+i,style:(e={},e[f]=n+"px",e[d]=-r+m+"px",e[h]=o+"px",e)})}))}function Qr(t,e,n,r,o,l){var c=e[0],f=e[1],d=e[2],h=e[3];return t.map((function(t,i){var e,v=t.pos,m=t.size,element=t.element;return l.createElement("div",{className:on("line",c,"guideline",element?"bold":""),key:c+"Guidline"+i,style:(e={},e[f]=-n+v[o]+"px",e[d]=-r+v[o?0:1]+"px",e[h]=m+"px",e)})}))}function ti(t,e,n,r){var o=t.filter((function(t){var element=t.element,n=t.gap,r=t.type;return element&&n&&r===e})),l="vertical"===e?[0,1]:[1,0],c=l[0],f=l[1];return Xn(o.map((function(t,i){var e=t.pos,o=t.gap,l=t.gapGuidelines,d=t.sizes,h=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(a,b){return Math.abs(a)-Math.abs(b)})),t[0]}(e[f]+d[f]-n[f],e[f]-n[f]-r[f]),v=Math.min(d[f],r[f]);h>0&&h>v?h=2*(h-v/2):h<0&&h<-v&&(h=2*(h+v/2));var m=(h>0?0:r[f])+h/2;return function(t,e,n,r,o,l,c){var f=Math.abs(l),d=o[e]+(l>0?r[0]:0);return t.filter((function(t){return t.pos[e]<=n[e]})).sort((function(t,n){var r=t.pos;return n.pos[e]-r[e]})).filter((function(t){var n=t.pos,r=t.sizes,o=n[e];return kn(o+r[e],1e-4)===kn(d-f,1e-4)&&(d=o,!0)})).map((function(t){var r=-n[e]+t.pos[e]+t.sizes[e];return he({},t,{gap:l,renderPos:e?[c,r]:[r,c]})}))}(l,c,n,r,e,o,m).concat(function(t,e,n,r,o,l,c){var f=Math.abs(l),d=o[e]+(l<0?r[e]:0);return t.filter((function(t){return t.pos[e]>n[e]})).sort((function(t,n){var r=t.pos,o=n.pos;return r[e]-o[e]})).filter((function(t){var n=t.pos,r=t.sizes,o=n[e];return kn(o,1e-4)===kn(d+f,1e-4)&&(d=o+r[e],!0)})).map((function(t){var r=-n[e]+t.pos[e]-f;return he({},t,{gap:l,renderPos:e?[c,r]:[r,c]})}))}(l,c,n,r,e,o,m))})))}function ei(t,e,n,r,o,l){var c=r[0],f=r[1],d=r[2],h=r[3],v=t.props,m=v.snapDigit,y=void 0===m?0:m,x=v.isDisplaySnapDigit,S=void 0===x||x,w="vertical"===n?"horizontal":"vertical",E="vertical"===n?[0,1]:[1,0],C=E[0],O=E[1];return e.map((function(t,i){var e,n=t.renderPos,r=t.gap,v=Math.abs(r),m=S?parseFloat(v.toFixed(y)):0;return l.createElement("div",{className:on("line",c,"guideline","gap"),"data-size":m>0?o(m):"",key:w+"GapGuideline"+i,style:(e={},e[f]=n[C]+"px",e[d]=n[O]+"px",e[h]=v+"px",e)})}))}function ni(t,e,n,r,o){var l=zr(t,e,n),c=l.vertical,f=c.isBound,d=c.pos,h=l.horizontal,v=h.isBound,m=h.pos;f&&r.push({type:"bounds",pos:d}),v&&o.push({type:"bounds",pos:m});var y=function(t){var e=t.props.innerBounds;if(!e)return{vertical:[],horizontal:[]};var n=t.getRect(),r=n.pos1,o=n.pos2,l=n.pos3,c=n.pos4,f=Ze([r,o,l,c],[0,0]),d=e.left,h=e.top,v=e.width,m=e.height,y=[[d,h],[d,h+m]],x=[[d,h],[d+v,h]],S=[[d+v,h],[d+v,h+m]],w=[[d,h+m],[d+v,h+m]],E=[],C=[],O={top:!1,bottom:!1,left:!1,right:!1};return[[r,o],[o,c],[c,l],[l,r]].forEach((function(line){var t=xr(f,line),e=t.horizontal,n=t.vertical,r=Cr(line,x,n,1,!0),o=Cr(line,w,n,1,!0),l=Cr(line,y,e,1,!0),c=Cr(line,S,e,1,!0);r.isBound&&!O.top&&(E.push(h),O.top=!0),o.isBound&&!O.bottom&&(E.push(h+m),O.bottom=!0),l.isBound&&!O.left&&(C.push(d),O.left=!0),c.isBound&&!O.right&&(C.push(d+v),O.right=!0)})),{horizontal:E,vertical:C}}(t),x=y.vertical,S=y.horizontal;x.forEach((function(t){N(r,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||r.push({type:"bounds",pos:t})})),S.forEach((function(t){N(o,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||o.push({type:"bounds",pos:t})}))}var ri={name:"snappable",props:{snappable:[Boolean,Array],snapCenter:Boolean,snapHorizontal:Boolean,snapVertical:Boolean,snapElement:Boolean,snapGap:Boolean,isDisplaySnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function},events:{onSnap:"snap"},css:[":host {\n    --bounds-color: #d66;\n}",".guideline {\n    pointer-events: none;\n    z-index: 1;\n}",".line.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}"],render:function(t,e){var n=t.state,r=n.top,o=n.left,l=n.pos1,c=n.pos2,f=n.pos3,d=n.pos4,h=n.snapRenderInfo,v=n.targetClientRect,m=n.containerClientRect,y=n.is3d,x=n.rootMatrix;if(!h||!Ar(t,""))return[];var S=y?4:3,w=Math.min(l[0],c[0],f[0],d[0]),E=Math.min(l[1],c[1],f[1],d[1]),C=Tr(x,m,S),O=Un(x,[v.left-C[0],v.top-C[1]],S),M=O[0],D=O[1],R=t.props,P=R.snapThreshold,z=void 0===P?5:P,_=R.snapDigit,B=void 0===_?0:_,k=R.isDisplaySnapDigit,T=void 0===k||k,G=R.snapDistFormat,A=void 0===G?function(t){return t}:G,j=Bn(t.state),I=yn(j),N=I.width,H=I.height,L=I.top,F=I.left,Y=I.bottom,W=I.right,X=[],$=[],U=[],V=[],K=[];if(!h.request){if(h.direction&&K.push(function(t,e,n){var r=[];if(n[0]&&n[1])r=[n,[-n[0],n[1]],[n[0],-n[1]]].map((function(t){return Ze(e,t)}));else if(n[0]||n[1])t.props.keepRatio?r=[[-1,-1],[-1,1],[1,-1],[1,1],n].map((function(t){return Ze(e,t)})):(r=Ke(e,n)).length>1&&r.push([(r[0][0]+r[1][0])/2,(r[0][1]+r[1][1])/2]);else for(var o=[e[0],e[1],e[3],e[2],e[0]],i=0;i<4;++i)r.push(o[i]),r.push([(o[i][0]+o[i+1][0])/2,(o[i][1]+o[i+1][1])/2]);return gr(t,r.map((function(t){return t[0]})),r.map((function(t){return t[1]})),!0,1)}(t,j,h.direction)),h.snap){var rect=yn(j);h.center&&(rect.middle=(rect.top+rect.bottom)/2,rect.center=(rect.left+rect.right)/2),K.push(function(t,rect,e,n){var r=t.props.snapCenter&&e,o=["left","right"],l=["top","bottom"];return r&&(o.push("center"),l.push("middle")),o=o.filter((function(t){return t in rect})),l=l.filter((function(t){return t in rect})),gr(t,o.map((function(t){return rect[t]})),l.map((function(t){return rect[t]})),r,n)}(t,rect,!0,1))}K.forEach((function(t){var e=t.vertical.posInfos,n=t.horizontal.posInfos;X.push.apply(X,e.map((function(t){return{type:"snap",pos:t.pos}}))),$.push.apply($,n.map((function(t){return{type:"snap",pos:t.pos}}))),U.push.apply(U,Ur(e)),V.push.apply(V,Ur(n))}))}ni(t,[F,W],[L,Y],X,$);var Z=Kr(V,M,N,0),J=Kr(U,D,H,1),Q=["horizontal","left","top","width"],tt=["vertical","top","left","height"],et=ti(U,"vertical",[o,r],[N,H]),nt=ti(V,"horizontal",[o,r],[N,H]),it=U.concat(V);return Nn(t,"onSnap",{guidelines:it.filter((function(t){return!t.element})),elements:Wn(it.filter((function(t){return t.element})),(function(t){return t.element})),gaps:et.concat(nt)},!0),ei(t,et,"vertical",Q,A,e).concat(ei(t,nt,"horizontal",tt,A,e),Zr(Z,Q,w,M,N,r,z,T,B,0,A,e),Zr(J,tt,E,D,H,o,z,T,B,1,A,e),Jr($,Q,w,r,N,e),Jr(X,tt,E,o,H,e),Qr(V,Q,o,r,0,e),Qr(U,tt,r,o,1,e))},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Gr(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t){return pr(t)||ci(t)},dragControlStart:function(t,e){t.state.snapRenderInfo=null,Gr(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t,e){t.state.snapRenderInfo=null,Gr(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null}},ii={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},render:function(t,e){var n=t.props.throttleDragRotate,r=t.state,o=r.dragInfo,l=r.beforeOrigin;if(!n||!o)return[];var c=o.dist;if(!c[0]&&!c[1])return[];var f=wn(c),d=Be(c,[0,0]);return[e.createElement("div",{className:on("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:f+"px",transform:"translate("+l[0]+"px, "+l[1]+"px) rotate("+d+"rad)"}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,o=e.parentDragger,l=t.state,c=l.targetTransform,f=l.target;if(l.dragger)return!1;l.dragger=o||t.targetDragger;var style=window.getComputedStyle(f);n.datas={},n.left=parseFloat(style.left||"")||0,n.top=parseFloat(style.top||"")||0,n.bottom=parseFloat(style.bottom||"")||0,n.right=parseFloat(style.right||"")||0,n.transform=c,n.startTranslate=[0,0],$e(t,{datas:n}),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,function(t,e){e.absolutePoses=Bn(t.state)}(t,n);var d=jn(t,e,{set:function(t){n.startTranslate=t}});return!1!==(r||Nn(t,"onDragStart",d))?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(l.dragger=null,n.isPinch=!1),!!n.isDrag&&d},drag:function(t,e){var n=e.datas,r=e.parentEvent,o=e.parentFlag,l=e.isPinch,c=e.isRequest,f=e.distX,d=e.distY,h=n.isDrag,v=n.prevDist,m=n.prevBeforeDist,y=n.transform,x=n.startTranslate;if(h){var S=t.props,w=S.parentMoveable,E=r?0:S.throttleDrag||0,C=r?0:S.throttleDragRotate||0,O=!1,M=0;if(!r&&C>0&&(f||d)){var D=S.startDragRotate||0,R=kn(D+180*Be([0,0],[f,d])/Math.PI,C)-D,P=d*Math.abs(Math.cos((R-90)/180*Math.PI)),z=wn([f*Math.abs(Math.cos(R/180*Math.PI)),P]);M=R*Math.PI/180,f=z*Math.cos(M),d=z*Math.sin(M)}if(!l&&!r&&!o&&(!C||f||d)){var _=$r(t,f,d,C,c,n),B=_[0],k=_[1],T=B.isSnap,G=B.isBound,A=B.offset,j=k.isSnap,I=k.isBound;O=T||j||G||I,f+=A,d+=k.offset}n.passDeltaX=f-(n.passDistX||0),n.passDeltaY=d-(n.passDistY||0),n.passDistX=f,n.passDistY=d;var N=Ie(Ue({datas:n,distX:f,distY:d},!0),x),H=Ie(Ue({datas:n,distX:f,distY:d},!1),x);C||O||(Tn(H,E),Tn(N,E));var L=Ne(N,x),F=Ne(H,x),Y=Ne(F,v),W=Ne(L,m);n.prevDist=F,n.prevBeforeDist=L;var X=n.left+L[0],$=n.top+L[1],U=n.right-L[0],V=n.bottom-L[1],K=y+" translate("+F[0]+"px, "+F[1]+"px)";if(t.state.dragInfo.dist=r?[0,0]:F,r||w||!Y.every((function(t){return!t}))||!W.some((function(t){return!t}))){var Z=jn(t,e,{transform:K,dist:F,delta:Y,translate:H,beforeDist:L,beforeDelta:W,beforeTranslate:N,left:X,top:$,right:U,bottom:V,isPinch:l});return!r&&Nn(t,"onDrag",Z),Z}}},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas,o=e.isDrag;if(t.state.dragger=null,t.state.dragInfo=null,r.isDrag)return r.isDrag=!1,!n&&Nn(t,"onDragEnd",In(t,e,{})),o},dragGroupStart:function(t,e){var n=e.datas,r=e.clientX,o=e.clientY,l=this.dragStart(t,e);if(!l)return!1;var c=cr(t,this,"dragStart",[r||0,o||0],e,!1),f=Nn(t,"onDragGroupStart",he({},l,{targets:t.props.targets,events:c}));return n.isDrag=!1!==f,!!n.isDrag&&l},dragGroup:function(t,e){if(e.datas.isDrag){var n=this.drag(t,e),r=e.datas,o=cr(t,this,"drag",[r.passDeltaX,r.passDeltaY],e,!1);if(n){var l=he({targets:t.props.targets,events:o},n);return Nn(t,"onDragGroup",l),l}}},dragGroupEnd:function(t,e){var n=e.isDrag;if(e.datas.isDrag)return this.dragEnd(t,e),cr(t,this,"dragEnd",[0,0],e,!1),Nn(t,"onDragGroupEnd",In(t,e,{targets:t.props.targets})),n},request:function(t){var e={},rect=t.getRect(),n=0,r=0;return{isControl:!1,requestStart:function(){return{datas:e}},request:function(t){return"x"in t?n=t.x-rect.left:"deltaX"in t&&(n+=t.deltaX),"y"in t?r=t.y-rect.top:"deltaY"in t&&(r+=t.deltaY),{datas:e,distX:n,distY:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.dragInfo=null}};function oi(t,e,n,r,o,rect){var l=t.state.is3d?4:3,c=mn(t.state.rootMatrix,o,l),f=Ie([rect.left,rect.top],c);e.startAbsoluteOrigin=f,e.prevDeg=Be(f,[n,r])/Math.PI*180,e.prevSnapDeg=e.prevDeg,e.startDeg=e.prevDeg,e.loop=0}function ai(t,e,n,r,o,l){var c=n.prevDeg,f=Xr(t,e,n.origin,r);return n.prevDeg=f,[f-c,f,l+f]}function si(t,e,n,r,o,l,c,f){var d=n.prevDeg,h=n.prevSnapDeg,v=n.startDeg,m=n.loop;d>r&&d>270&&r<90?++n.loop:d<r&&d<90&&r>270&&--n.loop;var y=n.loop,x=360*m+h-v+l,S=360*y+r-v+l;n.prevDeg=S-360*y+v-l;var w=o*((S=kn(S,c))-l);return f&&(S=(w=Xr(t,e,n.origin,w))/o+l),n.prevSnapDeg=S-360*y+v-l,[o*(S-x),w,l+w]}function ui(t,e,n,r,o,l,c,f){return si(t,e,n,Be(n.startAbsoluteOrigin,[o,l])/Math.PI*180,r,c,f,!0)}function ci(t){return t.isRequest?"rotatable"===t.requestAble:H(t.inputEvent.target,on("rotation"))}var fi={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number},events:{onRotateStart:"rotateStart",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},render:function(t,e){var n=t.props,r=n.rotatable,o=n.rotationPosition;if(!r)return null;var l=t.state,c=function(t,e,n){var r=e[0],o=e[1],l=e[2],c=e[3],f=(t||"top").split("-"),d=f[0],h=f[1],v=[r,o];"left"===d?v=[l,r]:"right"===d?v=[o,c]:"bottom"===d&&(v=[c,l]);var m=[(v[0][0]+v[1][0])/2,(v[0][1]+v[1][1])/2],y=Dn(v,n);if(h){var x="top"===h||"left"===h,S="bottom"===d||"left"===d;m=v[x&&!S||!x&&S?0:1]}return[m,y]}(o,l.renderPoses,l.direction),f=c[0],d=c[1];return e.createElement("div",{key:"rotation",className:on("line rotation-line"),style:{transform:"translate(-50%) translate("+f[0]+"px, "+f[1]+"px) rotate("+d+"rad)"}},e.createElement("div",{className:on("control","rotation")}))},dragControlCondition:ci,dragControlStart:function(t,e){var n=e.datas,r=e.clientX,o=e.clientY,l=e.parentRotate,c=e.parentFlag,f=e.isPinch,d=e.isRequest,h=t.state,v=h.target,m=h.left,y=h.top,x=h.origin,S=h.beforeOrigin,w=h.direction,E=h.beforeDirection,C=h.targetTransform;if(!d&&!v)return!1;var rect=t.getRect();if(n.rect=rect,n.transform=C,n.left=m,n.top=y,d||f||c){var O=l||0;n.beforeInfo={origin:rect.beforeOrigin,prevDeg:O,startDeg:O,prevSnapDeg:O,loop:0},n.afterInfo={origin:rect.origin,prevDeg:O,startDeg:O,prevSnapDeg:O,loop:0}}else{n.beforeInfo={origin:rect.beforeOrigin},n.afterInfo={origin:rect.origin};var M=Pn(t.controlBox.getElement());oi(t,n.beforeInfo,r,o,S,M),oi(t,n.afterInfo,r,o,x,M)}n.direction=w,n.beforeDirection=E,n.startRotate=0,n.datas={};var D=jn(t,e,{set:function(t){n.startRotate=t}}),R=Nn(t,"onRotateStart",D);return n.isRotate=!1!==R,t.state.snapRenderInfo={request:e.isRequest},!!n.isRotate&&D},dragControl:function(t,e){var n,r,o,l,c,f,d=e.datas,h=e.clientX,v=e.clientY,m=e.parentRotate,y=e.parentFlag,x=e.isPinch,S=d.direction,w=d.beforeDirection,E=d.beforeInfo,C=d.afterInfo,O=d.isRotate,M=d.startRotate,rect=d.rect;if(O){var D,R,P,z,_,B,k=t.props,T=k.throttleRotate,G=void 0===T?0:T,A=k.parentMoveable;if(!y&&"parentDist"in e){var j=e.parentDist;D=(n=ai(t,rect,C,j,0,M))[0],R=n[1],P=n[2],z=(r=ai(t,rect,E,j,0,M))[0],_=r[1],B=r[2]}else x||y?(D=(o=si(t,rect,C,m,S,M,G))[0],R=o[1],P=o[2],z=(l=si(t,rect,E,m,S,M,G))[0],_=l[1],B=l[2]):(D=(c=ui(t,rect,C,S,h,v,M,G))[0],R=c[1],P=c[2],z=(f=ui(t,rect,E,w,h,v,M,G))[0],_=f[1],B=f[2]);if(D||z||A){var I=jn(t,e,{delta:D,dist:R,rotate:P,beforeDist:_,beforeDelta:z,beforeRotate:B,transform:d.transform+" rotate("+R+"deg)",isPinch:!!x});return Nn(t,"onRotate",I),I}}},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isRotate&&(n.isRotate=!1,Nn(t,"onRotateEnd",In(t,e,{})),r)},dragGroupControlCondition:ci,dragGroupControlStart:function(t,e){var n=e.datas,r=e.inputEvent,o=t.state,l=o.left,c=o.top,f=o.beforeOrigin,d=this.dragControlStart(t,e);if(!d)return!1;d.set(n.beforeDirection*t.rotation);var h=fr(t,this,"dragControlStart",n,he({},e,{parentRotate:0}),(function(t,e,n){var o=t.state,d=o.left,h=o.top,v=o.beforeOrigin,m=Ie(Ne([d,h],[l,c]),Ne(v,f));e.prevClient=m,n.dragStart=ii.dragStart(t,(new lr).dragStart(m,r))})),v=Nn(t,"onRotateGroupStart",he({},d,{targets:t.props.targets,events:h}));return n.isRotate=!1!==v,!!n.isRotate&&d},dragGroupControl:function(t,e){var n=e.inputEvent,r=e.datas;if(r.isRotate){var o=this.dragControl(t,e);if(o){var l=r.beforeDirection,c=o.beforeDist,f=o.beforeDelta/180*Math.PI,d=fr(t,this,"dragControl",r,he({},e,{parentRotate:c}),(function(t,r,o,i){var c=r.prevClient,d=c[0],h=c[1],v=Le([d,h],f*l),m=v[0],y=v[1],x=[m-d,y-h];r.prevClient=[m,y];var S=ii.drag(t,ur(t.state,x,n,!!e.isPinch,!1));o.drag=S}));t.rotation=l*o.beforeRotate;var h=he({targets:t.props.targets,events:d,set:function(e){t.rotation=e}},o);return Nn(t,"onRotateGroup",h),h}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate)return this.dragControlEnd(t,e),fr(t,this,"dragControlEnd",r,e),Nn(t,"onRotateGroupEnd",In(t,e,{targets:t.props.targets})),n},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(t){return{datas:e}},request:function(t){return"deltaRotate"in t?n+=t.deltaRotate:"rotate"in t&&(n=t.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function pi(t,e,n){var r=t.state,o=r.renderPoses,l=r.rotation,c=t.props.renderDirections,f=void 0===c?e:c,d=t.state.direction,h={};return f.forEach((function(t){h[t]=!0})),f.map((function(t){var e=Ce[t];if(!e||!h[t])return null;var r=kn(l/Math.PI*180,15)+Oe[t];return d<1&&(r=360-r),r%=180,n.createElement("div",{className:on("control","direction",t),"data-rotation":r,"data-direction":t,key:"direction-"+t,style:On.apply(void 0,[l].concat(e.map((function(t){return o[t]}))))})}))}function di(t,e){return pi(t,Ee,e)}function hi(t,e){return pi(t,["nw","ne","sw","se"],e)}var gi={name:"resizable",ableGroup:"size",updateRect:!0,canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean},events:{onResizeStart:"resizeStart",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:function(t,e){var n=t.props,r=n.resizable,o=n.edge;if(r)return o?hi(t,e):di(t,e)},dragControlCondition:pr,dragControlStart:function(t,e){var n,r=e.inputEvent,o=e.isPinch,l=e.parentDirection,c=e.datas,f=e.parentFlag,d=l||(o?[0,0]:zn(r.target)),h=t.state,v=h.target,m=h.width,y=h.height;if(!d||!v)return!1;!o&&$e(t,{datas:c}),c.datas={},c.direction=d,c.startOffsetWidth=m,c.startOffsetHeight=y,c.prevWidth=0,c.prevHeight=0,n=function(t){var style=window.getComputedStyle(t);return[parseFloat(style.width),parseFloat(style.height)]}(v),c.startWidth=n[0],c.startHeight=n[1];var x=[Math.max(0,m-c.startWidth),Math.max(0,y-c.startHeight)];if(c.minSize=x,c.maxSize=[1/0,1/0],!f){var style=window.getComputedStyle(v);c.minSize=Ie([parseFloat(style.minWidth)||0,parseFloat(style.minHeight)||0],x),c.maxSize=Ie([parseFloat(style.maxWidth)||1/0,parseFloat(style.maxHeight)||1/0],x)}var S=t.props.transformOrigin||"% %";c.transformOrigin=S&&z(S)?S.split(" "):S,c.startDirection=function(t,e){if(!e[0]&&!e[1])return[0,0];var n=[-1,-1];return[e[0]?e[0]:-1*n[0],e[1]?e[1]:-1*n[1]]}(0,d),c.fixedPosition=rn(t,c.startDirection),c.fixedOriginalPosition=rn(t,d);var w=jn(t,e,{direction:d,set:function(t){var e=t[0],n=t[1];c.startWidth=e,c.startHeight=n},setMin:function(t){c.minSize=t},setMax:function(t){c.maxSize=t},setOrigin:function(t){c.transformOrigin=t},dragStart:ii.dragStart(t,(new lr).dragStart([0,0],r))});return!1!==Nn(t,"onResizeStart",w)&&(c.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:d}),!!c.isResize&&w},dragControl:function(t,e){var n,r=e.datas,o=e.distX,l=e.distY,c=e.parentFlag,f=e.isPinch,d=e.parentDistance,h=e.parentScale,v=e.inputEvent,m=e.parentKeepRatio,y=e.dragClient,x=e.parentDist,S=e.isRequest,w=r.direction,E=r.isResize,C=r.transformOrigin;if(E){var O=r.startWidth,M=r.startHeight,D=r.startOffsetWidth,R=r.startOffsetHeight,P=r.prevWidth,z=r.prevHeight,_=r.minSize,B=r.maxSize,k=t.props,T=k.throttleResize,G=void 0===T?0:T,A=k.parentMoveable,j=w;w[0]||w[1]||(j=[1,1]);var I=t.props.keepRatio||m,N=j[0]||!j[1],H=N?R/D:D/R,L=I||c?w:r.startDirection,F=y,Y=0,W=0;if(y||(F=!c&&f?rn(t,[0,0]):I?r.fixedOriginalPosition:r.fixedPosition),x)Y=x[0],W=x[1];else if(h)Y=(h[0]-1)*D,W=(h[1]-1)*R;else if(f)d&&(Y=d,W=d*R/D);else{var X=Ue({datas:r,distX:o,distY:l});if(Y=j[0]*X[0],W=j[1]*X[1],I&&D&&R){var $=Be([0,0],X),U=Be([0,0],j),V=Be([0,0],[D,R]),K=wn([Y,W]),Z=Math.cos($-U)*K;j[0]?j[1]?(Y=Math.cos(V)*Z,W=Math.sin(V)*Z):W=qn(Y=Z,N,H):Y=Fn(W=Z,N,H)}}var J=j[0]||I?Math.max(D+Y,1e-7):D,Q=j[1]||I?Math.max(R+W,1e-7):R;I&&D&&R&&(Q=J*R/D);var tt=[0,0];if(f||(tt=function(t,e,n,r,o,l,c){if(!Ar(t,"resizable"))return[0,0];var f=t.state,d=f.matrix,h=f.is3d;return Wr(t,(function(t,l){return Ir(d,e+t,n+l,o,r,h)}),e,n,r,o,l,c)}(t,J,Q,w,r.fixedOriginalPosition,S,r)),x&&(!x[0]&&(tt[0]=0),!x[1]&&(tt[1]=0)),I){j[0]&&j[1]&&tt[0]&&tt[1]&&(Math.abs(tt[0])>Math.abs(tt[1])?tt[1]=0:tt[0]=0);var et=!tt[0]&&!tt[1];et&&(N?J=kn(J,G):Q=kn(Q,G)),j[0]&&!j[1]||tt[0]&&!tt[1]||et&&N?Q=qn(J+=tt[0],N,H):(!j[0]&&j[1]||!tt[0]&&tt[1]||et&&!N)&&(J=Fn(Q+=tt[1],N,H))}else J+=tt[0],Q+=tt[1],tt[0]||(J=kn(J,G)),tt[1]||(Q=kn(Q,G));J=(n=function(t,e,n,r){if(!r)return t.map((function(t,i){return Math.min(n[i],Math.max(t,e[i]))}));var o=t[0],l=t[1],c=Zn(t,e,!1),f=c[0],d=c[1],h=Zn(t,n,!0),v=h[0],m=h[1];return o<f||l<d?(o=f,l=d):(o>v||l>m)&&(o=v,l=m),[o,l]}([J,Q],_,B,I))[0],Q=n[1];var nt=[(Y=(J=Math.round(J))-D)-P,(W=(Q=Math.round(Q))-R)-z];r.prevWidth=Y,r.prevHeight=W;var it=nn(t,J,Q,L,F,C);if(A||!nt.every((function(t){return!t}))||!it.every((function(t){return!t}))){var ot=jn(t,e,{width:O+Y,height:M+W,offsetWidth:J,offsetHeight:Q,direction:w,dist:[Y,W],delta:nt,isPinch:!!f,drag:ii.drag(t,ur(t.state,it,v,!!f,!1))});return Nn(t,"onResize",ot),ot}}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,o=n.startOffsetWidth,l=n.startOffsetHeight,c=n.prevWidth,f=n.prevHeight;if(r){var d=t.state,h=d.width-(o+c),v=d.height-(l+f),m=Math.abs(h)>3,y=Math.abs(v)>3;return m&&(n.startWidth+=h,n.startOffsetWidth+=h,n.prevWidth+=h),y&&(n.startHeight+=v,n.startOffsetHeight+=v,n.prevHeight+=v),m||y?(this.dragControl(t,e),!0):void 0}},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isResize&&(n.isResize=!1,Nn(t,"onResizeEnd",In(t,e,{})),r)},dragGroupControlCondition:pr,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var o=r.direction,l=n.fixedOriginalPosition,c=fr(t,this,"dragControlStart",n,(function(n,r){var c=rn(n,o),f=He(qe(-t.rotation/180*Math.PI,3),[c[0]-l[0],c[1]-l[1],1],3),d=f[0],h=f[1];return r.originalX=d,r.originalY=h,e})),f=he({},r,{targets:t.props.targets,events:c}),d=Nn(t,"onResizeGroupStart",f);return n.isResize=!1!==d,!!n.isResize&&r},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=this.dragControl(t,e);if(r){var o=r.offsetWidth,l=r.offsetHeight,c=r.dist,f=t.props.keepRatio,d=[o/(o-c[0]),l/(l-c[1])],h=n.fixedOriginalPosition,v=fr(t,this,"dragControl",n,(function(n,r){var o=He(qe(t.rotation/180*Math.PI,3),[r.originalX*d[0],r.originalY*d[1],1],3),l=o[0],c=o[1];return he({},e,{parentDist:null,parentScale:d,dragClient:Ie(h,[l,c]),parentKeepRatio:f})})),m=he({targets:t.props.targets,events:v},r);return Nn(t,"onResizeGroup",m),m}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize)return this.dragControlEnd(t,e),fr(t,this,"dragControlEnd",r,e),Nn(t,"onResizeGroupEnd",In(t,e,{targets:t.props.targets})),n},request:function(t){var e={},n=0,r=0,rect=t.getRect();return{isControl:!0,requestStart:function(t){return{datas:e,parentDirection:t.direction||[1,1]}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-rect.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-rect.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[n,r]}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},vi={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean},events:{onScaleStart:"scaleStart",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:function(t,e){var n=t.props,r=n.resizable,o=n.scalable,l=n.edge;if(!r&&o)return l?hi(t,e):di(t,e)},dragControlCondition:pr,dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,o=e.inputEvent,l=e.parentDirection||(r?[0,0]:zn(o.target)),c=t.state,f=c.width,d=c.height,h=c.targetTransform,v=c.target;if(!l||!v)return!1;r||$e(t,{datas:n}),n.datas={},n.transform=h,n.prevDist=[1,1],n.direction=l,n.width=f,n.height=d,n.startScale=[1,1],n.fixedDirection=l.map((function(t){return-t})),n.fixedPosition=rn(t,l);var m=jn(t,e,{direction:l,set:function(t){n.startScale=t},dragStart:ii.dragStart(t,(new lr).dragStart([0,0],o))});return!1!==Nn(t,"onScaleStart",m)&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:l}),!!n.isScale&&m},dragControl:function(t,e){var n=e.datas,r=e.distX,o=e.distY,l=e.parentScale,c=e.parentDistance,f=e.parentKeepRatio,d=e.parentFlag,h=e.isPinch,v=e.inputEvent,m=e.dragClient,y=e.parentDist,x=e.isRequest,S=n.prevDist,w=n.direction,E=n.width,C=n.height,O=n.transform,M=n.isScale,D=n.startScale;if(!M)return!1;var R=t.props,z=R.throttleScale,_=R.parentMoveable,B=w;w[0]||w[1]||(B=[1,1]);var k=t.props.keepRatio||f,T=t.state,G=B[0]||!B[1],A=E*D[0],j=C*D[1],I=G?j/A:A/j,N=1,H=1,L=m;if(m||(L=!d&&h?rn(t,[0,0]):n.fixedPosition),y)N=(E+y[0])/E,H=(C+y[1])/C;else if(l)N=l[0],H=l[1];else if(h)c&&(N=(E+c)/E,H=(C+c*C/E)/C);else{var F=Ue({datas:n,distX:r,distY:o}),Y=B[0]*F[0],W=B[1]*F[1];if(k&&E&&C){var X=Be([0,0],F),$=Be([0,0],B),U=Be([0,0],[A,j]),V=wn([Y,W]),K=Math.cos(X-$)*V;B[0]?B[1]?(Y=Math.cos(U)*K,W=Math.sin(U)*K):W=qn(Y=K,G,I):Y=Fn(W=K,G,I)}N=(E+Y)/E,H=(C+W)/C}N=B[0]||k?N*D[0]:D[0],H=B[1]||k?H*D[1]:D[1],0===N&&(N=1e-9*(S[0]>0?1:-1)),0===H&&(H=1e-9*(S[1]>0?1:-1));var Z=[N/D[0],H/D[1]],J=[N,H];if(!h&&t.props.groupable){var Q=(T.snapRenderInfo||{}).direction;P(Q)&&(Q[0]||Q[1])&&(T.snapRenderInfo={direction:w,request:e.isRequest})}var tt=[0,0];if(h||(tt=function(t,e,n,r,o,l){var c=l.width,f=l.height;if(!Ar(t,"scalable"))return[0,0];var d=l.is3d,h=Wr(t,(function(t,o){return Ir(en(l,Ie(e,[t/c,o/f])),c,f,r,n,d)}),c,f,n,r,o,l);return[h[0]/c,h[1]/f]}(t,Z,w,n.fixedPosition,x,n)),k){B[0]&&B[1]&&tt[0]&&tt[1]&&(Math.abs(tt[0])>Math.abs(tt[1])?tt[1]=0:tt[0]=0);var et=!tt[0]&&!tt[1];if(et&&(G?Z[0]=kn(Z[0]*D[0],z)/D[0]:Z[1]=kn(Z[1]*D[1],z)/D[1]),B[0]&&!B[1]||tt[0]&&!tt[1]||et&&G){Z[0]+=tt[0];var nt=qn(E*Z[0]*D[0],G,I);Z[1]=nt/C/D[1]}else if(!B[0]&&B[1]||!tt[0]&&tt[1]||et&&!G){Z[1]+=tt[1];var it=Fn(C*Z[1]*D[1],G,I);Z[0]=it/E/D[0]}}else Z[0]+=tt[0],Z[1]+=tt[1],tt[0]||(Z[0]=kn(Z[0]*D[0],z)/D[0]),tt[1]||(Z[1]=kn(Z[1]*D[1],z)/D[1]);0===Z[0]&&(Z[0]=1e-9*(S[0]>0?1:-1)),0===Z[1]&&(Z[1]=1e-9*(S[1]>0?1:-1));var ot,at,st=[Z[0]/S[0],Z[1]/S[1]];at=D,J=[(ot=Z)[0]*at[0],ot[1]*at[1]],n.prevDist=Z;var ut=function(t,e,n,r){var o=t.state,l=o.is3d,c=o.left,f=o.top,d=o.width,h=o.height,v=l?4:3,m=t.props.groupable,y=m?c:0,x=m?f:0;return Ne(Qe(r,en(t.state,e),d,h,v,n),[y,x])}(t,st,w,L);if(N===S[0]&&H===S[1]&&ut.every((function(t){return!t}))&&!_)return!1;var lt=jn(t,e,{offsetWidth:E,offsetHeight:C,scale:J,direction:w,dist:Z,delta:st,transform:O+" scale("+N+", "+H+")",isPinch:!!h,drag:ii.drag(t,ur(t.state,ut,v,h,!1))});return Nn(t,"onScale",lt),lt},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isScale&&(n.isScale=!1,Nn(t,"onScaleEnd",In(t,e,{})),r)},dragGroupControlCondition:pr,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var o=r.direction,l=n.fixedPosition;n.moveableScale=t.scale;var c=fr(t,this,"dragControlStart",n,(function(n,r){var c=rn(n,o),f=He(qe(-t.rotation/180*Math.PI,3),[c[0]-l[0],c[1]-l[1],1],3),d=f[0],h=f[1];return r.originalX=d,r.originalY=h,e})),f=he({},r,{targets:t.props.targets,events:c}),d=Nn(t,"onScaleGroupStart",f);return n.isScale=!1!==d,!!n.isScale&&f},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){var r=this.dragControl(t,e);if(r){var o=n.moveableScale;t.scale=[r.scale[0]*o[0],r.scale[1]*o[1]];var l=t.props.keepRatio,c=r.dist,f=r.scale,d=n.fixedPosition,h=fr(t,this,"dragControl",n,(function(n,r){var o=He(qe(t.rotation/180*Math.PI,3),[r.originalX*c[0],r.originalY*c[1],1],3),h=o[0],v=o[1];return he({},e,{parentDist:null,parentScale:f,parentKeepRatio:l,dragClient:Ie(d,[h,v])})})),v=he({targets:t.props.targets,events:h},r);return Nn(t,"onScaleGroup",v),v}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale)return this.dragControlEnd(t,e),fr(t,this,"dragControlEnd",r,e),Nn(t,"onScaleGroupEnd",In(t,e,{targets:t.props.targets})),n},request:function(){var t={},e=0,n=0;return{isControl:!0,requestStart:function(e){return{datas:t,parentDirection:e.direction||[1,1]}},request:function(r){return e+=r.deltaWidth,n+=r.deltaHeight,{datas:t,parentDist:[e,n]}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function mi(t,e){return t.map((function(t,i){return n=t,r=e[i],(n*(l=2)+r*(o=1))/(o+l);var n,r,o,l}))}function bi(t,e,n){var r=Be(t,e),o=Be(t,n)-r;return o>=0?o:o+2*Math.PI}var yi={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},render:function(t,e){var n=t.props,r=n.resizable,o=n.scalable,l=n.warpable;if(r||o||!l)return[];var c=t.state,f=c.pos1,d=c.pos2,h=c.pos3,v=c.pos4,m=mi(f,d),y=mi(d,f),x=mi(f,h),S=mi(h,f),w=mi(h,v),E=mi(v,h),C=mi(d,v),O=mi(v,d);return[e.createElement("div",{className:on("line"),key:"middeLine1",style:Cn(m,w)}),e.createElement("div",{className:on("line"),key:"middeLine2",style:Cn(y,E)}),e.createElement("div",{className:on("line"),key:"middeLine3",style:Cn(x,C)}),e.createElement("div",{className:on("line"),key:"middeLine4",style:Cn(S,O)})].concat(di(t,e))},dragControlCondition:function(t){return!t.isRequest&&H(t.inputEvent.target,on("direction"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,o=t.props.target,l=zn(r.target);if(!l||!o)return!1;var c=t.state,f=c.transformOrigin,d=c.is3d,h=c.targetTransform,v=c.targetMatrix,m=c.width,y=c.height,x=c.left,S=c.top;return n.datas={},n.targetTransform=h,n.warpTargetMatrix=d?v:Te(v,3,4),n.targetInverseMatrix=ze(_e(n.warpTargetMatrix,4),3,4),n.direction=l,n.left=x,n.top=S,$e(t,{datas:n}),n.poses=[[0,0],[m,0],[0,y],[m,y]].map((function(p){return Ne(p,f)})),n.nextPoses=n.poses.map((function(t){var e=t[0],r=t[1];return He(n.warpTargetMatrix,[e,r,0,1],4)})),n.startMatrix=Fe(4),n.prevMatrix=Fe(4),n.absolutePoses=Bn(c),n.posIndexes=Ve(l),c.snapRenderInfo={request:e.isRequest,direction:l},!1!==Nn(t,"onWarpStart",jn(t,e,{set:function(t){n.startMatrix=t}}))&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,o=e.distX,l=e.distY,c=n.targetInverseMatrix,f=n.prevMatrix,d=n.isWarp,h=n.startMatrix,v=n.poses,m=n.posIndexes,y=n.absolutePoses;if(!d)return!1;if(Ar(t,"warpable")){var x=m.map((function(t){return y[t]}));x.length>1&&x.push([(x[0][0]+x[1][0])/2,(x[0][1]+x[1][1])/2]);var S=qr(t,r,x.map((function(t){return[t[0]+o,t[1]+l]}))),w=S.horizontal,E=S.vertical;l-=w.offset,o-=E.offset}var C=Ue({datas:n,distX:o,distY:l},!0),O=n.nextPoses.slice();if(m.forEach((function(t){O[t]=Ie(O[t],C)})),!xe.every((function(t){return e=t.map((function(i){return v[i]})),n=t.map((function(i){return O[i]})),r=bi(e[0],e[1],e[2]),o=bi(n[0],n[1],n[2]),l=Math.PI,!(r>=l&&o<=l||r<=l&&o>=l);var e,n,r,o,l})))return!1;var M=Xe(v[0],v[2],v[1],v[3],O[0],O[2],O[1],O[3]);if(!M.length)return!1;var D=Ae(c,M,4),R=n.targetTransform+" "+hn(D,!0),P=Ae(_e(f,4),D,4);return n.prevMatrix=D,Nn(t,"onWarp",jn(t,e,{delta:P,matrix:Ae(h,D,4),multiply:Ae,dist:D,transform:R})),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isWarp&&(n.isWarp=!1,Nn(t,"onWarpEnd",In(t,e,{})),r)}},xi=on("area"),Si=on("area-pieces"),wi=on("area-piece"),Ei=on("avoid");function Ci(t){var e=t.areaElement,n=t.state,r=n.width,o=n.height;!function(element,t){if(element.classList)element.classList.remove(t);else{var e=new RegExp("(\\s|^)"+t+"(\\s|$)");element.className=element.className.replace(e," ")}}(e,Ei),e.style.cssText+="left: 0px; top: 0px; width: "+r+"px; height: "+o+"px"}function Oi(t){return t.createElement("div",{key:"area_pieces",className:Si},t.createElement("div",{className:wi}),t.createElement("div",{className:wi}),t.createElement("div",{className:wi}),t.createElement("div",{className:wi}))}var Mi={name:"dragArea",props:{dragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(t,e){var n=t.props,r=n.target,o=n.dragArea,l=n.groupable,c=t.state,f=c.width,d=c.height,v=c.renderPoses;if(l)return[e.createElement("div",{key:"area",ref:h(t,"areaElement"),className:xi}),Oi(e)];if(!r||!o)return[];var m=Xe([0,0],[f,0],[0,d],[f,d],v[0],v[1],v[2],v[3]),y=m.length?hn(m,!0):"none";return[e.createElement("div",{key:"area",ref:h(t,"areaElement"),className:xi,style:{top:"0px",left:"0px",width:f+"px",height:d+"px",transformOrigin:"0 0",transform:y}}),Oi(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,o=e.clientY,l=e.inputEvent;if(!l)return!1;n.isDragArea=!1,n.inputTarget=l.target;var element,c,f=t.areaElement,d=t.state,h=d.moveableClientRect,v=d.renderPoses,m=d.rootMatrix,y=d.is3d,x=h.left,S=h.top,w=yn(v),E=w.left,C=w.top,O=w.width,M=w.height,D=Un(m,[r-x,o-S],y?4:3),R=D[0],P=D[1],z=[{left:E,top:C,width:O,height:(P-=C)-10},{left:E,top:C,width:(R-=E)-10,height:M},{left:E,top:C+P+10,width:O,height:M-P-10},{left:E+R+10,top:C,width:O-R-10,height:M}],_=[].slice.call(f.nextElementSibling.children);return z.forEach((function(rect,i){_[i].style.cssText="left: "+rect.left+"px;top: "+rect.top+"px; width: "+rect.width+"px; height: "+rect.height+"px;"})),c=Ei,(element=f).classList?element.classList.add(c):element.className+=" "+c,!0},drag:function(t,e){var n=e.datas;if(!e.inputEvent)return!1;n.isDragArea||(n.isDragArea=!0,Ci(t))},dragEnd:function(t,e){if(!e.inputEvent)return!1;var n=e.inputEvent,r=e.datas.isDragArea;r||Ci(t);var o=t.state.target,l=n.target;if(!r&&!t.isMoveableElement(l)){var c=o.contains(l);Nn(t,"onClick",jn(t,e,{isDouble:e.isDouble,inputTarget:l,isTarget:o===l,containsTarget:c}))}},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.isDragArea,o=e.datas;if(!n)return!1;r||Ci(t);var l=o.inputTarget,c=n.target;if(!r&&!t.isMoveableElement(c)&&l!==c){var f=t.props.targets,d=f.indexOf(c),h=d>-1,v=!1;-1===d&&(v=(d=N(f,(function(t){return t.contains(c)})))>-1),Nn(t,"onClickGroup",jn(t,e,{isDouble:e.isDouble,targets:f,inputTarget:c,targetIndex:d,isTarget:h,containsTarget:v}))}}},Di={name:"origin",props:{origin:Boolean},events:{},render:function(t,e){var n=t.state,r=n.beforeOrigin,o=n.rotation;return[e.createElement("div",{className:on("control","origin"),style:On(o,r),key:"beforeOrigin"})]}};function Ri(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var Pi={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,getScrollPosition:Function},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragStart:function(t,e){var n=t.props.scrollContainer,r=void 0===n?t.getContainer():n,o=new se;e.datas.dragScroll=o;var l=e.isControl?"controlDragger":"targetDragger",c=e.targets;o.on("scroll",(function(n){var r=n.container,o=n.direction,l=jn(t,e,{scrollContainer:r,direction:o}),f=c?"onScrollGroup":"onScroll";c&&(l.targets=c),Nn(t,f,l)})).on("move",(function(n){var r=n.offsetX,o=n.offsetY;t[l].scrollBy(r,o,e.inputEvent,!1)})),o.dragStart(e,{container:r})},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,o=r.scrollContainer,l=void 0===o?t.getContainer():o,c=r.scrollThreshold,f=void 0===c?0:c,d=r.getScrollPosition,h=void 0===d?Ri:d;return n.drag(e,{container:l,threshold:f,getScrollPosition:function(t){return h({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,he({},e,{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,he({},e,{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,he({},e,{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,he({},e,{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,he({},e,{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,e){return this.drag(t,he({},e,{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,he({},e,{targets:t.props.targets}))}},zi={name:"",props:{target:Object,dragTarget:Object,container:Object,rootContainer:Object,zoom:Number,transformOrigin:Array,edge:Boolean,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"}},_i=["nw","ne","se","sw"];function Bi(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var ki=[1,2,5,6],Ti=[0,3,4,7],Gi=[1,-1,-1,1],Ai=[1,1,-1,-1];function ji(t,e,n,r,o,l,c,f,d){void 0===l&&(l=0),void 0===c&&(c=0),void 0===f&&(f=r),void 0===d&&(d=o);var h=[],v=!1,m=t.map((function(t,i){var m=e[i],y=m.horizontal,x=m.vertical;if(x&&!v&&(v=!0,h.push("/")),v){var S=Math.max(0,1===x?t[1]-c:d-t[1]);return h.push(Qn(S,o,n)),S}S=Math.max(0,1===y?t[0]-l:f-t[0]);return h.push(Qn(S,r,n)),S}));return{styles:h,raws:m}}function Ii(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var o=t[i];o.sub&&(o.horizontal&&(0===e[1]&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),o.vertical&&(0===n[1]&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function Ni(t,e,n,r,o){var l,c,f,d,h=t.indexOf("/"),v=(h>-1?t.slice(0,h):t).length,m=t.slice(0,v),y=t.slice(v+1),x=m[0],S=void 0===x?"0":x,w=m[1],E=void 0===w?S:w,C=m[2],O=void 0===C?S:C,M=m[3],D=void 0===M?E:M,R=y[0],P=void 0===R?S:R,z=y[1],_=void 0===z?P:z,B=y[2],k=void 0===B?P:B,T=y[3],G=void 0===T?_:T,A=[S,E,O,D].map((function(t){return Jn(t,e)})),j=[P,_,k,G].map((function(t){return Jn(t,n)})),I=A.slice(),N=j.slice();l=Bi([I[0],I[1]],e),I[0]=l[0],I[1]=l[1],c=Bi([I[3],I[2]],e),I[3]=c[0],I[2]=c[1],f=Bi([N[0],N[3]],n),N[0]=f[0],N[3]=f[1],d=Bi([N[1],N[2]],n),N[1]=d[0],N[2]=d[1];var H=I.slice(0,m.length),L=N.slice(0,y.length);return H.map((function(t,i){var e=_i[i];return{horizontal:Gi[i],vertical:0,pos:[r+t,o+(-1===Ai[i]?n:0)],sub:!0,raw:A[i],direction:e}})).concat(L.map((function(t,i){var n=_i[i];return{horizontal:0,vertical:Ai[i],pos:[r+(-1===Gi[i]?e:0),o+t],sub:!0,raw:j[i],direction:n}})))}function Hi(t,e,n,r,o){void 0===o&&(o=e.length);var l=Ii(t.slice(r)),c=l.horizontalRange,f=l.verticalRange,d=n-r,h=0;if(0===d)h=o;else if(d>0&&d<c[1])h=c[1]-d;else{if(!(d>=f[0]))return;h=f[0]+f[1]-d}t.splice(n,h),e.splice(n,h)}function Li(t,e,n,r,o,l,c,f,d,h,v){void 0===h&&(h=0),void 0===v&&(v=0);var m=Ii(t.slice(n)),y=m.horizontalRange,x=m.verticalRange;if(r>-1)for(var S=1===Gi[r]?l-h:f-l,i=y[1];i<=r;++i){var w=1===Ai[i]?v:d,E=0;if(r===i?E=l:0===i?E=h+S:-1===Gi[i]&&(E=f-(e[n][0]-h)),t.splice(n+i,0,{horizontal:Gi[i],vertical:0,pos:[E,w]}),e.splice(n+i,0,[E,w]),0===i)break}else if(o>-1){var C=1===Ai[o]?c-v:d-c;if(0===y[1]&&0===x[1]){var O=[h+C,v];t.push({horizontal:Gi[0],vertical:0,pos:O}),e.push(O)}var M=x[0];for(i=x[1];i<=o;++i){E=1===Gi[i]?h:f,w=0;if(o===i?w=c:0===i?w=v+C:1===Ai[i]?w=e[n+M][1]:-1===Ai[i]&&(w=d-(e[n+M][1]-v)),t.push({horizontal:0,vertical:Ai[i],pos:[E,w]}),e.push([E,w]),0===i)break}}}function qi(t,e){return void 0===e&&(e=t.map((function(t){return t.raw}))),{horizontals:t.map((function(t,i){return t.horizontal?e[i]:null})).filter((function(t){return null!=t})),verticals:t.map((function(t,i){return t.vertical?e[i]:null})).filter((function(t){return null!=t}))}}var Fi=[[0,-1,"n"],[1,0,"e"]],Yi=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function Wi(t,e,n){var r=t.props.clipRelative,o=t.state,l=o.width,c=o.height,f=e,d=f.type,h=f.poses,v="rect"===d,m="circle"===d;if("polygon"===d)return n.map((function(t){return Qn(t[0],l,r)+" "+Qn(t[1],c,r)}));if(v||"inset"===d){var y=n[1][1],x=n[3][0],S=n[7][0],w=n[5][1];if(v)return[y,x,w,S].map((function(t){return t+"px"}));var E=[y,l-x,c-w,S].map((function(t,i){return Qn(t,i%2?l:c,r)}));if(n.length>8){var C=Ne(n[4],n[0]),O=C[0],M=C[1];E.push.apply(E,["round"].concat(ji(n.slice(8),h.slice(8),r,O,M,S,y,x,w).styles))}return E}if(m||"ellipse"===d){var D=n[0],R=Qn(Math.abs(n[1][1]-D[1]),m?Math.sqrt((l*l+c*c)/2):c,r);return(E=m?[R]:[Qn(Math.abs(n[2][0]-D[0]),l,r),R]).push("at",Qn(D[0],l,r),Qn(D[1],c,r)),E}}function Xi(t,e,n,r){var o=[r,(r+e)/2,e],l=[t,(t+n)/2,n];return Yi.map((function(t){var e=t[0],n=t[1],r=t[2],c=o[e+1],f=l[n+1];return{vertical:Math.abs(n),horizontal:Math.abs(e),direction:r,pos:[c,f]}}))}function $i(t,e,n,r,o){var l,c,f,d,h,v,m,y=o;if(!y){var style=getComputedStyle(t),x=style.clipPath;y="none"!==x?x:style.clip}if(y&&"none"!==y&&"auto"!==y||(y=r)){var S=G(y),w=S.prefix,E=void 0===w?y:w,C=S.value,O=void 0===C?"":C,M="circle"===E,D=" ";if("polygon"===E)return D=",",{type:E,clipText:y,poses:L=(B=T(O||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map((function(t){var r=t.split(" "),o=r[0],l=r[1];return{vertical:1,horizontal:1,pos:[Jn(o,e),Jn(l,n)]}})),splitter:D};if(M||"ellipse"===E){var R="",P="",z=0,_=0,B=k(O);if(M){var j;j=void 0===(l=B[0])?"50%":l,R=void 0===(c=B[2])?"50%":c,P=void 0===(f=B[3])?"50%":f,z=Jn(j,Math.sqrt((e*e+n*n)/2)),_=z}else{var I,N;I=void 0===(d=B[0])?"50%":d,N=void 0===(h=B[1])?"50%":h,R=void 0===(v=B[3])?"50%":v,P=void 0===(m=B[4])?"50%":m,z=Jn(I,e),_=Jn(N,n)}var H=[Jn(R,e),Jn(P,n)],L=[{vertical:1,horizontal:1,pos:H,direction:"nesw"}].concat(Fi.slice(0,M?1:2).map((function(t){return{vertical:Math.abs(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[H[0]+t[0]*z,H[1]+t[1]*_]}})));return{type:E,clipText:y,radiusX:z,radiusY:_,left:H[0]-z,top:H[1]-_,poses:L,splitter:D}}if("inset"===E){var F=(B=k(O||"0 0 0 0")).indexOf("round"),Y=(F>-1?B.slice(0,F):B).length,W=B.slice(Y+1),X=B.slice(0,Y),$=X[0],U=X[1],V=void 0===U?$:U,K=X[2],Z=void 0===K?$:K,J=X[3],Q=void 0===J?V:J,tt=[$,Z].map((function(t){return Jn(t,n)})),et=tt[0],nt=tt[1],it=[Q,V].map((function(t){return Jn(t,e)})),ot=it[0],at=it[1],st=e-at,ut=n-nt,lt=Ni(W,st-ot,ut-et,ot,et);return{type:"inset",clipText:y,poses:L=Xi(et,st,ut,ot).concat(lt),top:et,left:ot,right:st,bottom:ut,radius:W,splitter:D}}if("rect"===E){D=",";var ct=(B=T(O||"0px, "+e+"px, "+n+"px, 0px")).map((function(t,i){return A(t).value}));return{type:"rect",clipText:y,poses:L=Xi(et=ct[0],at=ct[1],nt=ct[2],ot=ct[3]),top:et,right:at,bottom:nt,left:ot,values:B,splitter:D}}}}var Ui={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[".control.clip-control {\n    background: #6d6;\n    cursor: pointer;\n}\n.control.clip-control.clip-radius {\n    background: #d66;\n}\n.line.clip-line {\n    background: #6e6;\n    cursor: move;\n    z-index: 1;\n}\n.clip-area {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.clip-ellipse {\n    position: absolute;\n    cursor: move;\n    border: 1px solid #6d6;\n    border: var(--zoompx) solid #6d6;\n    border-radius: 50%;\n    transform-origin: 0px 0px;\n}"],render:function(t,e){var n=t.props,r=n.customClipPath,o=n.defaultClipPath,l=n.clipArea,c=n.zoom,f=t.state,d=f.target,h=f.width,v=f.height,m=f.matrix,y=f.is3d,x=f.left,S=f.top,w=f.pos1,E=f.pos2,C=f.pos3,O=f.pos4,M=f.clipPathState;if(!d)return[];var D=$i(d,h,v,o||"inset",M||r);if(!D)return[];var R=y?4:3,P=D.type,z=D.poses.map((function(t){var e=mn(m,t.pos,R);return[e[0]-x,e[1]-S]})),_=[],B=[],k="rect"===P,T="inset"===P,G="polygon"===P;if(k||T||G){var A=T?z.slice(0,8):z;B=A.map((function(t,i){var n=0===i?A[A.length-1]:A[i-1],r=Be(n,t),o=En(n,t);return e.createElement("div",{key:"clipLine"+i,className:on("line","clip-line"),"data-clip-index":i,style:{width:o+"px",transform:"translate("+n[0]+"px, "+n[1]+"px) rotate("+r+"rad)"}})}))}if(_=z.map((function(t,i){return e.createElement("div",{key:"clipControl"+i,className:on("control","clip-control"),"data-clip-index":i,style:{transform:"translate("+t[0]+"px, "+t[1]+"px)"}})})),T&&_.push.apply(_,z.slice(8).map((function(t,i){return e.createElement("div",{key:"clipRadiusControl"+i,className:on("control","clip-control","clip-radius"),"data-clip-index":8+i,style:{transform:"translate("+t[0]+"px, "+t[1]+"px)"}})}))),"circle"===P||"ellipse"===P){var j=D.left,I=D.top,N=D.radiusX,H=D.radiusY,L=Ne(mn(m,[j,I],R),mn(m,[0,0],R)),F=L[0],Y=L[1],W="none";if(!l){for(var X=Math.max(10,N/5,H/5),$=[],i=0;i<=X;++i){var U=2*Math.PI/X*i;$.push([N+(N-c)*Math.cos(U),H+(H-c)*Math.sin(U)])}$.push([N,-2]),$.push([-2,-2]),$.push([-2,2*H+2]),$.push([2*N+2,2*H+2]),$.push([2*N+2,-2]),$.push([N,-2]),W="polygon("+$.map((function(t){return t[0]+"px "+t[1]+"px"})).join(", ")+")"}_.push(e.createElement("div",{key:"clipEllipse",className:on("clip-ellipse"),style:{width:2*N+"px",height:2*H+"px",clipPath:W,transform:"translate("+(-x+F)+"px, "+(-S+Y)+"px) "+hn(m)}}))}if(l){var V=yn([w,E,C,O].concat(z)),K=V.width,Z=V.height,J=V.left,Q=V.top;if(G||k||T){$=T?z.slice(0,8):z;_.push(e.createElement("div",{key:"clipArea",className:on("clip-area"),style:{width:K+"px",height:Z+"px",transform:"translate("+J+"px, "+Q+"px)",clipPath:"polygon("+$.map((function(t){return t[0]-J+"px "+(t[1]-Q)+"px"})).join(", ")+")"}}))}}return _.concat(B)},dragControlCondition:function(t){return t.inputEvent&&(t.inputEvent.target.className||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props.dragWithClip;return!(void 0===n||n)&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,e)},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,o=r.defaultClipPath,l=r.customClipPath,c=n.target,f=n.width,d=n.height,h=e.inputEvent?e.inputEvent.target:null,v=h?h.className:"",m=e.datas,y=$i(c,f,d,o||"inset",l);if(!y)return!1;var x=y.clipText;return!1===Nn(t,"onClipStart",jn(t,e,{clipType:y.type,clipStyle:x,poses:y.poses.map((function(t){return t.pos}))}))?(m.isClipStart=!1,!1):(m.isControl=v.indexOf("clip-control")>-1,m.isLine=v.indexOf("clip-line")>-1,m.isArea=v.indexOf("clip-area")>-1||v.indexOf("clip-ellipse")>-1,m.index=h?parseInt(h.getAttribute("data-clip-index"),10):-1,m.clipPath=y,m.isClipStart=!0,n.clipPathState=x,$e(t,e),!0)},dragControl:function(t,e){var n=e.datas,r=e.originalDatas;if(!n.isClipStart)return!1;var o=r&&r.draggable||{},l=n,c=l.isControl,f=l.isLine,d=l.isArea,h=l.index,v=l.clipPath;if(!v)return!1;var m=o.isDrag?o.prevDist:Ue(e),y=m[0],x=m[1],S=t.state,w=!d&&!c&&!f,E=v.type,C=v.poses,O=v.splitter,M=C.map((function(t){return t.pos})),D=M.map((function(t){return t.slice()}));w&&(y=-y,x=-x);var R=!c||"nesw"===C[h].direction;c&&!R&&er(C,D,h,y,x),R&&M.forEach((function(t,i){D[i]=Ie(t,[y,x])}));var P=Wi(t,v,D),z=E+"("+P.join(O)+")";return S.clipPathState=z,Nn(t,"onClip",jn(t,e,{clipEventType:"changed",clipType:E,poses:D,clipStyle:z,clipStyles:P,distX:y,distY:x})),!0},dragControlEnd:function(t,e){t.state.clipPathState="";var n=e.isDrag,r=e.datas,o=e.isDouble,l=r.isLine,c=r.isClipStart,f=r.isControl;return!!c&&(Nn(t,"onClipEnd",In(t,e,{})),o&&(f?function(t,e){var n=e.datas,r=n.clipPath,o=n.index,l=r,c=l.type,f=l.poses,d=l.splitter,h=f.map((function(t){return t.pos})),v=h.length;if("polygon"===c)f.splice(o,1),h.splice(o,1);else{if("inset"!==c)return;if(o<8)return;if(Hi(f,h,o,8,v),v===f.length)return}var m=Wi(t,r,h);Nn(t,"onClip",jn(t,e,{clipEventType:"removed",clipType:c,poses:h,clipStyles:m,clipStyle:c+"("+m.join(d)+")",distX:0,distY:0}))}(t,e):l&&function(t,e){var n=nr(t,e),r=n[0],o=n[1],l=e.datas,c=l.clipPath,f=l.index,d=c,h=d.type,v=d.poses,m=d.splitter,y=v.map((function(t){return t.pos}));if("polygon"===h)y.splice(f,0,[r,o]);else{if("inset"!==h)return;var x=ki.indexOf(f),S=Ti.indexOf(f),w=v.length;if(Li(v,y,8,x,S,r,o,y[4][0],y[4][1],y[0][0],y[0][1]),w===v.length)return}var E=Wi(t,c,y);Nn(t,"onClip",jn(t,e,{clipEventType:"added",clipType:h,poses:y,clipStyles:E,clipStyle:h+"("+E.join(m)+")",distX:0,distY:0}))}(t,e)),o||n)},unset:function(t){t.state.clipPathState=""}},Vi={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[":host[data-able-origindraggable] .control.origin {\n    pointer-events: auto;\n}"],dragControlCondition:function(t){return t.isRequest?"originDraggable"===t.requestAble:H(t.inputEvent.target,on("origin"))},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas;$e(t,e);var o=jn(t,e,{dragStart:ii.dragStart(t,(new lr).dragStart([0,0],n))}),l=Nn(t,"onDragOriginStart",o);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,!1===l?(r.isDragOrigin=!1,!1):o},dragControl:function(t,e){var n=e.datas,r=e.inputEvent,o=e.isPinch,l=e.isRequest;if(!n.isDragOrigin)return!1;var c=Ue(e),f=c[0],d=c[1],h=t.state,v=h.width,m=h.height,y=h.offsetMatrix,x=h.targetMatrix,S=h.is3d,w=t.props.originRelative,E=void 0===w||w,C=S?4:3,O=[f,d];if(l){var M=e.distOrigin;(M[0]||M[1])&&(O=M)}var D=Ie(n.startOrigin,O),R=Ie(n.startTargetOrigin,O),P=Ne(O,n.prevOrigin),z=tn(y,x,D,C),rect=t.getRect(),_=yn(bn(z,v,m,C)),B=[rect.left-_.left,rect.top-_.top];n.prevOrigin=O;var k=jn(t,e,{width:v,height:m,origin:D,dist:O,delta:P,transformOrigin:[Qn(R[0],v,E),Qn(R[1],m,E)].join(" "),drag:ii.drag(t,ur(t.state,B,r,!!o,!1))});return Nn(t,"onDragOrigin",k),k},dragControlEnd:function(t,e){return!!e.datas.isDragOrigin&&(Nn(t,"onDragOriginEnd",In(t,e,{})),!0)},dragGroupControlCondition:function(t){return this.dragControlCondition(t)},dragGroupControlStart:function(t,e){return!!this.dragControlStart(t,e)},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return!!n&&(t.transformOrigin=n.transformOrigin,!0)},request:function(t){var e={},rect=t.getRect(),n=0,r=0,o=rect.transformOrigin,l=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(l[0]+=t.deltaOrigin[0],l[1]+=t.deltaOrigin[1]):"origin"in t?(l[0]=t.origin[0]-o[0],l[1]=t.origin[1]-o[1]):("x"in t?n=t.x-rect.left:"deltaX"in t&&(n+=t.deltaX),"y"in t?r=t.y-rect.top:"deltaY"in t&&(r+=t.deltaY)),{datas:e,distX:n,distY:r,distOrigin:l}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Ki(t,e,n,r){var o;if(r)o=r;else{var style=window.getComputedStyle(t);if(!style)return null;o=style.borderRadius||""}return!o||!r&&"0px"===o?null:Ni(k(o),e,n,0,0)}function Zi(t,e,n,r,o,l){var c=t.state,f=c.width,d=c.height,h=ji(l,o,t.props.roundRelative,f,d),v=h.raws,m=h.styles,y=qi(o,v),x=y.horizontals,S=y.verticals,w=m.join(" ");c.borderRadiusState=w,Nn(t,"onRound",jn(t,e,{horizontals:x,verticals:S,borderRadius:w,width:f,height:d,delta:r,dist:n}))}var Ji={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd"},css:[".control.border-radius {\n    background: #d66;\n    cursor: pointer;\n}",":host[data-able-roundable] .line.direction {\n    cursor: pointer;\n}"],render:function(t,e){var n=t.state,r=n.target,o=n.width,l=n.height,c=n.matrix,f=n.is3d,d=n.left,h=n.top,v=n.borderRadiusState;if(!r)return null;var m=f?4:3,y=Ki(r,o,l,v);return y?y.map((function(t,i){var n=Ne(mn(c,t.pos,m),[d,h]);return e.createElement("div",{key:"borderRadiusControl"+i,className:on("control","border-radius"),"data-radius-index":i,style:{transform:"translate("+n[0]+"px, "+n[1]+"px)"}})})):null},dragControlCondition:function(t){if(!t.inputEvent||t.isRequest)return!1;var e=t.inputEvent.target.className||"";return e.indexOf("border-radius")>-1||e.indexOf("moveable-line")>-1&&e.indexOf("moveable-direction")>-1},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,o=n.target,l=o.className||"",c=l.indexOf("border-radius")>-1,f=l.indexOf("moveable-line")>-1&&l.indexOf("moveable-direction")>-1,d=c?parseInt(o.getAttribute("data-radius-index"),10):-1,h=f?parseInt(o.getAttribute("data-line-index"),10):-1;if(!c&&!f)return!1;if(!1===Nn(t,"onRoundStart",jn(t,e,{})))return!1;r.lineIndex=h,r.controlIndex=d,r.isControl=c,r.isLine=f,$e(t,e);var v=t.props.roundRelative,m=t.state,y=m.target,x=m.width,S=m.height;r.isRound=!0,r.prevDist=[0,0];var w=Ki(y,x,S)||[];return r.controlPoses=w,m.borderRadiusState=ji(w.map((function(t){return t.pos})),w,v,x,S).styles.join(" "),!0},dragControl:function(t,e){var n=e.datas;if(!n.isRound||!n.isControl||!n.controlPoses.length)return!1;var r=n.controlIndex,o=n.controlPoses,l=o.map((function(t){return t.pos.slice()})),c=Ue(e),f=c[0],d=c[1],h=[f,d],v=Ne(h,n.prevDist);return er(o,l,r,f,d),n.prevDist=[f,d],Zi(t,e,h,v,o,l),!0},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,o=e.isDouble;if(!r.isRound)return!1;var l=n.width,c=n.height,f=r.isControl,d=r.controlIndex,h=r.isLine,v=r.lineIndex,m=r.controlPoses,y=m.map((function(t){return t.pos})),x=y.length;if(o){if(f)Hi(m,y,d,0);else if(h){var S=nr(t,e);!function(t,e,n,r,o,l,c){var f=qi(t),d=f.horizontals,h=f.verticals,v=d.length,m=h.length,y=-1,x=-1;0===n?0===v?y=0:1===v&&(y=1):3===n&&(v<=2?y=2:v<=3&&(y=3)),2===n?0===m?x=0:m<4&&(x=3):1===n&&(m<=1?x=1:m<=2&&(x=2)),Li(t,e,0,y,x,r,o,l,c)}(m,y,v,S[0],S[1],l,c)}x!==m.length&&Zi(t,e,[0,0],[0,0],m,y),Nn(t,"onRoundEnd",In(t,e,{}))}return n.borderRadiusState="",!0},unset:function(t){t.state.borderRadiusState=""}},Qi={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean},events:{},render:function(t,e){var n=t.props.targets||[];t.moveables=[];var r=t.state,o={left:r.left,top:r.top};return n.map((function(n,i){return e.createElement(co,{key:"moveable"+i,ref:v(t,"moveables",i),target:n,origin:!1,parentMoveable:t,parentPosition:o})}))}},to=[zi,ri,sr,ii,fi,gi,vi,yi,Pi,Mi,{name:"padding",props:{padding:Object},events:{},render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=n.padding||{},o=r.left,l=void 0===o?0:o,c=r.top,f=void 0===c?0:c,d=r.right,h=void 0===d?0:d,v=r.bottom,m=void 0===v?0:v,y=t.state,x=y.renderPoses,S=[y.pos1,y.pos2,y.pos3,y.pos4],w=[];return l>0&&w.push([0,2]),f>0&&w.push([0,1]),h>0&&w.push([1,3]),m>0&&w.push([2,3]),w.map((function(t,i){var n=t[0],r=t[1],o=Xe([0,0],[100,0],[0,100],[100,100],S[n],S[r],x[n],x[r]);if(o.length)return e.createElement("div",{key:"padding"+i,className:on("padding"),style:{transform:hn(o,!0)}})}))}},Di,Vi,Ui,Ji,Qi],eo=to.reduce((function(t,e){return he({},t,e.events)}),{}),no=to.reduce((function(t,e){return he({},t,e.props)}),{}),ro=function(t){var e={};for(var n in t)e[t[n]]=n;return e}(eo),io=Object.keys(ro),oo=Object.keys(no),ao={};to.forEach((function(t){var e=t.css;e&&e.forEach((function(text){ao[text]=!0}))}));var so=Object.keys(ao).join("\n"),uo=Ft("div",function(t,e){return e.replace(/([^}{]*){/gm,(function(e,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"}))}(be,ye+so));function lo(t,e,n,r){var o=Be(e,n),l=t?kn(o/Math.PI*180,15)%180:-1;return nt("div",{key:"line"+r,className:on("line","direction",t),"data-rotation":l,"data-line-index":r,"data-direction":t,style:Cn(e,n,o)})}var co=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={container:null,target:null,beforeMatrix:an(),matrix:an(),targetMatrix:an(),offsetMatrix:an(),targetTransform:"",is3d:!1,left:0,top:0,width:0,height:0,transformOrigin:[0,0],direction:1,beforeDirection:1,beforeOrigin:[0,0],origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],renderPoses:[[0,0],[0,0],[0,0],[0,0]],targetClientRect:{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},containerClientRect:{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},moveableClientRect:{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},rotation:0},e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isUnmounted=!1,e}de(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=this.state,n=t.edge,r=t.parentPosition,o=t.className,l=t.target,c=t.zoom,f=t.cspNonce;this.checkUpdate(),this.updateRenderPoses();var d=r||{left:0,top:0},v=d.left,m=d.top,y=e.left,x=e.top,S=e.target,w=e.direction,E=e.renderPoses,C=t.targets,O=(C&&C.length||l)&&S,M=this.isDragging(),D={};return this.getEnabledAbles().forEach((function(t){D["data-able-"+t.name.toLowerCase()]=!0})),nt(uo,he({cspNonce:f,ref:h(this,"controlBox"),className:on("control-box",-1===w?"reverse":"",M?"dragging":"")+" "+o},D,{style:{position:"absolute",display:O?"block":"none",transform:"translate("+(y-v)+"px, "+(x-m)+"px) translateZ(50px)","--zoom":c,"--zoompx":c+"px"}}),this.renderAbles(),lo(n?"n":"",E[0],E[1],0),lo(n?"e":"",E[1],E[3],1),lo(n?"w":"",E[0],E[2],2),lo(n?"s":"",E[2],E[3],3))},n.componentDidMount=function(){this.controlBox.getElement();var t=this.props,e=t.parentMoveable,n=t.container;this.updateEvent(t),n||e||this.updateRect("End",!1,!0),this.updateCheckInput()},n.componentDidUpdate=function(t){this.updateEvent(t),this.updateCheckInput()},n.componentWillUnmount=function(){this.isUnmounted=!0,Gn(this,"targetDragger"),Gn(this,"controlDragger")},n.getContainer=function(){var t=this.props,e=t.parentMoveable;return t.container||e&&e.getContainer()||this.controlBox.getElement().parentElement},n.isMoveableElement=function(t){return t&&(t.getAttribute("class")||"").indexOf(be)>-1},n.dragStart=function(t){return this.targetDragger&&this.targetDragger.triggerDragStart(t),this},n.hitTest=function(t){var rect;if(t instanceof Element){var e=t.getBoundingClientRect();rect={left:e.left,top:e.top,width:e.width,height:e.height}}else rect=he({width:0,height:0},t);var n=this.state.targetClientRect,r=n.left,o=n.top,l=n.width,c=n.height,f=rect.left,d=rect.top,h=f+rect.width,v=d+rect.height,m=r+l,y=o+c,x=Math.max(r,f),S=Math.min(m,h),w=Math.max(o,d),E=Math.min(y,v);if(S<x||E<w)return 0;var C=(Math.min(m,h)-Math.max(f,r))*(Math.min(y,v)-Math.max(o,d));return Math.min(100,(S-x)*(E-w)/C*100)},n.isInside=function(t,e){var n=this.state,r=n.pos1,o=n.pos2,l=n.pos3,c=n.pos4,f=n.target,d=n.targetClientRect;return!!f&&function(t,e,n,r,o){var l=[An(t,e,n),An(t,n,r),An(t,r,e)],c=[An(t,n,r),An(t,r,o),An(t,o,n)];return!!(l.every((function(t){return t>=0}))||l.every((function(t){return t<=0}))||c.every((function(t){return t>=0}))||c.every((function(t){return t<=0})))}([t-d.left,e-d.top],r,o,l,c)},n.updateRect=function(t,e,n){void 0===n&&(n=!0);var r=this.props,o=r.parentMoveable,l=this.state,c=l.target||this.props.target,f=this.getContainer(),d=o?o.props.rootContainer:r.rootContainer;this.updateState(Rn(this.controlBox&&this.controlBox.getElement(),c,f,f,d||f,e?l:void 0),!o&&n)},n.updateEvent=function(t){var e=this.controlBox.getElement(),n=this.targetAbles.length,r=this.controlAbles.length,o=this.props,l=o.dragTarget||o.target,c=t.dragTarget||t.target,f=o.dragArea,d=t.dragArea,h=!f&&c!==l,v=!n&&this.targetDragger||h||d!==f;v&&(Gn(this,"targetDragger"),this.updateState({dragger:null})),r||Gn(this,"controlDragger"),l&&n&&!this.targetDragger&&(this.targetDragger=or(this,l,"")),!this.controlDragger&&r&&(this.controlDragger=ar(this,e,"controlAbles","Control")),v&&this.unsetAbles()},n.isDragging=function(){return!!this.targetDragger&&this.targetDragger.isFlag()||!!this.controlDragger&&this.controlDragger.isFlag()},n.updateTarget=function(t){this.updateRect(t,!0)},n.getRect=function(){var t=this.state,e=Bn(this.state),n=e[0],r=e[1],o=e[2],l=e[3],rect=yn(e),c=t.width,f=t.height,d=rect.width,h=rect.height,v=rect.left,m=rect.top,y=[t.left,t.top],x=Ie(y,t.origin);return{width:d,height:h,left:v,top:m,pos1:n,pos2:r,pos3:o,pos4:l,offsetWidth:c,offsetHeight:f,beforeOrigin:Ie(y,t.beforeOrigin),origin:x,transformOrigin:t.transformOrigin,rotation:this.getRotation()}},n.getRotation=function(){var t=this.state,e=t.pos1,n=t.pos2,r=t.direction,o=Be(e,n)/Math.PI*180;return o=(o=r>=0?o:180-o)>=0?o:360+o},n.request=function(t,param,e){void 0===param&&(param={});var n=this.props,r=n.ables,o=n.groupable,l=r.filter((function(e){return e.name===t}))[0];if(this.isDragging()||!l||!l.request)return{request:function(){return this},requestEnd:function(){return this}};var c=this,f=l.request(this),d=e||param.isInstant,h=f.isControl?"controlAbles":"targetAbles",v=(o?"Group":"")+(f.isControl?"Control":""),m={request:function(e){return ir(c,h,"drag",v,"",he({},f.request(e),{requestAble:t,isRequest:!0}),d),this},requestEnd:function(){return ir(c,h,"drag",v,"End",he({},f.requestEnd(),{requestAble:t,isRequest:!0}),d),this}};return ir(c,h,"drag",v,"Start",he({},f.requestStart(param),{requestAble:t,isRequest:!0}),d),d?m.request(param).requestEnd():m},n.destroy=function(){this.componentWillUnmount()},n.updateRenderPoses=function(){var t=this.state,e=this.props,n=t.beforeOrigin,r=t.transformOrigin,o=t.matrix,l=t.is3d,c=t.pos1,f=t.pos2,d=t.pos3,h=t.pos4,v=t.left,m=t.top,y=e.padding||{},x=y.left,S=void 0===x?0:x,w=y.top,E=void 0===w?0:w,C=y.bottom,O=void 0===C?0:C,M=y.right,D=void 0===M?0:M,R=l?4:3,P=e.groupable?n:Ie(n,[v,m]);t.renderPoses=[Ie(c,Kn(o,[-S,-E],r,P,R)),Ie(f,Kn(o,[D,-E],r,P,R)),Ie(d,Kn(o,[-S,O],r,P,R)),Ie(h,Kn(o,[D,O],r,P,R))]},n.checkUpdate=function(){var t=this.props,e=t.target,n=t.container,r=t.parentMoveable,o=this.state,l=o.target,c=o.container;(l||e)&&(this.updateAbles(),(!Yn(l,e)||!Yn(c,n))&&(this.updateState({target:e,container:n}),r||!n&&!this.controlBox||this.updateRect("End",!1,!1)))},n.triggerEvent=function(t,e){var n=this.props[t];return n&&n(e)},n.unsetAbles=function(){var t=this;this.targetAbles.filter((function(e){return!!e.unset&&(e.unset(t),!0)})).length&&this.forceUpdate()},n.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var n=this.props,r=n.triggerAblesSimultaneously,o=t.filter((function(t){return t&&n[t.name]})),l="drag"+e+"ControlStart",c=Ln(o,["drag"+e+"Start","pinch"+e+"Start"],r),f=Ln(o,[l],r);this.targetAbles=c,this.controlAbles=f},n.updateState=function(t,e){if(e)this.setState(t);else{var n=this.state;for(var r in t)n[r]=t[r]}},n.getEnabledAbles=function(){var t=this.props;return t.ables.filter((function(e){return e&&t[e.name]}))},n.renderAbles=function(){var t,e,n,r,o=this,l=this.props.triggerAblesSimultaneously,c={createElement:nt};return(t=Xn(Ln(this.getEnabledAbles(),["render"],l).map((function(t){return(0,t.render)(o,c)||[]}))).filter((function(t){return t})),e=function(t){return t.key},n=[],r={},t.forEach((function(o,l){var c=e(o,l,t),f=r[c];f||(f=[],r[c]=f,n.push(f)),f.push(o)})),n).map((function(t){return t[0]}))},n.updateCheckInput=function(){this.targetDragger&&(this.targetDragger.options.checkInput=this.props.checkInput)},e.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,edge:!1,parentMoveable:null,parentPosition:null,ables:[],pinchThreshold:20,dragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,cspNonce:""},e}(ht);function fo(t,e){return Math.max.apply(Math,t.map((function(t){var n=t[0],r=t[1],o=t[2],l=t[3];return Math.max(n[e],r[e],o[e],l[e])})))}function po(t,e){return Math.min.apply(Math,t.map((function(t){var n=t[0],r=t[1],o=t[2],l=t[3];return Math.min(n[e],r[e],o[e],l[e])})))}var ho=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new fe,e.moveables=[],e.transformOrigin="50% 50%",e}de(e,t);var n=e.prototype;return n.updateEvent=function(t){var e=this.state,n=this.props;e.target||(e.target=this.areaElement,this.controlBox.getElement().style.display="block",this.targetDragger=or(this,e.target,"Group"),this.controlDragger=ar(this,this.controlBox.getElement(),"controlAbles","GroupControl"));var r=!Yn(t.container,n.container);r&&(e.container=n.container);var o=this.differ.update(n.targets),l=o.added,c=o.changed,f=o.removed;(r||l.length||c.length||f.length)&&this.updateRect()},n.checkUpdate=function(){this.updateAbles()},n.updateRect=function(t,e,n){var r;if(void 0===n&&(n=!0),this.controlBox){this.moveables.forEach((function(e){e.updateRect(t,!1,!1)}));var o=this.state,l=this.props,c=o.target||l.target;(!e||""!==t&&l.updateGroup)&&(this.rotation=l.defaultGroupRotate,this.transformOrigin=l.defaultGroupOrigin||"50% 50%",this.scale=[1,1]);var f=this.rotation,d=this.scale,h=function(t,e){if(!t.length)return[0,0,0,0];var n=t.map((function(t){return Bn(t.state)})),r=Se,o=Se,l=0,c=0,f=kn(e,1e-7);if(f%90){var d=e/180*Math.PI,h=Math.tan(d),v=-1/h,m=[we,Se],y=[we,Se];n.forEach((function(t){t.forEach((function(t){var e=t[1]-h*t[0],n=t[1]-v*t[0];m[0]=Math.max(m[0],e),m[1]=Math.min(m[1],e),y[0]=Math.max(y[0],n),y[1]=Math.min(y[1],n)}))})),m.forEach((function(t){y.forEach((function(e){var n=(e-t)/(h-v),l=h*n+t;r=Math.min(r,n),o=Math.min(o,l)}))}));var x=n.map((function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return[Le(e,-d),Le(n,-d),Le(r,-d),Le(o,-d)]}));l=fo(x,0)-po(x,0),c=fo(x,1)-po(x,1)}else if(r=po(n,0),o=po(n,1),l=fo(n,0)-r,c=fo(n,1)-o,f%180){var S=l;l=c,c=S}return[r,o,l,c]}(this.moveables,f),v=h[0],m=h[1],y=h[2],x=h[3];c.style.cssText+="left:0px;top:0px; transform-origin: "+this.transformOrigin+"; width:"+y+"px; height:"+x+"px;transform:rotate("+f+"deg) scale("+(d[0]>=0?1:-1)+", "+(d[1]>=0?1:-1)+")",o.width=y,o.height=x;var S=this.getContainer(),w=Rn(this.controlBox.getElement(),c,this.controlBox.getElement(),this.getContainer(),this.props.rootContainer||S,o),E=[w.left,w.top];r=Bn(w),w.pos1=r[0],w.pos2=r[1],w.pos3=r[2],w.pos4=r[3],w.origin=Ie(E,w.origin),w.beforeOrigin=Ie(E,w.beforeOrigin);var C=w.targetClientRect;C.top+=m-w.top-o.top,C.left+=v-w.left-o.left;var O=d[0]*d[1]>0?1:-1;this.updateState(he({},w,{direction:O,beforeDirection:O,left:v-w.left,top:m-w.top}),n)}},n.triggerEvent=function(e,n){if(e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,n)},n.updateAbles=function(){t.prototype.updateAbles.call(this,this.props.ables.concat([Qi]),"Group")},e.defaultProps=he({},co.defaultProps,{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(co),go=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n,r;return de(e,t),e.prototype.render=function(){var t=this.props.ables||[],e=this.props.target||this.props.targets,n=P(e);if(n&&e.length>1){var r=he({},this.props,{target:null,targets:e,ables:to.concat([Qi],t)});return nt(ho,he({key:"group",ref:h(this,"moveable")},r))}var o=n?e[0]:e;return nt(co,he({key:"single",ref:h(this,"moveable")},he({},this.props,{target:o,ables:to.concat(t)})))},function(t,e,n,desc){var r,o=arguments.length,l=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(l=(o<3?r(l):o>3?r(e,n,l):r(e,n))||l);o>3&&l&&Object.defineProperty(e,n,l)}([(n=Me,void 0===r&&(r={}),function(t,e){n.forEach((function(n){var o=r[n]||n;t[o]||(t[o]=function(){for(var t,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var l=(t=this[e])[n].apply(t,r);return l===this[e]?this:l})}))})],e.prototype,"moveable"),e}(ht),vo=function(t,b){return(vo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function mo(t,b){function e(){this.constructor=t}vo(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}var bo=function(){return(bo=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};var yo=function(t){function e(e){var n=t.call(this,e)||this;return n.state={},n.state=n.props,n}return mo(e,t),e.prototype.render=function(){return t=nt(go,bo({ref:h(this,"moveable")},this.state)),e=this.state.parentElement,nt(gt,{element:t,container:e});var t,e},e}(pt),xo=oo,So=Me,wo=io,Eo=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.tempElement=document.createElement("div");var o=bo({container:e},n),l={};wo.forEach((function(t){var e;l[(e="on "+t,e.replace(/[\s-_]([a-z])/g,(function(t,e){return e.toUpperCase()})))]=function(e){return r.trigger(t,e)}})),yt(nt(yo,bo({ref:h(r,"innerMoveable"),parentElement:e},o,l)),r.tempElement);var c=o.target;return P(c)&&c.length>1&&r.updateRect(),r}mo(e,t);var n=e.prototype;return n.setState=function(t,e){this.innerMoveable.setState(t,e)},n.destroy=function(){yt(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=function(t,e,n,desc){var r,o=arguments.length,l=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(l=(o<3?r(l):o>3?r(e,n,l):r(e,n))||l);return o>3&&l&&Object.defineProperty(e,n,l),l}([m(So,(function(t,e){t[e]||(t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.getMoveable();if(r&&r[e])return r[e].apply(r,t)})})),m(xo,(function(t,e){Object.defineProperty(t,e,{get:function(){return this.getMoveable().props[e]},set:function(t){var n;this.setState(((n={})[e]=t,n))},enumerable:!0,configurable:!0})}))],e)}(f);function Co(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Oo(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Co(Object(source),!0).forEach((function(e){Mo(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Co(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Mo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Do={};So.forEach((function(t){Do[t]=function(){var e;return(e=this.moveable)[t].apply(e,arguments)}}));var Ro=function(t,e,n,r,o,l,c,f){var d,h="function"==typeof t?t.options:t;if(e&&(h.render=e,h.staticRenderFns=n,h._compiled=!0),r&&(h.functional=!0),l&&(h._scopeId="data-v-"+l),c?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(c)},h._ssrRegister=d):o&&(d=f?function(){o.call(this,(h.functional?this.parent:this).$root.$options.shadowRoot)}:o),d)if(h.functional){h._injectStyles=d;var v=h.render;h.render=function(t,e){return d.call(e),v(t,e)}}else{var m=h.beforeCreate;h.beforeCreate=m?[].concat(m,d):[d]}return{exports:t,options:h}}({name:"Moveable",inheritAttrs:!1,props:{roundable:Boolean,roundRelative:Boolean,originDraggable:Boolean,originRelative:Boolean,clippable:Boolean,customClipPath:String,defaultClipPath:String,clipRelative:Boolean,dragWithClip:Boolean,clipArea:Boolean,defaultGroupOrigin:String,cspNonce:String,checkInput:Boolean,groupable:Boolean,snappable:[Boolean,Array],snapCenter:Boolean,snapHorizontal:Boolean,snapVertical:Boolean,snapElement:Boolean,snapGap:Boolean,snapThreshold:Number,snapDigit:Number,isDisplaySnapDigit:Boolean,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function,defaultGroupRotate:Number,scrollable:Boolean,scrollContainer:[HTMLElement,SVGElement],scrollThreshold:Number,getScrollPosition:Function,warpable:Boolean,renderDirections:Array,rotatable:Boolean,rotationPosition:String,throttleRotate:Number,pinchable:[Boolean,Array],scalable:Boolean,throttleScale:Number,keepRatio:Boolean,resizable:Boolean,throttleResize:Number,baseDirection:Array,draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,dragTarget:[HTMLElement,SVGElement],container:{type:[HTMLElement,SVGElement],default:function(){return document.body}},rootContainer:HTMLElement,dragArea:Boolean,origin:Boolean,zoom:Number,transformOrigin:[Array,String],edge:Boolean,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,padding:Object},methods:Do,mounted:function(){var t=this;this.moveable=new Eo(this.$props.container,Oo(Oo({},this.$props),{},{target:this.$el})),wo.forEach((function(e){var n=e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase();t.moveable.on(e,t.$emit.bind(t,n)),t.moveable.on(e,t.$emit.bind(t,e))})),window.addEventListener("resize",this.updateRect,{passive:!0})},watch:Oo({},xo.reduce((function(t,e){var n;return t[e]=(n=e,{handler:function(t){this.moveable[n]!==t&&(this.moveable[n]=t)},deep:!0}),t}),{})),beforeDestroy:function(){window.removeEventListener("resize",this.updateRect),this.moveable.destroy()}},(function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default")],2)}),[],!1,null,null,null).exports;e.default=Ro}}).default},570:function(t,e,n){"use strict";var r=n(547);n.n(r).a},571:function(t,e,n){(e=n(32)(!1)).push([t.i,".align{float:left;margin:0;width:calc(100vw - 120px);height:calc(100vh - 38px);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}.align,.streamed-image-a{position:absolute;display:block;max-width:calc(100vw - 120px);max-height:calc(100vh - 38px)}.streamed-image-a{z-index:-100;pointer-events:none;width:auto;height:auto}.moveable{position:absolute;width:100px;height:100px;left:0;top:0;margin:0}.hidden *{visibility:hidden}.moveable-control,.moveable-line{border-color:#1e9ecb!important;background:#20a8d8!important}.moveable-line{visibility:hidden!important}.moveable-control.moveable-rotation{border-color:#1e9ecb!important;background:#ade1f3!important}.moveable-direction,.moveable-rotation-line{visibility:visible!important;outline:1px solid transparent!important}.align-content{display:flex;flex-direction:row}.filter-placeholder{flex-grow:1;height:calc(100vh - 38px)}.hidden-moveable>*{visibility:hidden!important}",""]),t.exports=e},588:function(t,e,n){"use strict";n.r(e);n(13),n(56);var r=n(3),o=n(15),l=n(563),c=n.n(l),f=n(544),d=n(22),h=n(526),v=n(521),m=n(535),y=n(524),x=n(553),S=(n(290),n(532)),w=n.n(S);n(6).default.use(w.a);var E={name:"analyzer-align",beforeMount:function(){this.handleInit(),window.addEventListener("resize",this.updateFrame)},beforeDestroy:function(){this.handleSaveAlignment(),this.handleCleanUp(),window.removeEventListener("resize",this.updateFrame)},components:{Moveable:c.a,PageHeader:h.a,PageHeaderItem:v.a,PageHeaderSeek:m.a,ConfigSidebar:x.a},methods:{handleInit:function(){var t=this;this.previous_id=this.id,this.$store.dispatch("analyzers/refresh",{id:this.id}),this.opened_at=Date.now(),-1===this.$store.getters["analyzers/getIndex"](this.id)?this.$router.push("/"):(this.$root.$emit(d.c.sidebar.open(this.id)),this.waitUntilHasRect=setInterval(this.updateFrameOnceHasRect,100),Object(o.D)(this.id).then((function(e){t.setRoi(e)})))},handleCleanUp:function(){Object(o.Y)(this.previous_id,o.q.GET_INVERSE_OVERLAID_FRAME),clearInterval(this.waitUntilHasRect),this.align={frame:null,roi:null,transform:null,overlay:{width:100,height:100,top:-50,left:-50,bottom:50,right:50}}},handleClearAlignment:function(){var t=this;Object(o.p)(this.id).then((function(e){e&&Object(o.m)(t.id).then((function(e){e&&t.clearRoi()}))}))},handleSaveAlignment:function(){Object(o.p)(this.previous_id)},handleUndoAlignment:function(){var t=this;Object(o.bb)(this.id,"transform").then((function(e){t.setRoi(e.transform.roi)}))},handleRedoAlignment:function(){var t=this;Object(o.P)(this.id,"transform").then((function(e){t.setRoi(e.transform.roi)}))},setRoi:function(t){void 0===t&&(t=this.config.roi),this.align.roi!==t&&(Object(f.d)(t)?(this.align.roi=t,this.resolveTransform()):this.clearRoi())},clearRoi:function(){this.handleHideMoveable(),this.align.roi=null,this.align.transform=null},resolveTransform:function(){var t=this;this.align.roi&&this.align.frame&&this.align.overlay&&(clearInterval(this.waitUntilHasMoveable),this.align.transform=Object(f.c)(this.align.roi,this.align.frame,this.align.overlay),void 0===this.$refs.moveable?this.waitUntilHasMoveable=setInterval((function(){void 0!==t.$refs.moveable&&(t.$refs.moveable.$el.style.transform=t.align.transform,t.$refs.moveable.updateRect(),t.$refs.moveable.updateTarget(),clearInterval(t.waitUntilHasMoveable))}),50):(this.$refs.moveable.$el.style.transform=this.align.transform,this.$refs.moveable.updateRect(),this.$refs.moveable.updateTarget(),this.handleShowMoveable()))},handleTransform:function(t){var e=t.target,n=t.transform;e.style.transform=n},handleRotate:function(t){var e=t.target,n=t.transform;e.style.transform=n},handleFlipH:function(){Object(o.t)(this.id)},handleFlipV:function(){Object(o.u)(this.id)},handleTurnCW:function(){Object(o.ab)(this.id)},handleTurnCCW:function(){Object(o.Z)(this.id)},updateRoiCoordinates:function(){var t=this;this.align.frame&&(this.align.roi=Object(f.e)(this.$refs.moveable.getRect(),this.align.frame),void 0!==this.align.roi&&(this.report_change?Object(o.W)(this.id).then((function(){Object(o.r)(t.id,t.align.roi)})):Object(o.r)(this.id,this.align.roi)))},handleUpdate:Object(y.throttle)(20,!1,Object(y.debounce)(20,!1,(function(){this.updateRoiCoordinates()}))),updateFrame:function(){try{var t=this.$refs.frame.getBoundingClientRect();this.enforceBounds?this.moveable.bounds={left:t.left,right:t.right,top:t.top,bottom:t.bottom}:this.temp_bounds={left:t.left,right:t.right,top:t.top,bottom:t.bottom},this.align.frame=t,this.resolveTransform()}catch(t){console.warn(t)}},toggleBounds:function(){this.enforceBounds?(this.enforceBounds=!1,this.moveable.bounds?(this.temp_bounds=this.moveable.bounds,this.moveable.bounds=null):this.updateFrame()):(this.enforceBounds=!0,this.temp_bounds?this.moveable.bounds=this.temp_bounds:this.updateFrame())},updateFrameOnceHasRect:function(){try{void 0!==this.waitUntilHasRect&&this.$refs.frame.getBoundingClientRect().width>50&&(this.updateFrame(),clearInterval(this.waitUntilHasRect))}catch(t){}},stepForward:function(){this.$root.$emit(d.c.seek.step_fw(this.id))},stepBackward:function(){this.$root.$emit(d.c.seek.step_bw(this.id))},handleShowMoveable:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.moveableShow=!0,t.moveable.draggable=!0;var r=setInterval((function(){void 0!==t.$refs.moveable&&(clearInterval(r),e())}),5)})));case 1:case"end":return e.stop()}}),e)})))()},handleHideMoveable:function(){this.moveableShow=!1,this.moveable.draggable=!1},handleStartRectangle:function(t){this.moveableShow||(this.dragROI.started=!0,this.dragROI.start_event=t)},handleStopRectangle:function(t){if(!this.moveableShow&&this.dragROI.started){var e=Object(f.b)(this.dragROI.start_event,t,this.align.frame);null!==e&&(this.setRoi(e),this.handleUpdate())}}},watch:{"$route.query.id":function(){this.handleCleanUp(),this.handleInit(),this.updateFrame()},"$refs.moveable.$el":function(){console.warn("there was a change in $ref.moveable.data"),console.warn(this.$refs.moveable)}},computed:{id:function(){return this.$route.query.id},keymap:function(){return{"ctrl+z":this.handleUndoAlignment,"ctrl+shift+z":this.handleRedoAlignment,right:this.stepForward,left:this.stepBackward}},overlaid_url:function(){return Object(o.f)("stream",this.$route.query.id,o.q.GET_INVERSE_OVERLAID_FRAME)},ref_frame:function(){return"frame"},ref_moveable:function(){return"moveable"},report_change:function(){var t=this.$store.getters["analyzers/getAnalyzerStatus"](this.id).state;return t===o.a.DONE||t===o.a.ERROR||t===o.a.CANCELED},transform_options:function(){return this.$store.getters["schemas/getTransformOptions"]},config:function(){var t=this.$store.getters["analyzers/getAnalyzerConfig"](this.id);return t.hasOwnProperty("transform")?{roi:t.transform.hasOwnProperty("roi")?t.transform.roi:void 0,flip:t.transform.hasOwnProperty("flip")?t.transform.flip:void 0,turn:t.transform.hasOwnProperty("turn")?t.transform.turn:void 0}:{roi:void 0,flip:void 0,turn:void 0}}},data:function(){return{opened_at:0,moveable:{draggable:!0,throttleDrag:0,rotatable:!0,throttleRotate:0,warpable:!0,throttleWarp:0,snappable:!0,bounds:{}},align:{frame:null,overlay:{width:100,height:100,top:-50,left:-50,bottom:50,right:50},roi:null,transform:null},enforceBounds:!0,temp_bounds:null,updateCall:null,moveableShow:!1,dragROI:{start_event:{}},waitUntilHasRect:null,previous_id:"",hideConfigSidebar:!0}}},C=(n(570),n(18)),component=Object(C.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fixed-page"},[n("PageHeader",[n("PageHeaderItem",[n("b-button",{staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Clear alignment"},on:{click:t.handleClearAlignment}},[n("i",{staticClass:"icon-ban"})]),t._v(" "),n("b-button",{directives:[{name:"hotkey",rawName:"v-hotkey",value:t.keymap,expression:"keymap"}],staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Undo alignment"},on:{click:t.handleUndoAlignment}},[n("i",{staticClass:"icon-action-undo"})]),t._v(" "),n("b-button",{directives:[{name:"hotkey",rawName:"v-hotkey",value:t.keymap,expression:"keymap"}],staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Redo alignment"},on:{click:t.handleRedoAlignment}},[n("i",{staticClass:"icon-action-redo"})])],1),t._v(" "),n("PageHeaderSeek",{key:t.id,attrs:{id:t.id}}),t._v(" "),n("PageHeaderItem",[n("b-button",{staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Flip horizontally"},on:{click:t.handleFlipH}},[n("i",{staticClass:"fa fa-arrows-h"})]),t._v(" "),n("b-button",{staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Flip vertically"},on:{click:t.handleFlipV}},[n("i",{staticClass:"fa fa-arrows-v"})])],1),t._v(" "),n("PageHeaderItem",[n("b-button",{staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Rotate 90° clockwise"},on:{click:t.handleTurnCW}},[n("i",{staticClass:"fa fa-rotate-right"})]),t._v(" "),n("b-button",{staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Rotate 90° counter-clockwise"},on:{click:t.handleTurnCCW}},[n("i",{staticClass:"fa fa-rotate-left"})])],1),t._v(" "),n("PageHeaderItem",[n("b-button",{staticClass:"header-button-icon",attrs:{variant:t.enforceBounds?null:"danger","data-toggle":"tooltip",title:t.enforceBounds?"Ignore frame boundaries":"Enforce frame boundaries"},on:{click:t.toggleBounds}},[n("i",{class:t.enforceBounds?"icon-size-fullscreen":"icon-size-actual",style:{"margin-top":"-4px"}})])],1),t._v(" "),n("page-header-item",[n("b-button",{staticClass:"header-button-icon",attrs:{"data-toggle":"tooltip",title:"Rotate 90° counter-clockwise"},on:{click:function(e){t.moveableShow=!t.moveableShow}}},[n("i",{staticClass:"fa fa-rotate-left"})])],1)],1),t._v(" "),n("div",{staticClass:"align-content"},[n("div",{ref:"align",staticClass:"align align-placeholder",on:{mousedown:t.handleStartRectangle,mouseup:t.handleStopRectangle}},[n("img",{ref:"frame",staticClass:"streamed-image-a",attrs:{src:t.overlaid_url+"?"+t.opened_at,alt:""}}),t._v(" "),n("Moveable",t._b({ref:"moveable",staticClass:"moveable",attrs:{className:t.moveableShow?"":"hidden-moveable"},on:{drag:t.handleTransform,scale:t.handleTransform,rotate:t.handleRotate,warp:t.handleTransform,render:t.handleUpdate,renderEnd:t.handleSaveAlignment}},"Moveable",t.moveable,!1))],1)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);